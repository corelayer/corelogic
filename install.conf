### PREREQUISITES ###
### STRINGMAPS ###
 add policy stringmap SM_CL1009_CS_CONTROL -comment "This stringmap is used to control application flow through content switching virtual servers"
 add policy stringmap SM_CL1009_IP_CONTROL -comment "This stringmap is used to control access to load balancing virtual servers based on client IP address"

 add policy stringmap SM_CL1009_PORT_PROTOCOLS -comment "This stringmap is used to create a universal redirect policy valid for http and https"
bind policy stringmap SM_CL1009_PORT_PROTOCOLS 443 "proto=https;switch=http;"
bind policy stringmap SM_CL1009_PORT_PROTOCOLS 80 "proto=http;switch=https;"

 add policy stringmap SM_CL1009_REDIR -comment "This stringmap is used to create a universal redirect policy valid for http and https"
bind policy stringmap SM_CL1009_REDIR VS_CL1009_REDIR_301 "HTTP/1.1 301 Moved Permanently\r\nLocation: "
bind policy stringmap SM_CL1009_REDIR VS_CL1009_REDIR_301_SWITCH "HTTP/1.1 301 Moved Permanently\r\nLocation: "
bind policy stringmap SM_CL1009_REDIR VS_CL1009_REDIR_301_KEEPPATH "HTTP/1.1 301 Moved Permanently\r\nLocation: "
bind policy stringmap SM_CL1009_REDIR VS_CL1009_REDIR_302 "HTTP/1.1 302 Found\r\nLocation: "
bind policy stringmap SM_CL1009_REDIR VS_CL1009_REDIR_302_SWITCH "HTTP/1.1 302 Found\r\nLocation: "
bind policy stringmap SM_CL1009_REDIR VS_CL1009_REDIR_302_KEEPPATH "HTTP/1.1 302 Found\r\nLocation: "
bind policy stringmap SM_CL1009_REDIR VS_CL1009_REDIR_307 "HTTP/1.1 307 Temporary Redirect\r\nLocation: "
bind policy stringmap SM_CL1009_REDIR VS_CL1009_REDIR_307_SWITCH "HTTP/1.1 307 Temporary Redirect\r\nLocation: "
bind policy stringmap SM_CL1009_REDIR VS_CL1009_REDIR_307_KEEPPATH "HTTP/1.1 307 Temporary Redirect\r\nLocation: "
bind policy stringmap SM_CL1009_REDIR VS_CL1009_REDIR_308 "HTTP/1.1 308 Permanent Redirect\r\nLocation: "
bind policy stringmap SM_CL1009_REDIR VS_CL1009_REDIR_308_SWITCH "HTTP/1.1 308 Permanent Redirect\r\nLocation: "
bind policy stringmap SM_CL1009_REDIR VS_CL1009_REDIR_308_KEEPPATH "HTTP/1.1 308 Permanent Redirect\r\nLocation: "

 add policy stringmap SM_CL1009_ACME -comment "This stringmap is used to control ACME challenges and responses"

### PATTERN SETS ###
 add policy patset PS_CL1009_NAME_PROTOCOLS -comment "This pattern set is used to create a universal name convention per protocol for vservers"
bind policy patset PS_CL1009_NAME_PROTOCOLS _HTTP -index 1
bind policy patset PS_CL1009_NAME_PROTOCOLS _HTTPS -index 2
bind policy patset PS_CL1009_NAME_PROTOCOLS _SSL -index 3
bind policy patset PS_CL1009_NAME_PROTOCOLS _ssl -index 4
bind policy patset PS_CL1009_NAME_PROTOCOLS _https -index 5
bind policy patset PS_CL1009_NAME_PROTOCOLS _http -index 6
bind policy patset PS_CL1009_NAME_PROTOCOLS _TCP -index 7
bind policy patset PS_CL1009_NAME_PROTOCOLS _tcp -index 8
bind policy patset PS_CL1009_NAME_PROTOCOLS _STCP -index 9
bind policy patset PS_CL1009_NAME_PROTOCOLS _stcp -index 10
bind policy patset PS_CL1009_NAME_PROTOCOLS _UDP -index 11
bind policy patset PS_CL1009_NAME_PROTOCOLS _udp -index 12

### POLICY EXPRESSIONS ###
### VERSION SPECIFIC ###
### DEBUG CONTROLS ###
add policy expression PE_CL1009_INSERT_TXID true

### TRANSACTION IDENTIFIERS ###
add policy expression PE_CL1009_REQ_TXID HTTP.REQ.TXID.BEFORE_STR("-")
add policy expression PE_CL1009_RES_TXID HTTP.RES.TXID.BEFORE_STR("-")

### REDIRECT PROTOCOLS ###
add policy expression PE_CL1009_HTTP_SWITCH "CLIENT.TCP.DSTPORT.TYPECAST_TEXT_T.MAP_STRING(\"SM_CL1009_PORT_PROTOCOLS\").AFTER_STR(\"switch=\").BEFORE_STR(\";\") ALT \"https\""
add policy expression PE_CL1009_HTTP_REDIR "HTTP.REQ.LB_VSERVER.NAME.MAP_STRING(\"SM_CL1009_REDIR\") ALT \"HTTP/1.1 302 Found\r\nLocation: \""
add policy expression PE_CL1009_IS_SSL "HTTP.REQ.CS_VSERVER.NAME.ENDSWITH(\"_HTTP\").NOT" -comment "client.ssl.is_ssl does not seem to work correctly"


### RESPONDER ACTIONS ###
add responder action RSA_CL1009_NO_SERVICE respondwith q{"HTTP/1.1 503 Service Unavailable\r\n\r\nService Unavailable\n" + HTTP.REQ.HOSTNAME + HTTP.REQ.URL}

add audit messageaction LOG_CL1009_RSP_CL1009_BLOCKED INFORMATIONAL "\"RSP_CL1009_BLOCKED - \" + HTTP.REQ.CS_VSERVER.NAME + \" - \" + HTTP.REQ.LB_VSERVER.NAME + \" - \" + HTTP.REQ.HOSTNAME.SERVER + \" - \" + HTTP.REQ.URL"
add responder action RSA_CL1009_BLOCKED respondwith q{"HTTP/1.1 403 Forbidden\r\n\r\nBLOCKED\n" + HTTP.REQ.HOSTNAME + HTTP.REQ.URL}
add responder policy RSP_CL1009_BLOCKED true RSA_CL1009_BLOCKED -logAction LOG_CL1009_RSP_CL1009_BLOCKED

add audit messageaction LOG_CL1009_RSP_CL1009_NOTFOUND_HTTP INFORMATIONAL "\"RSP_CL1009_NOTFOUND_HTTP - \" + HTTP.REQ.CS_VSERVER.NAME + \" - \" + HTTP.REQ.LB_VSERVER.NAME + \" - \" + HTTP.REQ.HOSTNAME.SERVER + \" - \" + HTTP.REQ.URL"
add responder action RSA_CL1009_NOTFOUND_HTTP respondwith q{"HTTP/1.1 404 Not Found\r\n\r\nPage not found\n" + HTTP.REQ.HOSTNAME + HTTP.REQ.URL}
add responder policy RSP_CL1009_NOTFOUND_HTTP true RSA_CL1009_NOTFOUND_HTTP -logAction LOG_CL1009_RSP_CL1009_NOTFOUND_HTTP

add audit messageaction LOG_CL1009_RSP_CL1009_DROP_HTTP INFORMATIONAL "\"RSP_CL1009_DROP_HTTP - \" + HTTP.REQ.CS_VSERVER.NAME + \" - \" + HTTP.REQ.LB_VSERVER.NAME + \" - \" + HTTP.REQ.HOSTNAME.SERVER + \" - \" + HTTP.REQ.URL"
add responder policy RSP_CL1009_DROP_HTTP true DROP -logAction LOG_CL1009_RSP_CL1009_DROP_HTTP

add audit messageaction LOG_CL1009_RSP_CL1009_DROP_TCP INFORMATIONAL "\"RSP_CL1009_DROP_TCP - \" + CLIENT.TCP.CS_VSERVER.NAME + \" - \" + CLIENT.TCP.LB_VSERVER.NAME + \" - \" + CLIENT.TCP.DSTPORT"
add responder policy RSP_CL1009_DROP_TCP true DROP -logAction LOG_CL1009_RSP_CL1009_DROP_TCP

add audit messageaction LOG_CL1009_RSP_CL1009_RESET_HTTP INFORMATIONAL "\"RSP_CL1009_RESET - \" + HTTP.REQ.CS_VSERVER.NAME + \" - \" + HTTP.REQ.LB_VSERVER.NAME + \" - \" + HTTP.REQ.HOSTNAME.SERVER + \" - \" + HTTP.REQ.URL"
add responder policy RSP_CL1009_RESET_HTTP true RESET -logAction LOG_CL1009_RSP_CL1009_RESET_HTTP

add audit messageaction LOG_CL1009_RSP_CL1009_RESET_TCP INFORMATIONAL "\"RSP_CL1009_RESET_TCP - \" + CLIENT.TCP.CS_VSERVER.NAME + \" - \" + CLIENT.TCP.LB_VSERVER.NAME + \" - \" + CLIENT.TCP.DSTPORT"
add responder policy RSP_CL1009_RESET_TCP true RESET -logAction LOG_CL1009_RSP_CL1009_RESET_TCP

add audit messageaction LOG_CL1009_REDIR_SWITCH INFORMATIONAL "\"RSP_CL1009_HTTP_REDIR_SWITCH - \" + HTTP.REQ.CS_VSERVER.NAME + \" - \" + HTTP.REQ.LB_VSERVER.NAME + \" - \" + HTTP.REQ.HOSTNAME.SERVER + \" - \" + HTTP.REQ.URL"
add responder action RSA_CL1009_HTTP_REDIR_SWITCH respondwith q{PE_CL1009_HTTP_REDIR + PE_CL1009_HTTP_SWITCH + "://" + HTTP.REQ.HOSTNAME.SERVER + HTTP.REQ.URL.PATH_AND_QUERY + "\r\n\r\n"}
add responder policy RSP_CL1009_HTTP_REDIR_SWITCH true RSA_CL1009_HTTP_REDIR_SWITCH


add policy expression PE_CL1009_HTTP_ACME_KEY "(\"domain=\" + HTTP.REQ.HOSTNAME + \";type=http;token=\" + HTTP.REQ.URL.PATH.GET(3))"
add policy expression PE_CL1009_HTTP_ACME_KEY_EXISTS "(\"domain=\" + HTTP.REQ.HOSTNAME + \";type=http;token=\" + HTTP.REQ.URL.PATH.GET(3)).IS_STRINGMAP_KEY(\"SM_CL1009_ACME\")"
add policy expression PE_CL1009_HTTP_ACME_VALUE "(\"domain=\" + HTTP.REQ.HOSTNAME + \";type=http;token=\" + HTTP.REQ.URL.PATH.GET(3)).MAP_STRING(\"SM_CL1009_ACME\").AFTER_STR(\"authorization=\").BEFORE_STR(\";\")"

add audit messageaction LOG_CL1009_ACME_HTTP INFORMATIONAL "\"RSP_CL1009_ACME_HTTP - \" + HTTP.REQ.CS_VSERVER.NAME + \" - \" + HTTP.REQ.LB_VSERVER.NAME + \" - \" + HTTP.REQ.HOSTNAME"
add responder action RSA_CL1009_ACME_HTTP respondwith q{"HTTP/1.1 200 OK\r\n\r\n" + PE_CL1009_HTTP_ACME_VALUE}
add responder policy RSP_CL1009_ACME_HTTP "PE_CL1009_HTTP_ACME_KEY_EXISTS" RSA_CL1009_ACME_HTTP -logAction LOG_CL1009_ACME_HTTP


### CONTENT SWITCHING ###
### DETECT LAN###
add policy expression PE_CL1009_TCP_CS_IP_ISLAN_0X_A "(CLIENT.TCP.CS_VSERVER.NAME.BEFORE_STR_ANY(\"PS_CL1009_NAME_PROTOCOLS\").TO_LOWER + \";lan;\" + CLIENT.IP.SRC.SUBNET(4).TYPECAST_TEXT_T + \"/4\").IS_STRINGMAP_KEY(\"SM_CL1009_IP_CONTROL\") || (CLIENT.TCP.CS_VSERVER.NAME.BEFORE_STR_ANY(\"PS_CL1009_NAME_PROTOCOLS\").TO_LOWER + \";lan;\" + CLIENT.IP.SRC.SUBNET(3).TYPECAST_TEXT_T + \"/3\").IS_STRINGMAP_KEY(\"SM_CL1009_IP_CONTROL\") || (CLIENT.TCP.CS_VSERVER.NAME.BEFORE_STR_ANY(\"PS_CL1009_NAME_PROTOCOLS\").TO_LOWER + \";lan;\" + CLIENT.IP.SRC.SUBNET(2).TYPECAST_TEXT_T + \"/2\").IS_STRINGMAP_KEY(\"SM_CL1009_IP_CONTROL\") || (CLIENT.TCP.CS_VSERVER.NAME.BEFORE_STR_ANY(\"PS_CL1009_NAME_PROTOCOLS\").TO_LOWER + \";lan;\" + CLIENT.IP.SRC.SUBNET(1).TYPECAST_TEXT_T + \"/1\").IS_STRINGMAP_KEY(\"SM_CL1009_IP_CONTROL\")"
add policy expression PE_CL1009_TCP_CS_IP_ISLAN_0X_B "(CLIENT.TCP.CS_VSERVER.NAME.BEFORE_STR_ANY(\"PS_CL1009_NAME_PROTOCOLS\").TO_LOWER + \";lan;\" + CLIENT.IP.SRC.SUBNET(9).TYPECAST_TEXT_T + \"/9\").IS_STRINGMAP_KEY(\"SM_CL1009_IP_CONTROL\") || (CLIENT.TCP.CS_VSERVER.NAME.BEFORE_STR_ANY(\"PS_CL1009_NAME_PROTOCOLS\").TO_LOWER + \";lan;\" + CLIENT.IP.SRC.SUBNET(8).TYPECAST_TEXT_T + \"/8\").IS_STRINGMAP_KEY(\"SM_CL1009_IP_CONTROL\") || (CLIENT.TCP.CS_VSERVER.NAME.BEFORE_STR_ANY(\"PS_CL1009_NAME_PROTOCOLS\").TO_LOWER + \";lan;\" + CLIENT.IP.SRC.SUBNET(7).TYPECAST_TEXT_T + \"/7\").IS_STRINGMAP_KEY(\"SM_CL1009_IP_CONTROL\") || (CLIENT.TCP.CS_VSERVER.NAME.BEFORE_STR_ANY(\"PS_CL1009_NAME_PROTOCOLS\").TO_LOWER + \";lan;\" + CLIENT.IP.SRC.SUBNET(6).TYPECAST_TEXT_T + \"/6\").IS_STRINGMAP_KEY(\"SM_CL1009_IP_CONTROL\") || (CLIENT.TCP.CS_VSERVER.NAME.BEFORE_STR_ANY(\"PS_CL1009_NAME_PROTOCOLS\").TO_LOWER + \";lan;\" + CLIENT.IP.SRC.SUBNET(5).TYPECAST_TEXT_T + \"/5\").IS_STRINGMAP_KEY(\"SM_CL1009_IP_CONTROL\")"
add policy expression PE_CL1009_TCP_CS_IP_ISLAN_1X_A "(CLIENT.TCP.CS_VSERVER.NAME.BEFORE_STR_ANY(\"PS_CL1009_NAME_PROTOCOLS\").TO_LOWER + \";lan;\" + CLIENT.IP.SRC.SUBNET(14).TYPECAST_TEXT_T + \"/14\").IS_STRINGMAP_KEY(\"SM_CL1009_IP_CONTROL\") || (CLIENT.TCP.CS_VSERVER.NAME.BEFORE_STR_ANY(\"PS_CL1009_NAME_PROTOCOLS\").TO_LOWER + \";lan;\" + CLIENT.IP.SRC.SUBNET(13).TYPECAST_TEXT_T + \"/13\").IS_STRINGMAP_KEY(\"SM_CL1009_IP_CONTROL\") || (CLIENT.TCP.CS_VSERVER.NAME.BEFORE_STR_ANY(\"PS_CL1009_NAME_PROTOCOLS\").TO_LOWER + \";lan;\" + CLIENT.IP.SRC.SUBNET(12).TYPECAST_TEXT_T + \"/12\").IS_STRINGMAP_KEY(\"SM_CL1009_IP_CONTROL\") || (CLIENT.TCP.CS_VSERVER.NAME.BEFORE_STR_ANY(\"PS_CL1009_NAME_PROTOCOLS\").TO_LOWER + \";lan;\" + CLIENT.IP.SRC.SUBNET(11).TYPECAST_TEXT_T + \"/11\").IS_STRINGMAP_KEY(\"SM_CL1009_IP_CONTROL\") || (CLIENT.TCP.CS_VSERVER.NAME.BEFORE_STR_ANY(\"PS_CL1009_NAME_PROTOCOLS\").TO_LOWER + \";lan;\" + CLIENT.IP.SRC.SUBNET(10).TYPECAST_TEXT_T + \"/10\").IS_STRINGMAP_KEY(\"SM_CL1009_IP_CONTROL\")"
add policy expression PE_CL1009_TCP_CS_IP_ISLAN_1X_B "(CLIENT.TCP.CS_VSERVER.NAME.BEFORE_STR_ANY(\"PS_CL1009_NAME_PROTOCOLS\").TO_LOWER + \";lan;\" + CLIENT.IP.SRC.SUBNET(19).TYPECAST_TEXT_T + \"/19\").IS_STRINGMAP_KEY(\"SM_CL1009_IP_CONTROL\") || (CLIENT.TCP.CS_VSERVER.NAME.BEFORE_STR_ANY(\"PS_CL1009_NAME_PROTOCOLS\").TO_LOWER + \";lan;\" + CLIENT.IP.SRC.SUBNET(18).TYPECAST_TEXT_T + \"/18\").IS_STRINGMAP_KEY(\"SM_CL1009_IP_CONTROL\") || (CLIENT.TCP.CS_VSERVER.NAME.BEFORE_STR_ANY(\"PS_CL1009_NAME_PROTOCOLS\").TO_LOWER + \";lan;\" + CLIENT.IP.SRC.SUBNET(17).TYPECAST_TEXT_T + \"/17\").IS_STRINGMAP_KEY(\"SM_CL1009_IP_CONTROL\") || (CLIENT.TCP.CS_VSERVER.NAME.BEFORE_STR_ANY(\"PS_CL1009_NAME_PROTOCOLS\").TO_LOWER + \";lan;\" + CLIENT.IP.SRC.SUBNET(16).TYPECAST_TEXT_T + \"/16\").IS_STRINGMAP_KEY(\"SM_CL1009_IP_CONTROL\") || (CLIENT.TCP.CS_VSERVER.NAME.BEFORE_STR_ANY(\"PS_CL1009_NAME_PROTOCOLS\").TO_LOWER + \";lan;\" + CLIENT.IP.SRC.SUBNET(15).TYPECAST_TEXT_T + \"/15\").IS_STRINGMAP_KEY(\"SM_CL1009_IP_CONTROL\")"
add policy expression PE_CL1009_TCP_CS_IP_ISLAN_2X_A "(CLIENT.TCP.CS_VSERVER.NAME.BEFORE_STR_ANY(\"PS_CL1009_NAME_PROTOCOLS\").TO_LOWER + \";lan;\" + CLIENT.IP.SRC.SUBNET(24).TYPECAST_TEXT_T + \"/24\").IS_STRINGMAP_KEY(\"SM_CL1009_IP_CONTROL\") || (CLIENT.TCP.CS_VSERVER.NAME.BEFORE_STR_ANY(\"PS_CL1009_NAME_PROTOCOLS\").TO_LOWER + \";lan;\" + CLIENT.IP.SRC.SUBNET(23).TYPECAST_TEXT_T + \"/23\").IS_STRINGMAP_KEY(\"SM_CL1009_IP_CONTROL\") || (CLIENT.TCP.CS_VSERVER.NAME.BEFORE_STR_ANY(\"PS_CL1009_NAME_PROTOCOLS\").TO_LOWER + \";lan;\" + CLIENT.IP.SRC.SUBNET(22).TYPECAST_TEXT_T + \"/22\").IS_STRINGMAP_KEY(\"SM_CL1009_IP_CONTROL\") || (CLIENT.TCP.CS_VSERVER.NAME.BEFORE_STR_ANY(\"PS_CL1009_NAME_PROTOCOLS\").TO_LOWER + \";lan;\" + CLIENT.IP.SRC.SUBNET(21).TYPECAST_TEXT_T + \"/21\").IS_STRINGMAP_KEY(\"SM_CL1009_IP_CONTROL\") || (CLIENT.TCP.CS_VSERVER.NAME.BEFORE_STR_ANY(\"PS_CL1009_NAME_PROTOCOLS\").TO_LOWER + \";lan;\" + CLIENT.IP.SRC.SUBNET(20).TYPECAST_TEXT_T + \"/20\").IS_STRINGMAP_KEY(\"SM_CL1009_IP_CONTROL\")"
add policy expression PE_CL1009_TCP_CS_IP_ISLAN_2X_B "(CLIENT.TCP.CS_VSERVER.NAME.BEFORE_STR_ANY(\"PS_CL1009_NAME_PROTOCOLS\").TO_LOWER + \";lan;\" + CLIENT.IP.SRC.SUBNET(29).TYPECAST_TEXT_T + \"/29\").IS_STRINGMAP_KEY(\"SM_CL1009_IP_CONTROL\") || (CLIENT.TCP.CS_VSERVER.NAME.BEFORE_STR_ANY(\"PS_CL1009_NAME_PROTOCOLS\").TO_LOWER + \";lan;\" + CLIENT.IP.SRC.SUBNET(28).TYPECAST_TEXT_T + \"/28\").IS_STRINGMAP_KEY(\"SM_CL1009_IP_CONTROL\") || (CLIENT.TCP.CS_VSERVER.NAME.BEFORE_STR_ANY(\"PS_CL1009_NAME_PROTOCOLS\").TO_LOWER + \";lan;\" + CLIENT.IP.SRC.SUBNET(27).TYPECAST_TEXT_T + \"/27\").IS_STRINGMAP_KEY(\"SM_CL1009_IP_CONTROL\") || (CLIENT.TCP.CS_VSERVER.NAME.BEFORE_STR_ANY(\"PS_CL1009_NAME_PROTOCOLS\").TO_LOWER + \";lan;\" + CLIENT.IP.SRC.SUBNET(26).TYPECAST_TEXT_T + \"/26\").IS_STRINGMAP_KEY(\"SM_CL1009_IP_CONTROL\") || (CLIENT.TCP.CS_VSERVER.NAME.BEFORE_STR_ANY(\"PS_CL1009_NAME_PROTOCOLS\").TO_LOWER + \";lan;\" + CLIENT.IP.SRC.SUBNET(25).TYPECAST_TEXT_T + \"/25\").IS_STRINGMAP_KEY(\"SM_CL1009_IP_CONTROL\")"
add policy expression PE_CL1009_TCP_CS_IP_ISLAN_3X "(CLIENT.TCP.CS_VSERVER.NAME.BEFORE_STR_ANY(\"PS_CL1009_NAME_PROTOCOLS\").TO_LOWER + \";lan;\" + CLIENT.IP.SRC.TYPECAST_TEXT_T + \"/32\").IS_STRINGMAP_KEY(\"SM_CL1009_IP_CONTROL\") || (CLIENT.TCP.CS_VSERVER.NAME.BEFORE_STR_ANY(\"PS_CL1009_NAME_PROTOCOLS\").TO_LOWER + \";lan;\" + CLIENT.IP.SRC.SUBNET(31).TYPECAST_TEXT_T + \"/31\").IS_STRINGMAP_KEY(\"SM_CL1009_IP_CONTROL\") || (CLIENT.TCP.CS_VSERVER.NAME.BEFORE_STR_ANY(\"PS_CL1009_NAME_PROTOCOLS\").TO_LOWER + \";lan;\" + CLIENT.IP.SRC.SUBNET(30).TYPECAST_TEXT_T + \"/30\").IS_STRINGMAP_KEY(\"SM_CL1009_IP_CONTROL\")"

add policy expression PE_CL1009_UDP_CS_IP_ISLAN_0X_A "(CLIENT.UDP.CS_VSERVER.NAME.BEFORE_STR_ANY(\"PS_CL1009_NAME_PROTOCOLS\").TO_LOWER + \";lan;\" + CLIENT.IP.SRC.SUBNET(4).TYPECAST_TEXT_T + \"/4\").IS_STRINGMAP_KEY(\"SM_CL1009_IP_CONTROL\") || (CLIENT.UDP.CS_VSERVER.NAME.BEFORE_STR_ANY(\"PS_CL1009_NAME_PROTOCOLS\").TO_LOWER + \";lan;\" + CLIENT.IP.SRC.SUBNET(3).TYPECAST_TEXT_T + \"/3\").IS_STRINGMAP_KEY(\"SM_CL1009_IP_CONTROL\") || (CLIENT.UDP.CS_VSERVER.NAME.BEFORE_STR_ANY(\"PS_CL1009_NAME_PROTOCOLS\").TO_LOWER + \";lan;\" + CLIENT.IP.SRC.SUBNET(2).TYPECAST_TEXT_T + \"/2\").IS_STRINGMAP_KEY(\"SM_CL1009_IP_CONTROL\") || (CLIENT.UDP.CS_VSERVER.NAME.BEFORE_STR_ANY(\"PS_CL1009_NAME_PROTOCOLS\").TO_LOWER + \";lan;\" + CLIENT.IP.SRC.SUBNET(1).TYPECAST_TEXT_T + \"/1\").IS_STRINGMAP_KEY(\"SM_CL1009_IP_CONTROL\")"
add policy expression PE_CL1009_UDP_CS_IP_ISLAN_0X_B "(CLIENT.UDP.CS_VSERVER.NAME.BEFORE_STR_ANY(\"PS_CL1009_NAME_PROTOCOLS\").TO_LOWER + \";lan;\" + CLIENT.IP.SRC.SUBNET(9).TYPECAST_TEXT_T + \"/9\").IS_STRINGMAP_KEY(\"SM_CL1009_IP_CONTROL\") || (CLIENT.UDP.CS_VSERVER.NAME.BEFORE_STR_ANY(\"PS_CL1009_NAME_PROTOCOLS\").TO_LOWER + \";lan;\" + CLIENT.IP.SRC.SUBNET(8).TYPECAST_TEXT_T + \"/8\").IS_STRINGMAP_KEY(\"SM_CL1009_IP_CONTROL\") || (CLIENT.UDP.CS_VSERVER.NAME.BEFORE_STR_ANY(\"PS_CL1009_NAME_PROTOCOLS\").TO_LOWER + \";lan;\" + CLIENT.IP.SRC.SUBNET(7).TYPECAST_TEXT_T + \"/7\").IS_STRINGMAP_KEY(\"SM_CL1009_IP_CONTROL\") || (CLIENT.UDP.CS_VSERVER.NAME.BEFORE_STR_ANY(\"PS_CL1009_NAME_PROTOCOLS\").TO_LOWER + \";lan;\" + CLIENT.IP.SRC.SUBNET(6).TYPECAST_TEXT_T + \"/6\").IS_STRINGMAP_KEY(\"SM_CL1009_IP_CONTROL\") || (CLIENT.UDP.CS_VSERVER.NAME.BEFORE_STR_ANY(\"PS_CL1009_NAME_PROTOCOLS\").TO_LOWER + \";lan;\" + CLIENT.IP.SRC.SUBNET(5).TYPECAST_TEXT_T + \"/5\").IS_STRINGMAP_KEY(\"SM_CL1009_IP_CONTROL\")"
add policy expression PE_CL1009_UDP_CS_IP_ISLAN_1X_A "(CLIENT.UDP.CS_VSERVER.NAME.BEFORE_STR_ANY(\"PS_CL1009_NAME_PROTOCOLS\").TO_LOWER + \";lan;\" + CLIENT.IP.SRC.SUBNET(14).TYPECAST_TEXT_T + \"/14\").IS_STRINGMAP_KEY(\"SM_CL1009_IP_CONTROL\") || (CLIENT.UDP.CS_VSERVER.NAME.BEFORE_STR_ANY(\"PS_CL1009_NAME_PROTOCOLS\").TO_LOWER + \";lan;\" + CLIENT.IP.SRC.SUBNET(13).TYPECAST_TEXT_T + \"/13\").IS_STRINGMAP_KEY(\"SM_CL1009_IP_CONTROL\") || (CLIENT.UDP.CS_VSERVER.NAME.BEFORE_STR_ANY(\"PS_CL1009_NAME_PROTOCOLS\").TO_LOWER + \";lan;\" + CLIENT.IP.SRC.SUBNET(12).TYPECAST_TEXT_T + \"/12\").IS_STRINGMAP_KEY(\"SM_CL1009_IP_CONTROL\") || (CLIENT.UDP.CS_VSERVER.NAME.BEFORE_STR_ANY(\"PS_CL1009_NAME_PROTOCOLS\").TO_LOWER + \";lan;\" + CLIENT.IP.SRC.SUBNET(11).TYPECAST_TEXT_T + \"/11\").IS_STRINGMAP_KEY(\"SM_CL1009_IP_CONTROL\") || (CLIENT.UDP.CS_VSERVER.NAME.BEFORE_STR_ANY(\"PS_CL1009_NAME_PROTOCOLS\").TO_LOWER + \";lan;\" + CLIENT.IP.SRC.SUBNET(10).TYPECAST_TEXT_T + \"/10\").IS_STRINGMAP_KEY(\"SM_CL1009_IP_CONTROL\")"
add policy expression PE_CL1009_UDP_CS_IP_ISLAN_1X_B "(CLIENT.UDP.CS_VSERVER.NAME.BEFORE_STR_ANY(\"PS_CL1009_NAME_PROTOCOLS\").TO_LOWER + \";lan;\" + CLIENT.IP.SRC.SUBNET(19).TYPECAST_TEXT_T + \"/19\").IS_STRINGMAP_KEY(\"SM_CL1009_IP_CONTROL\") || (CLIENT.UDP.CS_VSERVER.NAME.BEFORE_STR_ANY(\"PS_CL1009_NAME_PROTOCOLS\").TO_LOWER + \";lan;\" + CLIENT.IP.SRC.SUBNET(18).TYPECAST_TEXT_T + \"/18\").IS_STRINGMAP_KEY(\"SM_CL1009_IP_CONTROL\") || (CLIENT.UDP.CS_VSERVER.NAME.BEFORE_STR_ANY(\"PS_CL1009_NAME_PROTOCOLS\").TO_LOWER + \";lan;\" + CLIENT.IP.SRC.SUBNET(17).TYPECAST_TEXT_T + \"/17\").IS_STRINGMAP_KEY(\"SM_CL1009_IP_CONTROL\") || (CLIENT.UDP.CS_VSERVER.NAME.BEFORE_STR_ANY(\"PS_CL1009_NAME_PROTOCOLS\").TO_LOWER + \";lan;\" + CLIENT.IP.SRC.SUBNET(16).TYPECAST_TEXT_T + \"/16\").IS_STRINGMAP_KEY(\"SM_CL1009_IP_CONTROL\") || (CLIENT.UDP.CS_VSERVER.NAME.BEFORE_STR_ANY(\"PS_CL1009_NAME_PROTOCOLS\").TO_LOWER + \";lan;\" + CLIENT.IP.SRC.SUBNET(15).TYPECAST_TEXT_T + \"/15\").IS_STRINGMAP_KEY(\"SM_CL1009_IP_CONTROL\")"
add policy expression PE_CL1009_UDP_CS_IP_ISLAN_2X_A "(CLIENT.UDP.CS_VSERVER.NAME.BEFORE_STR_ANY(\"PS_CL1009_NAME_PROTOCOLS\").TO_LOWER + \";lan;\" + CLIENT.IP.SRC.SUBNET(24).TYPECAST_TEXT_T + \"/24\").IS_STRINGMAP_KEY(\"SM_CL1009_IP_CONTROL\") || (CLIENT.UDP.CS_VSERVER.NAME.BEFORE_STR_ANY(\"PS_CL1009_NAME_PROTOCOLS\").TO_LOWER + \";lan;\" + CLIENT.IP.SRC.SUBNET(23).TYPECAST_TEXT_T + \"/23\").IS_STRINGMAP_KEY(\"SM_CL1009_IP_CONTROL\") || (CLIENT.UDP.CS_VSERVER.NAME.BEFORE_STR_ANY(\"PS_CL1009_NAME_PROTOCOLS\").TO_LOWER + \";lan;\" + CLIENT.IP.SRC.SUBNET(22).TYPECAST_TEXT_T + \"/22\").IS_STRINGMAP_KEY(\"SM_CL1009_IP_CONTROL\") || (CLIENT.UDP.CS_VSERVER.NAME.BEFORE_STR_ANY(\"PS_CL1009_NAME_PROTOCOLS\").TO_LOWER + \";lan;\" + CLIENT.IP.SRC.SUBNET(21).TYPECAST_TEXT_T + \"/21\").IS_STRINGMAP_KEY(\"SM_CL1009_IP_CONTROL\") || (CLIENT.UDP.CS_VSERVER.NAME.BEFORE_STR_ANY(\"PS_CL1009_NAME_PROTOCOLS\").TO_LOWER + \";lan;\" + CLIENT.IP.SRC.SUBNET(20).TYPECAST_TEXT_T + \"/20\").IS_STRINGMAP_KEY(\"SM_CL1009_IP_CONTROL\")"
add policy expression PE_CL1009_UDP_CS_IP_ISLAN_2X_B "(CLIENT.UDP.CS_VSERVER.NAME.BEFORE_STR_ANY(\"PS_CL1009_NAME_PROTOCOLS\").TO_LOWER + \";lan;\" + CLIENT.IP.SRC.SUBNET(29).TYPECAST_TEXT_T + \"/29\").IS_STRINGMAP_KEY(\"SM_CL1009_IP_CONTROL\") || (CLIENT.UDP.CS_VSERVER.NAME.BEFORE_STR_ANY(\"PS_CL1009_NAME_PROTOCOLS\").TO_LOWER + \";lan;\" + CLIENT.IP.SRC.SUBNET(28).TYPECAST_TEXT_T + \"/28\").IS_STRINGMAP_KEY(\"SM_CL1009_IP_CONTROL\") || (CLIENT.UDP.CS_VSERVER.NAME.BEFORE_STR_ANY(\"PS_CL1009_NAME_PROTOCOLS\").TO_LOWER + \";lan;\" + CLIENT.IP.SRC.SUBNET(27).TYPECAST_TEXT_T + \"/27\").IS_STRINGMAP_KEY(\"SM_CL1009_IP_CONTROL\") || (CLIENT.UDP.CS_VSERVER.NAME.BEFORE_STR_ANY(\"PS_CL1009_NAME_PROTOCOLS\").TO_LOWER + \";lan;\" + CLIENT.IP.SRC.SUBNET(26).TYPECAST_TEXT_T + \"/26\").IS_STRINGMAP_KEY(\"SM_CL1009_IP_CONTROL\") || (CLIENT.UDP.CS_VSERVER.NAME.BEFORE_STR_ANY(\"PS_CL1009_NAME_PROTOCOLS\").TO_LOWER + \";lan;\" + CLIENT.IP.SRC.SUBNET(25).TYPECAST_TEXT_T + \"/25\").IS_STRINGMAP_KEY(\"SM_CL1009_IP_CONTROL\")"
add policy expression PE_CL1009_UDP_CS_IP_ISLAN_3X "(CLIENT.UDP.CS_VSERVER.NAME.BEFORE_STR_ANY(\"PS_CL1009_NAME_PROTOCOLS\").TO_LOWER + \";lan;\" + CLIENT.IP.SRC.TYPECAST_TEXT_T + \"/32\").IS_STRINGMAP_KEY(\"SM_CL1009_IP_CONTROL\") || (CLIENT.UDP.CS_VSERVER.NAME.BEFORE_STR_ANY(\"PS_CL1009_NAME_PROTOCOLS\").TO_LOWER + \";lan;\" + CLIENT.IP.SRC.SUBNET(31).TYPECAST_TEXT_T + \"/31\").IS_STRINGMAP_KEY(\"SM_CL1009_IP_CONTROL\") || (CLIENT.UDP.CS_VSERVER.NAME.BEFORE_STR_ANY(\"PS_CL1009_NAME_PROTOCOLS\").TO_LOWER + \";lan;\" + CLIENT.IP.SRC.SUBNET(30).TYPECAST_TEXT_T + \"/30\").IS_STRINGMAP_KEY(\"SM_CL1009_IP_CONTROL\")"


### ACME PROTOCOL
add policy expression PE_CL1009_HTTP_CS_ACME_ANY_KEY "(HTTP.REQ.CS_VSERVER.NAME + \";any;\" + HTTP.REQ.HOSTNAME.SERVER + \"/.well-known/acme-challenge\").TO_LOWER"
add policy expression PE_CL1009_HTTP_CS_ACME_ANY_KEY_EXISTS "(HTTP.REQ.CS_VSERVER.NAME + \";any;\" + HTTP.REQ.HOSTNAME.SERVER + \"/.well-known/acme-challenge\").TO_LOWER.IS_STRINGMAP_KEY(\"SM_CL1009_CS_CONTROL\")"
add policy expression PE_CL1009_HTTP_CS_ACME_ANY_VALUE_VS "(HTTP.REQ.CS_VSERVER.NAME + \";any;\" + HTTP.REQ.HOSTNAME.SERVER + \"/.well-known/acme-challenge\").TO_LOWER.MAP_STRING(\"SM_CL1009_CS_CONTROL\").AFTER_STR(\"vs=\").BEFORE_STR(\";\")"

add audit messageaction LOG_CL1009_HTTP_CSP_ACME_ANY INFORMATIONAL q/"CL1009_CSP,HTTP,ACME,ANY," + PE_CL1009_REQ_TXID + "," + CLIENT.IP.SRC + "," + HTTP.REQ.CS_VSERVER.NAME + "," + HTTP.REQ.HOSTNAME + "," + HTTP.REQ.URL.PATH + "," + PE_CL1009_HTTP_CS_ACME_ANY_KEY + "," + PE_CL1009_HTTP_CS_ACME_ANY_VALUE_VS/

add cs action CSA_CL1009_HTTP_ACME_ANY -targetVserverExpr PE_CL1009_HTTP_CS_ACME_ANY_VALUE_VS
add cs policy CSP_CL1009_HTTP_ACME_ANY -rule PE_CL1009_HTTP_CS_ACME_ANY_KEY_EXISTS -action CSA_CL1009_HTTP_ACME_ANY -logAction LOG_CL1009_HTTP_CSP_ACME_ANY


### FULL - LAN ###
add policy expression PE_CL1009_HTTP_CS_FULL_LAN_KEY "(HTTP.REQ.CS_VSERVER.NAME + \";lan;\" + HTTP.REQ.HOSTNAME.SERVER + HTTP.REQ.URL.PATH).TO_LOWER"
add policy expression PE_CL1009_HTTP_CS_FULL_LAN_KEY_EXISTS "((HTTP.REQ.CS_VSERVER.NAME + \";lan;\" + HTTP.REQ.HOSTNAME.SERVER + HTTP.REQ.URL.PATH).TO_LOWER.IS_STRINGMAP_KEY(\"SM_CL1009_CS_CONTROL\"))"
add policy expression PE_CL1009_HTTP_CS_FULL_LAN_VALUE_DST "(HTTP.REQ.CS_VSERVER.NAME + \";lan;\" + HTTP.REQ.HOSTNAME.SERVER + HTTP.REQ.URL.PATH).TO_LOWER.MAP_STRING(\"SM_CL1009_CS_CONTROL\").AFTER_STR(\"dst=\").BEFORE_STR(\";\")"
add policy expression PE_CL1009_HTTP_CS_FULL_LAN_VALUE_VS "(HTTP.REQ.CS_VSERVER.NAME + \";lan;\" + HTTP.REQ.HOSTNAME.SERVER + HTTP.REQ.URL.PATH).TO_LOWER.MAP_STRING(\"SM_CL1009_CS_CONTROL\").AFTER_STR(\"vs=\").BEFORE_STR(\";\")"
add policy expression PE_CL1009_HTTP_NO_SERVICE_SWITCH_FULL_LAN_KEY_EXISTS "((HTTP.REQ.CS_VSERVER.NAME.BEFORE_STR_ANY(\"PS_CL1009_NAME_PROTOCOLS\") + \"_ssl;lan;\" + HTTP.REQ.HOSTNAME.SERVER + HTTP.REQ.URL.PATH).TO_LOWER.IS_STRINGMAP_KEY(\"SM_CL1009_CS_CONTROL\"))"
add audit messageaction LOG_CL1009_HTTP_CSP_FULL_LAN INFORMATIONAL q/"CL1009_CSP,HTTP,FULL,LAN," + PE_CL1009_REQ_TXID + "," + CLIENT.IP.SRC + "," + HTTP.REQ.CS_VSERVER.NAME + "," + HTTP.REQ.HOSTNAME + "," + HTTP.REQ.URL.PATH + "," + PE_CL1009_HTTP_CS_FULL_LAN_KEY + "," + PE_CL1009_HTTP_CS_FULL_LAN_VALUE_VS/
add audit messageaction LOG_CL1009_HTTP_RSP_NO_SERVICE_FULL_LAN INFORMATIONAL q/"CL1009_RSP,HTTP,FULL,LAN,NOSVC," + PE_CL1009_REQ_TXID + "," + HTTP.REQ.LB_VSERVER.NAME + "," + PE_CL1009_HTTP_CS_FULL_LAN_VALUE_VS/
add audit messageaction LOG_CL1009_HTTP_RSP_REDIR_FULL_LAN INFORMATIONAL q/"CL1009_RSP,HTTP,FULL,LAN,REDIR," + PE_CL1009_REQ_TXID + "," + HTTP.REQ.LB_VSERVER.NAME + "," + PE_CL1009_HTTP_CS_FULL_LAN_VALUE_DST/
add audit messageaction LOG_CL1009_HTTP_RSP_REDIR_KEEPPATH_FULL_LAN INFORMATIONAL q/"CL1009_RSP,HTTP,FULL,LAN,REDIR_KEEPPATH," + PE_CL1009_REQ_TXID + "," + HTTP.REQ.LB_VSERVER.NAME + "," + PE_CL1009_HTTP_CS_FULL_LAN_VALUE_DST/
add audit messageaction LOG_CL1009_HTTP_RSP_NO_SERVICE_SWITCH_FULL_LAN INFORMATIONAL q/"CL1009_RSP,HTTP,FULL,LAN,NOSVCSWITCH," + PE_CL1009_REQ_TXID + "," + HTTP.REQ.LB_VSERVER.NAME + "," + PE_CL1009_HTTP_CS_FULL_LAN_VALUE_VS/

add cs action CSA_CL1009_HTTP_FULL_LAN -targetVserverExpr PE_CL1009_HTTP_CS_FULL_LAN_VALUE_VS
add cs policy CSP_CL1009_HTTP_FULL_LAN -rule "(PE_CL1009_HTTP_CS_FULL_LAN_KEY_EXISTS && (PE_CL1009_TCP_CS_IP_ISLAN_3X || PE_CL1009_TCP_CS_IP_ISLAN_2X_B || PE_CL1009_TCP_CS_IP_ISLAN_2X_A || PE_CL1009_TCP_CS_IP_ISLAN_1X_B || PE_CL1009_TCP_CS_IP_ISLAN_1X_A || PE_CL1009_TCP_CS_IP_ISLAN_0X_B || PE_CL1009_TCP_CS_IP_ISLAN_0X_A))" -action CSA_CL1009_HTTP_FULL_LAN -logAction LOG_CL1009_HTTP_CSP_FULL_LAN

add responder action RSA_CL1009_HTTP_REDIR_FULL_LAN respondwith q/PE_CL1009_HTTP_REDIR + PE_CL1009_HTTP_CS_FULL_LAN_VALUE_DST + "\r\n\r\n"/
add responder policy RSP_CL1009_HTTP_REDIR_FULL_LAN "(PE_CL1009_HTTP_CS_FULL_LAN_KEY_EXISTS && (PE_CL1009_TCP_CS_IP_ISLAN_3X || PE_CL1009_TCP_CS_IP_ISLAN_2X_B || PE_CL1009_TCP_CS_IP_ISLAN_2X_A || PE_CL1009_TCP_CS_IP_ISLAN_1X_B || PE_CL1009_TCP_CS_IP_ISLAN_1X_A || PE_CL1009_TCP_CS_IP_ISLAN_0X_B || PE_CL1009_TCP_CS_IP_ISLAN_0X_A))" RSA_CL1009_HTTP_REDIR_FULL_LAN -logAction LOG_CL1009_HTTP_RSP_REDIR_FULL_LAN
add responder action RSA_CL1009_HTTP_REDIR_KEEPPATH_FULL_LAN respondwith q/PE_CL1009_HTTP_REDIR + PE_CL1009_HTTP_CS_FULL_LAN_VALUE_DST + HTTP.REQ.URL.PATH + "\r\n\r\n"/
add responder policy RSP_CL1009_HTTP_REDIR_KEEPPATH_FULL_LAN "(PE_CL1009_HTTP_CS_FULL_LAN_KEY_EXISTS && (PE_CL1009_TCP_CS_IP_ISLAN_3X || PE_CL1009_TCP_CS_IP_ISLAN_2X_B || PE_CL1009_TCP_CS_IP_ISLAN_2X_A || PE_CL1009_TCP_CS_IP_ISLAN_1X_B || PE_CL1009_TCP_CS_IP_ISLAN_1X_A || PE_CL1009_TCP_CS_IP_ISLAN_0X_B || PE_CL1009_TCP_CS_IP_ISLAN_0X_A))" RSA_CL1009_HTTP_REDIR_KEEPPATH_FULL_LAN -logAction LOG_CL1009_HTTP_RSP_REDIR_KEEPPATH_FULL_LAN
add responder policy RSP_CL1009_HTTP_NO_SERVICE_FULL_LAN "(PE_CL1009_HTTP_CS_FULL_LAN_KEY_EXISTS && (PE_CL1009_TCP_CS_IP_ISLAN_3X || PE_CL1009_TCP_CS_IP_ISLAN_2X_B || PE_CL1009_TCP_CS_IP_ISLAN_2X_A || PE_CL1009_TCP_CS_IP_ISLAN_1X_B || PE_CL1009_TCP_CS_IP_ISLAN_1X_A || PE_CL1009_TCP_CS_IP_ISLAN_0X_B || PE_CL1009_TCP_CS_IP_ISLAN_0X_A))" RSA_CL1009_NO_SERVICE -logAction LOG_CL1009_HTTP_RSP_NO_SERVICE_FULL_LAN
add responder policy RSP_CL1009_HTTP_NO_SERVICE_SWITCH_FULL_LAN "(PE_CL1009_HTTP_NO_SERVICE_SWITCH_FULL_LAN_KEY_EXISTS && (PE_CL1009_TCP_CS_IP_ISLAN_3X || PE_CL1009_TCP_CS_IP_ISLAN_2X_B || PE_CL1009_TCP_CS_IP_ISLAN_2X_A || PE_CL1009_TCP_CS_IP_ISLAN_1X_B || PE_CL1009_TCP_CS_IP_ISLAN_1X_A || PE_CL1009_TCP_CS_IP_ISLAN_0X_B || PE_CL1009_TCP_CS_IP_ISLAN_0X_A))" RSA_CL1009_HTTP_REDIR_SWITCH -logAction LOG_CL1009_HTTP_RSP_NO_SERVICE_SWITCH_FULL_LAN




### FULL - ANY ###
add policy expression PE_CL1009_HTTP_CS_FULL_ANY_KEY "(HTTP.REQ.CS_VSERVER.NAME + \";any;\" + HTTP.REQ.HOSTNAME.SERVER + HTTP.REQ.URL.PATH).TO_LOWER"
add policy expression PE_CL1009_HTTP_CS_FULL_ANY_KEY_EXISTS "(HTTP.REQ.CS_VSERVER.NAME + \";any;\" + HTTP.REQ.HOSTNAME.SERVER + HTTP.REQ.URL.PATH).TO_LOWER.IS_STRINGMAP_KEY(\"SM_CL1009_CS_CONTROL\")"
add policy expression PE_CL1009_HTTP_CS_FULL_ANY_VALUE_DST "(HTTP.REQ.CS_VSERVER.NAME + \";any;\" + HTTP.REQ.HOSTNAME.SERVER + HTTP.REQ.URL.PATH).TO_LOWER.MAP_STRING(\"SM_CL1009_CS_CONTROL\").AFTER_STR(\"dst=\").BEFORE_STR(\";\")"
add policy expression PE_CL1009_HTTP_CS_FULL_ANY_VALUE_VS "(HTTP.REQ.CS_VSERVER.NAME + \";any;\" + HTTP.REQ.HOSTNAME.SERVER + HTTP.REQ.URL.PATH).TO_LOWER.MAP_STRING(\"SM_CL1009_CS_CONTROL\").AFTER_STR(\"vs=\").BEFORE_STR(\";\")"
add policy expression PE_CL1009_HTTP_NO_SERVICE_SWITCH_FULL_ANY_KEY_EXISTS "(HTTP.REQ.CS_VSERVER.NAME.BEFORE_STR_ANY(\"PS_CL1009_NAME_PROTOCOLS\") + \"_ssl;any;\" + HTTP.REQ.HOSTNAME.SERVER + HTTP.REQ.URL.PATH).TO_LOWER.IS_STRINGMAP_KEY(\"SM_CL1009_CS_CONTROL\")"
add audit messageaction LOG_CL1009_HTTP_CSP_FULL_ANY INFORMATIONAL q/"CL1009_CSP,HTTP,FULL,ANY," + PE_CL1009_REQ_TXID + "," + CLIENT.IP.SRC + "," + HTTP.REQ.CS_VSERVER.NAME + "," + HTTP.REQ.HOSTNAME + "," + HTTP.REQ.URL.PATH + "," + PE_CL1009_HTTP_CS_FULL_ANY_KEY + "," + PE_CL1009_HTTP_CS_FULL_ANY_VALUE_VS/
add audit messageaction LOG_CL1009_HTTP_RSP_NO_SERVICE_FULL_ANY INFORMATIONAL q/"CL1009_RSP,HTTP,FULL,ANY,NOSVC," + PE_CL1009_REQ_TXID + "," + HTTP.REQ.LB_VSERVER.NAME + "," + PE_CL1009_HTTP_CS_FULL_ANY_VALUE_VS/
add audit messageaction LOG_CL1009_HTTP_RSP_REDIR_FULL_ANY INFORMATIONAL q/"CL1009_RSP,HTTP,FULL,ANY,REDIR," + PE_CL1009_REQ_TXID + "," + HTTP.REQ.LB_VSERVER.NAME + "," + PE_CL1009_HTTP_CS_FULL_ANY_VALUE_DST/
add audit messageaction LOG_CL1009_HTTP_RSP_REDIR_KEEPPATH_FULL_ANY INFORMATIONAL q/"CL1009_RSP,HTTP,FULL,ANY,REDIR_KEEPPATH," + PE_CL1009_REQ_TXID + "," + HTTP.REQ.LB_VSERVER.NAME + "," + PE_CL1009_HTTP_CS_FULL_ANY_VALUE_DST/
add audit messageaction LOG_CL1009_HTTP_RSP_NO_SERVICE_SWITCH_FULL_ANY INFORMATIONAL q/"CL1009_RSP,HTTP,FULL,ANY,NOSVCSWITCH," + PE_CL1009_REQ_TXID + "," + HTTP.REQ.LB_VSERVER.NAME + "," + PE_CL1009_HTTP_CS_FULL_ANY_VALUE_VS/

add cs action CSA_CL1009_HTTP_FULL_ANY -targetVserverExpr PE_CL1009_HTTP_CS_FULL_ANY_VALUE_VS
add cs policy CSP_CL1009_HTTP_FULL_ANY -rule PE_CL1009_HTTP_CS_FULL_ANY_KEY_EXISTS -action CSA_CL1009_HTTP_FULL_ANY -logAction LOG_CL1009_HTTP_CSP_FULL_ANY

add responder action RSA_CL1009_HTTP_REDIR_FULL_ANY respondwith q/PE_CL1009_HTTP_REDIR + PE_CL1009_HTTP_CS_FULL_ANY_VALUE_DST + "\r\n\r\n"/
add responder policy RSP_CL1009_HTTP_REDIR_FULL_ANY PE_CL1009_HTTP_CS_FULL_ANY_KEY_EXISTS RSA_CL1009_HTTP_REDIR_FULL_ANY -logAction LOG_CL1009_HTTP_RSP_REDIR_FULL_ANY
add responder action RSA_CL1009_HTTP_REDIR_KEEPPATH_FULL_ANY respondwith q/PE_CL1009_HTTP_REDIR + PE_CL1009_HTTP_CS_FULL_ANY_VALUE_DST + HTTP.REQ.URL.PATH + "\r\n\r\n"/
add responder policy RSP_CL1009_HTTP_REDIR_KEEPPATH_FULL_ANY PE_CL1009_HTTP_CS_FULL_ANY_KEY_EXISTS RSA_CL1009_HTTP_REDIR_KEEPPATH_FULL_ANY -logAction LOG_CL1009_HTTP_RSP_REDIR_KEEPPATH_FULL_ANY
add responder policy RSP_CL1009_HTTP_NO_SERVICE_FULL_ANY PE_CL1009_HTTP_CS_FULL_ANY_KEY_EXISTS RSA_CL1009_NO_SERVICE -logAction LOG_CL1009_HTTP_RSP_NO_SERVICE_FULL_ANY
add responder policy RSP_CL1009_HTTP_NO_SERVICE_SWITCH_FULL_ANY PE_CL1009_HTTP_NO_SERVICE_SWITCH_FULL_ANY_KEY_EXISTS RSA_CL1009_HTTP_REDIR_SWITCH -logAction LOG_CL1009_HTTP_RSP_NO_SERVICE_SWITCH_FULL_ANY




### SCND - LAN ###
add policy expression PE_CL1009_HTTP_CS_SCND_LAN_KEY "(HTTP.REQ.CS_VSERVER.NAME + \";lan;\" + HTTP.REQ.HOSTNAME.SERVER + \"/\" + HTTP.REQ.URL.PATH.GET(1) + \"/\" + HTTP.REQ.URL.PATH.GET(2)).TO_LOWER"
add policy expression PE_CL1009_HTTP_CS_SCND_LAN_KEY_EXISTS "(HTTP.REQ.CS_VSERVER.NAME + \";lan;\" + HTTP.REQ.HOSTNAME.SERVER + \"/\" + HTTP.REQ.URL.PATH.GET(1) + \"/\" + HTTP.REQ.URL.PATH.GET(2)).TO_LOWER.IS_STRINGMAP_KEY(\"SM_CL1009_CS_CONTROL\")"
add policy expression PE_CL1009_HTTP_CS_SCND_LAN_VALUE_DST "(HTTP.REQ.CS_VSERVER.NAME + \";lan;\" + HTTP.REQ.HOSTNAME.SERVER + \"/\" + HTTP.REQ.URL.PATH.GET(1) + \"/\" + HTTP.REQ.URL.PATH.GET(2)).TO_LOWER.MAP_STRING(\"SM_CL1009_CS_CONTROL\").AFTER_STR(\"dst=\").BEFORE_STR(\";\")"
add policy expression PE_CL1009_HTTP_CS_SCND_LAN_VALUE_VS "(HTTP.REQ.CS_VSERVER.NAME + \";lan;\" + HTTP.REQ.HOSTNAME.SERVER + \"/\" + HTTP.REQ.URL.PATH.GET(1) + \"/\" + HTTP.REQ.URL.PATH.GET(2)).TO_LOWER.MAP_STRING(\"SM_CL1009_CS_CONTROL\").AFTER_STR(\"vs=\").BEFORE_STR(\";\")"
add policy expression PE_CL1009_HTTP_NO_SERVICE_SWITCH_SCND_LAN_KEY_EXISTS "(HTTP.REQ.CS_VSERVER.NAME.BEFORE_STR_ANY(\"PS_CL1009_NAME_PROTOCOLS\") + \"_ssl;lan;\" + HTTP.REQ.HOSTNAME.SERVER + \"/\" + HTTP.REQ.URL.PATH.GET(1) + \"/\" + HTTP.REQ.URL.PATH.GET(2)).TO_LOWER.IS_STRINGMAP_KEY(\"SM_CL1009_CS_CONTROL\")"
add audit messageaction LOG_CL1009_HTTP_CSP_SCND_LAN INFORMATIONAL q/"CL1009_CSP,HTTP,SCND,LAN," + PE_CL1009_REQ_TXID + "," + CLIENT.IP.SRC + "," + HTTP.REQ.CS_VSERVER.NAME + "," + HTTP.REQ.HOSTNAME + "," + HTTP.REQ.URL.PATH + "," + PE_CL1009_HTTP_CS_SCND_LAN_KEY + "," + PE_CL1009_HTTP_CS_SCND_LAN_VALUE_VS/
add audit messageaction LOG_CL1009_HTTP_RSP_NO_SERVICE_SCND_LAN INFORMATIONAL q/"CL1009_RSP,HTTP,SCND,LAN,NOSVC," + PE_CL1009_REQ_TXID + "," + HTTP.REQ.LB_VSERVER.NAME + "," + PE_CL1009_HTTP_CS_SCND_LAN_VALUE_VS/
add audit messageaction LOG_CL1009_HTTP_RSP_REDIR_SCND_LAN INFORMATIONAL q/"CL1009_RSP,HTTP,SCND,LAN,REDIR," + PE_CL1009_REQ_TXID + "," + HTTP.REQ.LB_VSERVER.NAME + "," + PE_CL1009_HTTP_CS_SCND_LAN_VALUE_DST/
add audit messageaction LOG_CL1009_HTTP_RSP_REDIR_KEEPPATH_SCND_LAN INFORMATIONAL q/"CL1009_RSP,HTTP,SCND,LAN,REDIR_KEEPPATH," + PE_CL1009_REQ_TXID + "," + HTTP.REQ.LB_VSERVER.NAME + "," + PE_CL1009_HTTP_CS_SCND_LAN_VALUE_DST/
add audit messageaction LOG_CL1009_HTTP_RSP_NO_SERVICE_SWITCH_SCND_LAN INFORMATIONAL q/"CL1009_RSP,HTTP,SCND,LAN,NOSVCSWITCH," + PE_CL1009_REQ_TXID + "," + HTTP.REQ.LB_VSERVER.NAME + "," + PE_CL1009_HTTP_CS_SCND_LAN_VALUE_VS/

add cs action CSA_CL1009_HTTP_SCND_LAN -targetVserverExpr PE_CL1009_HTTP_CS_SCND_LAN_VALUE_VS
add cs policy CSP_CL1009_HTTP_SCND_LAN -rule "(PE_CL1009_HTTP_CS_SCND_LAN_KEY_EXISTS && (PE_CL1009_TCP_CS_IP_ISLAN_3X || PE_CL1009_TCP_CS_IP_ISLAN_2X_B || PE_CL1009_TCP_CS_IP_ISLAN_2X_A || PE_CL1009_TCP_CS_IP_ISLAN_1X_B || PE_CL1009_TCP_CS_IP_ISLAN_1X_A || PE_CL1009_TCP_CS_IP_ISLAN_0X_B || PE_CL1009_TCP_CS_IP_ISLAN_0X_A))" -action CSA_CL1009_HTTP_SCND_LAN -logAction LOG_CL1009_HTTP_CSP_SCND_LAN

add responder action RSA_CL1009_HTTP_REDIR_SCND_LAN respondwith q/PE_CL1009_HTTP_REDIR + PE_CL1009_HTTP_CS_SCND_LAN_VALUE_DST + "\r\n\r\n"/
add responder policy RSP_CL1009_HTTP_REDIR_SCND_LAN "(PE_CL1009_HTTP_CS_SCND_LAN_KEY_EXISTS && (PE_CL1009_TCP_CS_IP_ISLAN_3X || PE_CL1009_TCP_CS_IP_ISLAN_2X_B || PE_CL1009_TCP_CS_IP_ISLAN_2X_A || PE_CL1009_TCP_CS_IP_ISLAN_1X_B || PE_CL1009_TCP_CS_IP_ISLAN_1X_A || PE_CL1009_TCP_CS_IP_ISLAN_0X_B || PE_CL1009_TCP_CS_IP_ISLAN_0X_A))" RSA_CL1009_HTTP_REDIR_SCND_LAN -logAction LOG_CL1009_HTTP_RSP_REDIR_SCND_LAN
add responder action RSA_CL1009_HTTP_REDIR_KEEPPATH_SCND_LAN respondwith q/PE_CL1009_HTTP_REDIR + PE_CL1009_HTTP_CS_SCND_LAN_VALUE_DST + HTTP.REQ.URL.PATH + "\r\n\r\n"/
add responder policy RSP_CL1009_HTTP_REDIR_KEEPPATH_SCND_LAN "(PE_CL1009_HTTP_CS_SCND_LAN_KEY_EXISTS && (PE_CL1009_TCP_CS_IP_ISLAN_3X || PE_CL1009_TCP_CS_IP_ISLAN_2X_B || PE_CL1009_TCP_CS_IP_ISLAN_2X_A || PE_CL1009_TCP_CS_IP_ISLAN_1X_B || PE_CL1009_TCP_CS_IP_ISLAN_1X_A || PE_CL1009_TCP_CS_IP_ISLAN_0X_B || PE_CL1009_TCP_CS_IP_ISLAN_0X_A))" RSA_CL1009_HTTP_REDIR_KEEPPATH_SCND_LAN -logAction LOG_CL1009_HTTP_RSP_REDIR_KEEPPATH_SCND_LAN
add responder policy RSP_CL1009_HTTP_NO_SERVICE_SCND_LAN "(PE_CL1009_HTTP_CS_SCND_LAN_KEY_EXISTS && (PE_CL1009_TCP_CS_IP_ISLAN_3X || PE_CL1009_TCP_CS_IP_ISLAN_2X_B || PE_CL1009_TCP_CS_IP_ISLAN_2X_A || PE_CL1009_TCP_CS_IP_ISLAN_1X_B || PE_CL1009_TCP_CS_IP_ISLAN_1X_A || PE_CL1009_TCP_CS_IP_ISLAN_0X_B || PE_CL1009_TCP_CS_IP_ISLAN_0X_A))" RSA_CL1009_NO_SERVICE -logAction LOG_CL1009_HTTP_RSP_NO_SERVICE_SCND_LAN
add responder policy RSP_CL1009_HTTP_NO_SERVICE_SWITCH_SCND_LAN "(PE_CL1009_HTTP_NO_SERVICE_SWITCH_SCND_LAN_KEY_EXISTS && (PE_CL1009_TCP_CS_IP_ISLAN_3X || PE_CL1009_TCP_CS_IP_ISLAN_2X_B || PE_CL1009_TCP_CS_IP_ISLAN_2X_A || PE_CL1009_TCP_CS_IP_ISLAN_1X_B || PE_CL1009_TCP_CS_IP_ISLAN_1X_A || PE_CL1009_TCP_CS_IP_ISLAN_0X_B || PE_CL1009_TCP_CS_IP_ISLAN_0X_A))" RSA_CL1009_HTTP_REDIR_SWITCH -logAction LOG_CL1009_HTTP_RSP_NO_SERVICE_SWITCH_SCND_LAN




### SCND - ANY ###
add policy expression PE_CL1009_HTTP_CS_SCND_ANY_KEY "(HTTP.REQ.CS_VSERVER.NAME + \";any;\" + HTTP.REQ.HOSTNAME.SERVER + \"/\" + HTTP.REQ.URL.PATH.GET(1) + \"/\" + HTTP.REQ.URL.PATH.GET(2)).TO_LOWER"
add policy expression PE_CL1009_HTTP_CS_SCND_ANY_KEY_EXISTS "(HTTP.REQ.CS_VSERVER.NAME + \";any;\" + HTTP.REQ.HOSTNAME.SERVER + \"/\" + HTTP.REQ.URL.PATH.GET(1) + \"/\" + HTTP.REQ.URL.PATH.GET(2)).TO_LOWER.IS_STRINGMAP_KEY(\"SM_CL1009_CS_CONTROL\")"
add policy expression PE_CL1009_HTTP_CS_SCND_ANY_VALUE_DST "(HTTP.REQ.CS_VSERVER.NAME + \";any;\" + HTTP.REQ.HOSTNAME.SERVER + \"/\" + HTTP.REQ.URL.PATH.GET(1) + \"/\" + HTTP.REQ.URL.PATH.GET(2)).TO_LOWER.MAP_STRING(\"SM_CL1009_CS_CONTROL\").AFTER_STR(\"dst=\").BEFORE_STR(\";\")"
add policy expression PE_CL1009_HTTP_CS_SCND_ANY_VALUE_VS "(HTTP.REQ.CS_VSERVER.NAME + \";any;\" + HTTP.REQ.HOSTNAME.SERVER + \"/\" + HTTP.REQ.URL.PATH.GET(1) + \"/\" + HTTP.REQ.URL.PATH.GET(2)).TO_LOWER.MAP_STRING(\"SM_CL1009_CS_CONTROL\").AFTER_STR(\"vs=\").BEFORE_STR(\";\")"
add policy expression PE_CL1009_HTTP_NO_SERVICE_SWITCH_SCND_ANY_KEY_EXISTS "(HTTP.REQ.CS_VSERVER.NAME.BEFORE_STR_ANY(\"PS_CL1009_NAME_PROTOCOLS\") + \"_ssl;any;\" + HTTP.REQ.HOSTNAME.SERVER + \"/\" + HTTP.REQ.URL.PATH.GET(1) + \"/\" + HTTP.REQ.URL.PATH.GET(2)).TO_LOWER.IS_STRINGMAP_KEY(\"SM_CL1009_CS_CONTROL\")"
add audit messageaction LOG_CL1009_HTTP_CSP_SCND_ANY INFORMATIONAL q/"CL1009_CSP,HTTP,SCND,ANY," + PE_CL1009_REQ_TXID + "," + CLIENT.IP.SRC + "," + HTTP.REQ.CS_VSERVER.NAME + "," + HTTP.REQ.HOSTNAME + "," + HTTP.REQ.URL.PATH + "," + PE_CL1009_HTTP_CS_SCND_ANY_KEY + "," + PE_CL1009_HTTP_CS_SCND_ANY_VALUE_VS/
add audit messageaction LOG_CL1009_HTTP_RSP_NO_SERVICE_SCND_ANY INFORMATIONAL q/"CL1009_RSP,HTTP,SCND,ANY,NOSVC," + PE_CL1009_REQ_TXID + "," + HTTP.REQ.LB_VSERVER.NAME + "," + PE_CL1009_HTTP_CS_SCND_ANY_VALUE_VS/
add audit messageaction LOG_CL1009_HTTP_RSP_REDIR_SCND_ANY INFORMATIONAL q/"CL1009_RSP,HTTP,SCND,ANY,REDIR," + PE_CL1009_REQ_TXID + "," + HTTP.REQ.LB_VSERVER.NAME + "," + PE_CL1009_HTTP_CS_SCND_ANY_VALUE_DST/
add audit messageaction LOG_CL1009_HTTP_RSP_REDIR_KEEPPATH_SCND_ANY INFORMATIONAL q/"CL1009_RSP,HTTP,SCND,ANY,REDIR_KEEPPATH," + PE_CL1009_REQ_TXID + "," + HTTP.REQ.LB_VSERVER.NAME + "," + PE_CL1009_HTTP_CS_SCND_ANY_VALUE_DST/
add audit messageaction LOG_CL1009_HTTP_RSP_NO_SERVICE_SWITCH_SCND_ANY INFORMATIONAL q/"CL1009_RSP,HTTP,SCND,ANY,NOSVCSWITCH," + PE_CL1009_REQ_TXID + "," + HTTP.REQ.LB_VSERVER.NAME + "," + PE_CL1009_HTTP_CS_SCND_ANY_VALUE_VS/

add cs action CSA_CL1009_HTTP_SCND_ANY -targetVserverExpr PE_CL1009_HTTP_CS_SCND_ANY_VALUE_VS
add cs policy CSP_CL1009_HTTP_SCND_ANY -rule PE_CL1009_HTTP_CS_SCND_ANY_KEY_EXISTS -action CSA_CL1009_HTTP_SCND_ANY -logAction LOG_CL1009_HTTP_CSP_SCND_ANY

add responder action RSA_CL1009_HTTP_REDIR_SCND_ANY respondwith q/PE_CL1009_HTTP_REDIR + PE_CL1009_HTTP_CS_SCND_ANY_VALUE_DST + "\r\n\r\n"/
add responder policy RSP_CL1009_HTTP_REDIR_SCND_ANY PE_CL1009_HTTP_CS_SCND_ANY_KEY_EXISTS RSA_CL1009_HTTP_REDIR_SCND_ANY -logAction LOG_CL1009_HTTP_RSP_REDIR_SCND_ANY
add responder action RSA_CL1009_HTTP_REDIR_KEEPPATH_SCND_ANY respondwith q/PE_CL1009_HTTP_REDIR + PE_CL1009_HTTP_CS_SCND_ANY_VALUE_DST + HTTP.REQ.URL.PATH + "\r\n\r\n"/
add responder policy RSP_CL1009_HTTP_REDIR_KEEPPATH_SCND_ANY PE_CL1009_HTTP_CS_SCND_ANY_KEY_EXISTS RSA_CL1009_HTTP_REDIR_KEEPPATH_SCND_ANY -logAction LOG_CL1009_HTTP_RSP_REDIR_KEEPPATH_SCND_ANY
add responder policy RSP_CL1009_HTTP_NO_SERVICE_SCND_ANY PE_CL1009_HTTP_CS_SCND_ANY_KEY_EXISTS RSA_CL1009_NO_SERVICE -logAction LOG_CL1009_HTTP_RSP_NO_SERVICE_SCND_ANY
add responder policy RSP_CL1009_HTTP_NO_SERVICE_SWITCH_SCND_ANY PE_CL1009_HTTP_NO_SERVICE_SWITCH_SCND_ANY_KEY_EXISTS RSA_CL1009_HTTP_REDIR_SWITCH -logAction LOG_CL1009_HTTP_RSP_NO_SERVICE_SWITCH_SCND_ANY




### FRST - LAN ###
add policy expression PE_CL1009_HTTP_CS_FRST_LAN_KEY "(HTTP.REQ.CS_VSERVER.NAME + \";lan;\" + HTTP.REQ.HOSTNAME.SERVER + \"/\" + HTTP.REQ.URL.PATH.GET(1)).TO_LOWER"
add policy expression PE_CL1009_HTTP_CS_FRST_LAN_KEY_EXISTS "(HTTP.REQ.CS_VSERVER.NAME + \";lan;\" + HTTP.REQ.HOSTNAME.SERVER + \"/\" + HTTP.REQ.URL.PATH.GET(1)).TO_LOWER.IS_STRINGMAP_KEY(\"SM_CL1009_CS_CONTROL\")"
add policy expression PE_CL1009_HTTP_CS_FRST_LAN_VALUE_DST "(HTTP.REQ.CS_VSERVER.NAME + \";lan;\" + HTTP.REQ.HOSTNAME.SERVER + \"/\" + HTTP.REQ.URL.PATH.GET(1)).TO_LOWER.MAP_STRING(\"SM_CL1009_CS_CONTROL\").AFTER_STR(\"dst=\").BEFORE_STR(\";\")"
add policy expression PE_CL1009_HTTP_CS_FRST_LAN_VALUE_VS "(HTTP.REQ.CS_VSERVER.NAME + \";lan;\" + HTTP.REQ.HOSTNAME.SERVER + \"/\" + HTTP.REQ.URL.PATH.GET(1)).TO_LOWER.MAP_STRING(\"SM_CL1009_CS_CONTROL\").AFTER_STR(\"vs=\").BEFORE_STR(\";\")"
add policy expression PE_CL1009_HTTP_NO_SERVICE_SWITCH_FRST_LAN_KEY_EXISTS "(HTTP.REQ.CS_VSERVER.NAME.BEFORE_STR_ANY(\"PS_CL1009_NAME_PROTOCOLS\") + \"_ssl;lan;\" + HTTP.REQ.HOSTNAME.SERVER + \"/\" + HTTP.REQ.URL.PATH.GET(1)).TO_LOWER.IS_STRINGMAP_KEY(\"SM_CL1009_CS_CONTROL\")"
add audit messageaction LOG_CL1009_HTTP_CSP_FRST_LAN INFORMATIONAL q/"CL1009_CSP,HTTP,FRST,LAN," + PE_CL1009_REQ_TXID + "," + CLIENT.IP.SRC + "," + HTTP.REQ.CS_VSERVER.NAME + "," + HTTP.REQ.HOSTNAME + "," + HTTP.REQ.URL.PATH + "," + PE_CL1009_HTTP_CS_FRST_LAN_KEY + "," + PE_CL1009_HTTP_CS_FRST_LAN_VALUE_VS/
add audit messageaction LOG_CL1009_HTTP_RSP_NO_SERVICE_FRST_LAN INFORMATIONAL q/"CL1009_RSP,HTTP,FRST,LAN,NOSVC," + PE_CL1009_REQ_TXID + "," + HTTP.REQ.LB_VSERVER.NAME + "," + PE_CL1009_HTTP_CS_FRST_LAN_VALUE_VS/
add audit messageaction LOG_CL1009_HTTP_RSP_REDIR_FRST_LAN INFORMATIONAL q/"CL1009_RSP,HTTP,FRST,LAN,REDIR," + PE_CL1009_REQ_TXID + "," + HTTP.REQ.LB_VSERVER.NAME + "," + PE_CL1009_HTTP_CS_FRST_LAN_VALUE_DST/
add audit messageaction LOG_CL1009_HTTP_RSP_REDIR_KEEPPATH_FRST_LAN INFORMATIONAL q/"CL1009_RSP,HTTP,FRST,LAN,REDIR_KEEPPATH," + PE_CL1009_REQ_TXID + "," + HTTP.REQ.LB_VSERVER.NAME + "," + PE_CL1009_HTTP_CS_FRST_LAN_VALUE_DST/
add audit messageaction LOG_CL1009_HTTP_RSP_NO_SERVICE_SWITCH_FRST_LAN INFORMATIONAL q/"CL1009_RSP,HTTP,FRST,LAN,NOSVCSWITCH," + PE_CL1009_REQ_TXID + "," + HTTP.REQ.LB_VSERVER.NAME + "," + PE_CL1009_HTTP_CS_FRST_LAN_VALUE_VS/

add cs action CSA_CL1009_HTTP_FRST_LAN -targetVserverExpr PE_CL1009_HTTP_CS_FRST_LAN_VALUE_VS
add cs policy CSP_CL1009_HTTP_FRST_LAN -rule "(PE_CL1009_HTTP_CS_FRST_LAN_KEY_EXISTS && (PE_CL1009_TCP_CS_IP_ISLAN_3X || PE_CL1009_TCP_CS_IP_ISLAN_2X_B || PE_CL1009_TCP_CS_IP_ISLAN_2X_A || PE_CL1009_TCP_CS_IP_ISLAN_1X_B || PE_CL1009_TCP_CS_IP_ISLAN_1X_A || PE_CL1009_TCP_CS_IP_ISLAN_0X_B || PE_CL1009_TCP_CS_IP_ISLAN_0X_A))" -action CSA_CL1009_HTTP_FRST_LAN -logAction LOG_CL1009_HTTP_CSP_FRST_LAN

add responder action RSA_CL1009_HTTP_REDIR_FRST_LAN respondwith q/PE_CL1009_HTTP_REDIR + PE_CL1009_HTTP_CS_FRST_LAN_VALUE_DST + "\r\n\r\n"/
add responder policy RSP_CL1009_HTTP_REDIR_FRST_LAN "(PE_CL1009_HTTP_CS_FRST_LAN_KEY_EXISTS && (PE_CL1009_TCP_CS_IP_ISLAN_3X || PE_CL1009_TCP_CS_IP_ISLAN_2X_B || PE_CL1009_TCP_CS_IP_ISLAN_2X_A || PE_CL1009_TCP_CS_IP_ISLAN_1X_B || PE_CL1009_TCP_CS_IP_ISLAN_1X_A || PE_CL1009_TCP_CS_IP_ISLAN_0X_B || PE_CL1009_TCP_CS_IP_ISLAN_0X_A))" RSA_CL1009_HTTP_REDIR_FRST_LAN -logAction LOG_CL1009_HTTP_RSP_REDIR_FRST_LAN
add responder action RSA_CL1009_HTTP_REDIR_KEEPPATH_FRST_LAN respondwith q/PE_CL1009_HTTP_REDIR + PE_CL1009_HTTP_CS_FRST_LAN_VALUE_DST + HTTP.REQ.URL.PATH + "\r\n\r\n"/
add responder policy RSP_CL1009_HTTP_REDIR_KEEPPATH_FRST_LAN "(PE_CL1009_HTTP_CS_FRST_LAN_KEY_EXISTS && (PE_CL1009_TCP_CS_IP_ISLAN_3X || PE_CL1009_TCP_CS_IP_ISLAN_2X_B || PE_CL1009_TCP_CS_IP_ISLAN_2X_A || PE_CL1009_TCP_CS_IP_ISLAN_1X_B || PE_CL1009_TCP_CS_IP_ISLAN_1X_A || PE_CL1009_TCP_CS_IP_ISLAN_0X_B || PE_CL1009_TCP_CS_IP_ISLAN_0X_A))" RSA_CL1009_HTTP_REDIR_KEEPPATH_FRST_LAN -logAction LOG_CL1009_HTTP_RSP_REDIR_KEEPPATH_FRST_LAN
add responder policy RSP_CL1009_HTTP_NO_SERVICE_FRST_LAN "(PE_CL1009_HTTP_CS_FRST_LAN_KEY_EXISTS && (PE_CL1009_TCP_CS_IP_ISLAN_3X || PE_CL1009_TCP_CS_IP_ISLAN_2X_B || PE_CL1009_TCP_CS_IP_ISLAN_2X_A || PE_CL1009_TCP_CS_IP_ISLAN_1X_B || PE_CL1009_TCP_CS_IP_ISLAN_1X_A || PE_CL1009_TCP_CS_IP_ISLAN_0X_B || PE_CL1009_TCP_CS_IP_ISLAN_0X_A))" RSA_CL1009_NO_SERVICE -logAction LOG_CL1009_HTTP_RSP_NO_SERVICE_FRST_LAN
add responder policy RSP_CL1009_HTTP_NO_SERVICE_SWITCH_FRST_LAN "(PE_CL1009_HTTP_NO_SERVICE_SWITCH_FRST_LAN_KEY_EXISTS && (PE_CL1009_TCP_CS_IP_ISLAN_3X || PE_CL1009_TCP_CS_IP_ISLAN_2X_B || PE_CL1009_TCP_CS_IP_ISLAN_2X_A || PE_CL1009_TCP_CS_IP_ISLAN_1X_B || PE_CL1009_TCP_CS_IP_ISLAN_1X_A || PE_CL1009_TCP_CS_IP_ISLAN_0X_B || PE_CL1009_TCP_CS_IP_ISLAN_0X_A))" RSA_CL1009_HTTP_REDIR_SWITCH -logAction LOG_CL1009_HTTP_RSP_NO_SERVICE_SWITCH_FRST_LAN




### FRST - ANY ###
add policy expression PE_CL1009_HTTP_CS_FRST_ANY_KEY "(HTTP.REQ.CS_VSERVER.NAME + \";any;\" + HTTP.REQ.HOSTNAME.SERVER + \"/\" + HTTP.REQ.URL.PATH.GET(1)).TO_LOWER"
add policy expression PE_CL1009_HTTP_CS_FRST_ANY_KEY_EXISTS "(HTTP.REQ.CS_VSERVER.NAME + \";any;\" + HTTP.REQ.HOSTNAME.SERVER + \"/\" + HTTP.REQ.URL.PATH.GET(1)).TO_LOWER.IS_STRINGMAP_KEY(\"SM_CL1009_CS_CONTROL\")"
add policy expression PE_CL1009_HTTP_CS_FRST_ANY_VALUE_DST "(HTTP.REQ.CS_VSERVER.NAME + \";any;\" + HTTP.REQ.HOSTNAME.SERVER + \"/\" + HTTP.REQ.URL.PATH.GET(1)).TO_LOWER.MAP_STRING(\"SM_CL1009_CS_CONTROL\").AFTER_STR(\"dst=\").BEFORE_STR(\";\")"
add policy expression PE_CL1009_HTTP_CS_FRST_ANY_VALUE_VS "(HTTP.REQ.CS_VSERVER.NAME + \";any;\" + HTTP.REQ.HOSTNAME.SERVER + \"/\" + HTTP.REQ.URL.PATH.GET(1)).TO_LOWER.MAP_STRING(\"SM_CL1009_CS_CONTROL\").AFTER_STR(\"vs=\").BEFORE_STR(\";\")"
add policy expression PE_CL1009_HTTP_NO_SERVICE_FRST_ANY_KEY_EXISTS "(HTTP.REQ.CS_VSERVER.NAME.BEFORE_STR_ANY(\"PS_CL1009_NAME_PROTOCOLS\") + \"_ssl;any;\" + HTTP.REQ.HOSTNAME.SERVER + \"/\" + HTTP.REQ.URL.PATH.GET(1)).TO_LOWER.IS_STRINGMAP_KEY(\"SM_CL1009_CS_CONTROL\")"
add audit messageaction LOG_CL1009_HTTP_CSP_FRST_ANY INFORMATIONAL q/"CL1009_CSP,HTTP,FRST,ANY," + PE_CL1009_REQ_TXID + "," + CLIENT.IP.SRC + "," + HTTP.REQ.CS_VSERVER.NAME + "," + HTTP.REQ.HOSTNAME + "," + HTTP.REQ.URL.PATH + "," + PE_CL1009_HTTP_CS_FRST_ANY_KEY + "," + PE_CL1009_HTTP_CS_FRST_ANY_VALUE_VS/
add audit messageaction LOG_CL1009_HTTP_RSP_NO_SERVICE_FRST_ANY INFORMATIONAL q/"CL1009_RSP,HTTP,FRST,ANY,NOSVC," + PE_CL1009_REQ_TXID + "," + HTTP.REQ.LB_VSERVER.NAME + "," + PE_CL1009_HTTP_CS_FRST_ANY_VALUE_VS/
add audit messageaction LOG_CL1009_HTTP_RSP_REDIR_FRST_ANY INFORMATIONAL q/"CL1009_RSP,HTTP,FRST,ANY,REDIR," + PE_CL1009_REQ_TXID + "," + HTTP.REQ.LB_VSERVER.NAME + "," + PE_CL1009_HTTP_CS_FRST_ANY_VALUE_DST/
add audit messageaction LOG_CL1009_HTTP_RSP_REDIR_KEEPPATH_FRST_ANY INFORMATIONAL q/"CL1009_RSP,HTTP,FRST,ANY,REDIR_KEEPPATH," + PE_CL1009_REQ_TXID + "," + HTTP.REQ.LB_VSERVER.NAME + "," + PE_CL1009_HTTP_CS_FRST_ANY_VALUE_DST/
add audit messageaction LOG_CL1009_HTTP_RSP_NO_SERVICE_SWITCH_FRST_ANY INFORMATIONAL q/"CL1009_RSP,HTTP,FRST,ANY,NOSVCSWITCH," + PE_CL1009_REQ_TXID + "," + HTTP.REQ.LB_VSERVER.NAME + "," + PE_CL1009_HTTP_CS_FRST_ANY_VALUE_VS/

add cs action CSA_CL1009_HTTP_FRST_ANY -targetVserverExpr PE_CL1009_HTTP_CS_FRST_ANY_VALUE_VS
add cs policy CSP_CL1009_HTTP_FRST_ANY -rule PE_CL1009_HTTP_CS_FRST_ANY_KEY_EXISTS -action CSA_CL1009_HTTP_FRST_ANY -logAction LOG_CL1009_HTTP_CSP_FRST_ANY

add responder action RSA_CL1009_HTTP_REDIR_FRST_ANY respondwith q/PE_CL1009_HTTP_REDIR + PE_CL1009_HTTP_CS_FRST_ANY_VALUE_DST + "\r\n\r\n"/
add responder policy RSP_CL1009_HTTP_REDIR_FRST_ANY PE_CL1009_HTTP_CS_FRST_ANY_KEY_EXISTS RSA_CL1009_HTTP_REDIR_FRST_ANY -logAction LOG_CL1009_HTTP_RSP_REDIR_FRST_ANY
add responder action RSA_CL1009_HTTP_REDIR_KEEPPATH_FRST_ANY respondwith q/PE_CL1009_HTTP_REDIR + PE_CL1009_HTTP_CS_FRST_ANY_VALUE_DST + HTTP.REQ.URL.PATH + "\r\n\r\n"/
add responder policy RSP_CL1009_HTTP_REDIR_KEEPPATH_FRST_ANY PE_CL1009_HTTP_CS_FRST_ANY_KEY_EXISTS RSA_CL1009_HTTP_REDIR_KEEPPATH_FRST_ANY -logAction LOG_CL1009_HTTP_RSP_REDIR_KEEPPATH_FRST_ANY
add responder policy RSP_CL1009_HTTP_NO_SERVICE_FRST_ANY PE_CL1009_HTTP_CS_FRST_ANY_KEY_EXISTS RSA_CL1009_NO_SERVICE -logAction LOG_CL1009_HTTP_RSP_NO_SERVICE_FRST_ANY
add responder policy RSP_CL1009_HTTP_NO_SERVICE_SWITCH_FRST_ANY PE_CL1009_HTTP_NO_SERVICE_FRST_ANY_KEY_EXISTS RSA_CL1009_HTTP_REDIR_SWITCH -logAction LOG_CL1009_HTTP_RSP_NO_SERVICE_SWITCH_FRST_ANY




# FQDN - LAN ###
add policy expression PE_CL1009_HTTP_CS_FQDN_LAN_KEY "(HTTP.REQ.CS_VSERVER.NAME + \";lan;\" + HTTP.REQ.HOSTNAME.SERVER).TO_LOWER"
add policy expression PE_CL1009_HTTP_CS_FQDN_LAN_KEY_EXISTS "((HTTP.REQ.CS_VSERVER.NAME + \";lan;\" + HTTP.REQ.HOSTNAME.SERVER).TO_LOWER.IS_STRINGMAP_KEY(\"SM_CL1009_CS_CONTROL\"))"
add policy expression PE_CL1009_HTTP_CS_FQDN_LAN_VALUE_DST "(HTTP.REQ.CS_VSERVER.NAME + \";lan;\" + HTTP.REQ.HOSTNAME.SERVER).TO_LOWER.MAP_STRING(\"SM_CL1009_CS_CONTROL\").AFTER_STR(\"dst=\").BEFORE_STR(\";\")"
add policy expression PE_CL1009_HTTP_CS_FQDN_LAN_VALUE_VS "(HTTP.REQ.CS_VSERVER.NAME + \";lan;\" + HTTP.REQ.HOSTNAME.SERVER).TO_LOWER.MAP_STRING(\"SM_CL1009_CS_CONTROL\").AFTER_STR(\"vs=\").BEFORE_STR(\";\")"
add policy expression PE_CL1009_HTTP_NO_SERVICE_FQDN_LAN_KEY_EXISTS "((HTTP.REQ.CS_VSERVER.NAME.BEFORE_STR_ANY(\"PS_CL1009_NAME_PROTOCOLS\") + \"_ssl;lan;\" + HTTP.REQ.HOSTNAME.SERVER).TO_LOWER.IS_STRINGMAP_KEY(\"SM_CL1009_CS_CONTROL\"))"
add audit messageaction LOG_CL1009_HTTP_CSP_FQDN_LAN INFORMATIONAL q/"CL1009_CSP,HTTP,FQDN,LAN," + PE_CL1009_REQ_TXID + "," + CLIENT.IP.SRC + "," + HTTP.REQ.CS_VSERVER.NAME + "," + HTTP.REQ.HOSTNAME + "," + HTTP.REQ.URL.PATH + "," + PE_CL1009_HTTP_CS_FQDN_LAN_KEY + "," + PE_CL1009_HTTP_CS_FQDN_LAN_VALUE_VS/
add audit messageaction LOG_CL1009_HTTP_RSP_NO_SERVICE_FQDN_LAN INFORMATIONAL q/"CL1009_RSP,HTTP,FQDN,LAN,NOSVC," + PE_CL1009_REQ_TXID + "," + HTTP.REQ.LB_VSERVER.NAME + "," + PE_CL1009_HTTP_CS_FQDN_LAN_VALUE_VS/
add audit messageaction LOG_CL1009_HTTP_RSP_REDIR_FQDN_LAN INFORMATIONAL q/"CL1009_RSP,HTTP,FQDN,LAN,REDIR," + PE_CL1009_REQ_TXID + "," + HTTP.REQ.LB_VSERVER.NAME + "," + PE_CL1009_HTTP_CS_FQDN_LAN_VALUE_DST/
add audit messageaction LOG_CL1009_HTTP_RSP_REDIR_KEEPPATH_FQDN_LAN INFORMATIONAL q/"CL1009_RSP,HTTP,FQDN,LAN,REDIR_KEEPPATH," + PE_CL1009_REQ_TXID + "," + HTTP.REQ.LB_VSERVER.NAME + "," + PE_CL1009_HTTP_CS_FQDN_LAN_VALUE_DST/
add audit messageaction LOG_CL1009_HTTP_RSP_NO_SERVICE_SWITCH_FQDN_LAN INFORMATIONAL q/"CL1009_RSP,HTTP,FQDN,LAN,NOSVCSWITCH," + PE_CL1009_REQ_TXID + "," + HTTP.REQ.LB_VSERVER.NAME + "," + PE_CL1009_HTTP_CS_FQDN_LAN_VALUE_VS/

add cs action CSA_CL1009_HTTP_FQDN_LAN -targetVserverExpr PE_CL1009_HTTP_CS_FQDN_LAN_VALUE_VS
add cs policy CSP_CL1009_HTTP_FQDN_LAN -rule "(PE_CL1009_HTTP_CS_FQDN_LAN_KEY_EXISTS && (PE_CL1009_TCP_CS_IP_ISLAN_3X || PE_CL1009_TCP_CS_IP_ISLAN_2X_B || PE_CL1009_TCP_CS_IP_ISLAN_2X_A || PE_CL1009_TCP_CS_IP_ISLAN_1X_B || PE_CL1009_TCP_CS_IP_ISLAN_1X_A || PE_CL1009_TCP_CS_IP_ISLAN_0X_B || PE_CL1009_TCP_CS_IP_ISLAN_0X_A))" -action CSA_CL1009_HTTP_FQDN_LAN -logAction LOG_CL1009_HTTP_CSP_FQDN_LAN

add responder action RSA_CL1009_HTTP_REDIR_FQDN_LAN respondwith q/PE_CL1009_HTTP_REDIR + PE_CL1009_HTTP_CS_FQDN_LAN_VALUE_DST + "\r\n\r\n"/
add responder policy RSP_CL1009_HTTP_REDIR_FQDN_LAN "(PE_CL1009_HTTP_CS_FQDN_LAN_KEY_EXISTS && (PE_CL1009_TCP_CS_IP_ISLAN_3X || PE_CL1009_TCP_CS_IP_ISLAN_2X_B || PE_CL1009_TCP_CS_IP_ISLAN_2X_A || PE_CL1009_TCP_CS_IP_ISLAN_1X_B || PE_CL1009_TCP_CS_IP_ISLAN_1X_A || PE_CL1009_TCP_CS_IP_ISLAN_0X_B || PE_CL1009_TCP_CS_IP_ISLAN_0X_A))" RSA_CL1009_HTTP_REDIR_FQDN_LAN -logAction LOG_CL1009_HTTP_RSP_REDIR_FQDN_LAN
add responder action RSA_CL1009_HTTP_REDIR_KEEPPATH_FQDN_LAN respondwith q/PE_CL1009_HTTP_REDIR + PE_CL1009_HTTP_CS_FQDN_LAN_VALUE_DST + HTTP.REQ.URL.PATH + "\r\n\r\n"/
add responder policy RSP_CL1009_HTTP_REDIR_KEEPPATH_FQDN_LAN "(PE_CL1009_HTTP_CS_FQDN_LAN_KEY_EXISTS && (PE_CL1009_TCP_CS_IP_ISLAN_3X || PE_CL1009_TCP_CS_IP_ISLAN_2X_B || PE_CL1009_TCP_CS_IP_ISLAN_2X_A || PE_CL1009_TCP_CS_IP_ISLAN_1X_B || PE_CL1009_TCP_CS_IP_ISLAN_1X_A || PE_CL1009_TCP_CS_IP_ISLAN_0X_B || PE_CL1009_TCP_CS_IP_ISLAN_0X_A))" RSA_CL1009_HTTP_REDIR_KEEPPATH_FQDN_LAN -logAction LOG_CL1009_HTTP_RSP_REDIR_KEEPPATH_FQDN_LAN
add responder policy RSP_CL1009_HTTP_NO_SERVICE_FQDN_LAN "(PE_CL1009_HTTP_CS_FQDN_LAN_KEY_EXISTS && (PE_CL1009_TCP_CS_IP_ISLAN_3X || PE_CL1009_TCP_CS_IP_ISLAN_2X_B || PE_CL1009_TCP_CS_IP_ISLAN_2X_A || PE_CL1009_TCP_CS_IP_ISLAN_1X_B || PE_CL1009_TCP_CS_IP_ISLAN_1X_A || PE_CL1009_TCP_CS_IP_ISLAN_0X_B || PE_CL1009_TCP_CS_IP_ISLAN_0X_A))" RSA_CL1009_NO_SERVICE -logAction LOG_CL1009_HTTP_RSP_NO_SERVICE_FQDN_LAN
add responder policy RSP_CL1009_HTTP_NO_SERVICE_SWITCH_FQDN_LAN "(PE_CL1009_HTTP_NO_SERVICE_FQDN_LAN_KEY_EXISTS && (PE_CL1009_TCP_CS_IP_ISLAN_3X || PE_CL1009_TCP_CS_IP_ISLAN_2X_B || PE_CL1009_TCP_CS_IP_ISLAN_2X_A || PE_CL1009_TCP_CS_IP_ISLAN_1X_B || PE_CL1009_TCP_CS_IP_ISLAN_1X_A || PE_CL1009_TCP_CS_IP_ISLAN_0X_B || PE_CL1009_TCP_CS_IP_ISLAN_0X_A))" RSA_CL1009_HTTP_REDIR_SWITCH -logAction LOG_CL1009_HTTP_RSP_NO_SERVICE_SWITCH_FQDN_LAN




# FQDN - ANY ###
add policy expression PE_CL1009_HTTP_CS_FQDN_ANY_KEY "(HTTP.REQ.CS_VSERVER.NAME + \";any;\" + HTTP.REQ.HOSTNAME.SERVER).TO_LOWER"
add policy expression PE_CL1009_HTTP_CS_FQDN_ANY_KEY_EXISTS "(HTTP.REQ.CS_VSERVER.NAME + \";any;\" + HTTP.REQ.HOSTNAME.SERVER).TO_LOWER.IS_STRINGMAP_KEY(\"SM_CL1009_CS_CONTROL\")"
add policy expression PE_CL1009_HTTP_CS_FQDN_ANY_VALUE_DST "(HTTP.REQ.CS_VSERVER.NAME + \";any;\" + HTTP.REQ.HOSTNAME.SERVER).TO_LOWER.MAP_STRING(\"SM_CL1009_CS_CONTROL\").AFTER_STR(\"dst=\").BEFORE_STR(\";\")"
add policy expression PE_CL1009_HTTP_CS_FQDN_ANY_VALUE_VS "(HTTP.REQ.CS_VSERVER.NAME + \";any;\" + HTTP.REQ.HOSTNAME.SERVER).TO_LOWER.MAP_STRING(\"SM_CL1009_CS_CONTROL\").AFTER_STR(\"vs=\").BEFORE_STR(\";\")"
add policy expression PE_CL1009_HTTP_NO_SERVICE_FQDN_ANY_KEY_EXISTS "(HTTP.REQ.CS_VSERVER.NAME.BEFORE_STR_ANY(\"PS_CL1009_NAME_PROTOCOLS\") + \"_ssl;any;\" + HTTP.REQ.HOSTNAME.SERVER).TO_LOWER.IS_STRINGMAP_KEY(\"SM_CL1009_CS_CONTROL\")"
add audit messageaction LOG_CL1009_HTTP_CSP_FQDN_ANY INFORMATIONAL q/"CL1009_CSP,HTTP,FQDN,ANY," + PE_CL1009_REQ_TXID + "," + CLIENT.IP.SRC + "," + HTTP.REQ.CS_VSERVER.NAME + "," + HTTP.REQ.HOSTNAME + "," + HTTP.REQ.URL.PATH + "," + PE_CL1009_HTTP_CS_FQDN_ANY_KEY + "," + PE_CL1009_HTTP_CS_FQDN_ANY_VALUE_VS/
add audit messageaction LOG_CL1009_HTTP_RSP_NO_SERVICE_FQDN_ANY INFORMATIONAL q/"CL1009_RSP,HTTP,FQDN,ANY,NOSVC," + PE_CL1009_REQ_TXID + "," + HTTP.REQ.LB_VSERVER.NAME + "," + PE_CL1009_HTTP_CS_FQDN_ANY_VALUE_VS/
add audit messageaction LOG_CL1009_HTTP_RSP_REDIR_FQDN_ANY INFORMATIONAL q/"CL1009_RSP,HTTP,FQDN,ANY,REDIR," + PE_CL1009_REQ_TXID + "," + HTTP.REQ.LB_VSERVER.NAME + "," + PE_CL1009_HTTP_CS_FQDN_ANY_VALUE_DST/
add audit messageaction LOG_CL1009_HTTP_RSP_REDIR_KEEPPATH_FQDN_ANY INFORMATIONAL q/"CL1009_RSP,HTTP,FQDN,ANY,REDIR_KEEPPATH," + PE_CL1009_REQ_TXID + "," + HTTP.REQ.LB_VSERVER.NAME + "," + PE_CL1009_HTTP_CS_FQDN_ANY_VALUE_DST/
add audit messageaction LOG_CL1009_HTTP_RSP_NO_SERVICE_SWITCH_FQDN_ANY INFORMATIONAL q/"CL1009_RSP,HTTP,FQDN,ANY,NOSVCSWITCH," + PE_CL1009_REQ_TXID + "," + HTTP.REQ.LB_VSERVER.NAME + "," + PE_CL1009_HTTP_CS_FQDN_ANY_VALUE_VS/

add cs action CSA_CL1009_HTTP_FQDN_ANY -targetVserverExpr PE_CL1009_HTTP_CS_FQDN_ANY_VALUE_VS
add cs policy CSP_CL1009_HTTP_FQDN_ANY -rule PE_CL1009_HTTP_CS_FQDN_ANY_KEY_EXISTS -action CSA_CL1009_HTTP_FQDN_ANY -logAction LOG_CL1009_HTTP_CSP_FQDN_ANY

add responder action RSA_CL1009_HTTP_REDIR_FQDN_ANY respondwith q/PE_CL1009_HTTP_REDIR + PE_CL1009_HTTP_CS_FQDN_ANY_VALUE_DST + "\r\n\r\n"/
add responder policy RSP_CL1009_HTTP_REDIR_FQDN_ANY PE_CL1009_HTTP_CS_FQDN_ANY_KEY_EXISTS RSA_CL1009_HTTP_REDIR_FQDN_ANY -logAction LOG_CL1009_HTTP_RSP_REDIR_FQDN_ANY
add responder action RSA_CL1009_HTTP_REDIR_KEEPPATH_FQDN_ANY respondwith q/PE_CL1009_HTTP_REDIR + PE_CL1009_HTTP_CS_FQDN_ANY_VALUE_DST + HTTP.REQ.URL.PATH + "\r\n\r\n"/
add responder policy RSP_CL1009_HTTP_REDIR_KEEPPATH_FQDN_ANY PE_CL1009_HTTP_CS_FQDN_ANY_KEY_EXISTS RSA_CL1009_HTTP_REDIR_KEEPPATH_FQDN_ANY -logAction LOG_CL1009_HTTP_RSP_REDIR_KEEPPATH_FQDN_ANY
add responder policy RSP_CL1009_HTTP_NO_SERVICE_FQDN_ANY PE_CL1009_HTTP_CS_FQDN_ANY_KEY_EXISTS RSA_CL1009_NO_SERVICE -logAction LOG_CL1009_HTTP_RSP_NO_SERVICE_FQDN_ANY
add responder policy RSP_CL1009_HTTP_NO_SERVICE_SWITCH_FQDN_ANY PE_CL1009_HTTP_NO_SERVICE_FQDN_ANY_KEY_EXISTS RSA_CL1009_HTTP_REDIR_SWITCH -logAction LOG_CL1009_HTTP_RSP_NO_SERVICE_SWITCH_FQDN_ANY




### WILD - LAN ###
add policy expression PE_CL1009_HTTP_CS_WILD_LAN_KEY "(HTTP.REQ.CS_VSERVER.NAME + \";lan;*.\" + HTTP.REQ.HOSTNAME.DOMAIN).TO_LOWER"
add policy expression PE_CL1009_HTTP_CS_WILD_LAN_KEY_EXISTS "((HTTP.REQ.CS_VSERVER.NAME + \";lan;*.\" + HTTP.REQ.HOSTNAME.DOMAIN).TO_LOWER.IS_STRINGMAP_KEY(\"SM_CL1009_CS_CONTROL\"))"
add policy expression PE_CL1009_HTTP_CS_WILD_LAN_VALUE_DST "(HTTP.REQ.CS_VSERVER.NAME + \";lan;*.\" +  HTTP.REQ.HOSTNAME.DOMAIN).TO_LOWER.MAP_STRING(\"SM_CL1009_CS_CONTROL\").AFTER_STR(\"dst=\").BEFORE_STR(\";\")"
add policy expression PE_CL1009_HTTP_CS_WILD_LAN_VALUE_VS "(HTTP.REQ.CS_VSERVER.NAME + \";lan;*.\" + HTTP.REQ.HOSTNAME.DOMAIN).TO_LOWER.MAP_STRING(\"SM_CL1009_CS_CONTROL\").AFTER_STR(\"vs=\").BEFORE_STR(\";\")"
add policy expression PE_CL1009_HTTP_NO_SERVICE_WILD_LAN_KEY_EXISTS "((HTTP.REQ.CS_VSERVER.NAME.BEFORE_STR_ANY(\"PS_CL1009_NAME_PROTOCOLS\") + \"_ssl;lan;*.\" + HTTP.REQ.HOSTNAME.DOMAIN).TO_LOWER.IS_STRINGMAP_KEY(\"SM_CL1009_CS_CONTROL\"))"
add audit messageaction LOG_CL1009_HTTP_CSP_WILD_LAN INFORMATIONAL q/"CL1009_CSP,HTTP,WILD,LAN," + PE_CL1009_REQ_TXID + "," + CLIENT.IP.SRC + "," + HTTP.REQ.CS_VSERVER.NAME + "," + HTTP.REQ.HOSTNAME + "," + HTTP.REQ.URL.PATH + "," + PE_CL1009_HTTP_CS_WILD_LAN_KEY + "," + PE_CL1009_HTTP_CS_WILD_LAN_VALUE_VS/
add audit messageaction LOG_CL1009_HTTP_RSP_NO_SERVICE_WILD_LAN INFORMATIONAL q/"CL1009_RSP,HTTP,WILD,LAN,NOSVC," + PE_CL1009_REQ_TXID + "," + HTTP.REQ.LB_VSERVER.NAME + "," + PE_CL1009_HTTP_CS_WILD_LAN_VALUE_VS/
add audit messageaction LOG_CL1009_HTTP_RSP_REDIR_WILD_LAN INFORMATIONAL q/"CL1009_RSP,HTTP,WILD,LAN,REDIR," + PE_CL1009_REQ_TXID + "," + HTTP.REQ.LB_VSERVER.NAME + "," + PE_CL1009_HTTP_CS_WILD_LAN_VALUE_DST/
add audit messageaction LOG_CL1009_HTTP_RSP_REDIR_KEEPPATH_WILD_LAN INFORMATIONAL q/"CL1009_RSP,HTTP,WILD,LAN,REDIR_KEEPPATH," + PE_CL1009_REQ_TXID + "," + HTTP.REQ.LB_VSERVER.NAME + "," + PE_CL1009_HTTP_CS_WILD_LAN_VALUE_DST/
add audit messageaction LOG_CL1009_HTTP_RSP_NO_SERVICE_SWITCH_WILD_LAN INFORMATIONAL q/"CL1009_RSP,HTTP,WILD,LAN,NOSVCSWITCH," + PE_CL1009_REQ_TXID + "," + HTTP.REQ.LB_VSERVER.NAME + "," + PE_CL1009_HTTP_CS_WILD_LAN_VALUE_VS/

add cs action CSA_CL1009_HTTP_WILD_LAN -targetVserverExpr PE_CL1009_HTTP_CS_WILD_LAN_VALUE_VS
add cs policy CSP_CL1009_HTTP_WILD_LAN -rule "(PE_CL1009_HTTP_CS_WILD_LAN_KEY_EXISTS && (PE_CL1009_TCP_CS_IP_ISLAN_3X || PE_CL1009_TCP_CS_IP_ISLAN_2X_B || PE_CL1009_TCP_CS_IP_ISLAN_2X_A || PE_CL1009_TCP_CS_IP_ISLAN_1X_B || PE_CL1009_TCP_CS_IP_ISLAN_1X_A || PE_CL1009_TCP_CS_IP_ISLAN_0X_B || PE_CL1009_TCP_CS_IP_ISLAN_0X_A))" -action CSA_CL1009_HTTP_WILD_LAN -logAction LOG_CL1009_HTTP_CSP_WILD_LAN

add responder action RSA_CL1009_HTTP_REDIR_WILD_LAN respondwith q/PE_CL1009_HTTP_REDIR + PE_CL1009_HTTP_CS_WILD_LAN_VALUE_DST + "\r\n\r\n"/
add responder policy RSP_CL1009_HTTP_REDIR_WILD_LAN "(PE_CL1009_HTTP_CS_WILD_LAN_KEY_EXISTS && (PE_CL1009_TCP_CS_IP_ISLAN_3X || PE_CL1009_TCP_CS_IP_ISLAN_2X_B || PE_CL1009_TCP_CS_IP_ISLAN_2X_A || PE_CL1009_TCP_CS_IP_ISLAN_1X_B || PE_CL1009_TCP_CS_IP_ISLAN_1X_A || PE_CL1009_TCP_CS_IP_ISLAN_0X_B || PE_CL1009_TCP_CS_IP_ISLAN_0X_A))" RSA_CL1009_HTTP_REDIR_WILD_LAN -logAction LOG_CL1009_HTTP_RSP_REDIR_WILD_LAN
add responder action RSA_CL1009_HTTP_REDIR_KEEPPATH_WILD_LAN respondwith q/PE_CL1009_HTTP_REDIR + PE_CL1009_HTTP_CS_WILD_LAN_VALUE_DST + HTTP.REQ.URL.PATH + "\r\n\r\n"/
add responder policy RSP_CL1009_HTTP_REDIR_KEEPPATH_WILD_LAN "(PE_CL1009_HTTP_CS_WILD_LAN_KEY_EXISTS && (PE_CL1009_TCP_CS_IP_ISLAN_3X || PE_CL1009_TCP_CS_IP_ISLAN_2X_B || PE_CL1009_TCP_CS_IP_ISLAN_2X_A || PE_CL1009_TCP_CS_IP_ISLAN_1X_B || PE_CL1009_TCP_CS_IP_ISLAN_1X_A || PE_CL1009_TCP_CS_IP_ISLAN_0X_B || PE_CL1009_TCP_CS_IP_ISLAN_0X_A))" RSA_CL1009_HTTP_REDIR_KEEPPATH_WILD_LAN -logAction LOG_CL1009_HTTP_RSP_REDIR_KEEPPATH_WILD_LAN
add responder policy RSP_CL1009_HTTP_NO_SERVICE_WILD_LAN "(PE_CL1009_HTTP_CS_WILD_LAN_KEY_EXISTS && (PE_CL1009_TCP_CS_IP_ISLAN_3X || PE_CL1009_TCP_CS_IP_ISLAN_2X_B || PE_CL1009_TCP_CS_IP_ISLAN_2X_A || PE_CL1009_TCP_CS_IP_ISLAN_1X_B || PE_CL1009_TCP_CS_IP_ISLAN_1X_A || PE_CL1009_TCP_CS_IP_ISLAN_0X_B || PE_CL1009_TCP_CS_IP_ISLAN_0X_A))" RSA_CL1009_NO_SERVICE -logAction LOG_CL1009_HTTP_RSP_NO_SERVICE_WILD_LAN
add responder policy RSP_CL1009_HTTP_NO_SERVICE_SWITCH_WILD_LAN "(PE_CL1009_HTTP_NO_SERVICE_WILD_LAN_KEY_EXISTS && (PE_CL1009_TCP_CS_IP_ISLAN_3X || PE_CL1009_TCP_CS_IP_ISLAN_2X_B || PE_CL1009_TCP_CS_IP_ISLAN_2X_A || PE_CL1009_TCP_CS_IP_ISLAN_1X_B || PE_CL1009_TCP_CS_IP_ISLAN_1X_A || PE_CL1009_TCP_CS_IP_ISLAN_0X_B || PE_CL1009_TCP_CS_IP_ISLAN_0X_A))" RSA_CL1009_HTTP_REDIR_SWITCH -logAction LOG_CL1009_HTTP_RSP_NO_SERVICE_SWITCH_WILD_LAN




### WILD - ANY ###
add policy expression PE_CL1009_HTTP_CS_WILD_ANY_KEY "(HTTP.REQ.CS_VSERVER.NAME + \";any;*.\" + HTTP.REQ.HOSTNAME.DOMAIN).TO_LOWER"
add policy expression PE_CL1009_HTTP_CS_WILD_ANY_KEY_EXISTS "(HTTP.REQ.CS_VSERVER.NAME + \";any;*.\" + HTTP.REQ.HOSTNAME.DOMAIN).TO_LOWER.IS_STRINGMAP_KEY(\"SM_CL1009_CS_CONTROL\")"
add policy expression PE_CL1009_HTTP_CS_WILD_ANY_VALUE_DST "(HTTP.REQ.CS_VSERVER.NAME + \";any;*.\" + HTTP.REQ.HOSTNAME.DOMAIN).TO_LOWER.MAP_STRING(\"SM_CL1009_CS_CONTROL\").AFTER_STR(\"dst=\").BEFORE_STR(\";\")"
add policy expression PE_CL1009_HTTP_CS_WILD_ANY_VALUE_VS "(HTTP.REQ.CS_VSERVER.NAME + \";any;*.\" + HTTP.REQ.HOSTNAME.DOMAIN).TO_LOWER.MAP_STRING(\"SM_CL1009_CS_CONTROL\").AFTER_STR(\"vs=\").BEFORE_STR(\";\")"
add policy expression PE_CL1009_HTTP_NO_SERVICE_WILD_ANY_KEY_EXISTS "(HTTP.REQ.CS_VSERVER.NAME.BEFORE_STR_ANY(\"PS_CL1009_NAME_PROTOCOLS\") + \"_ssl;any;*.\" + HTTP.REQ.HOSTNAME.DOMAIN).TO_LOWER.IS_STRINGMAP_KEY(\"SM_CL1009_CS_CONTROL\")"
add audit messageaction LOG_CL1009_HTTP_CSP_WILD_ANY INFORMATIONAL q/"CL1009_CSP,HTTP,WILD,ANY," + PE_CL1009_REQ_TXID + "," + CLIENT.IP.SRC + "," + HTTP.REQ.CS_VSERVER.NAME + "," + HTTP.REQ.HOSTNAME + "," + HTTP.REQ.URL.PATH + "," + PE_CL1009_HTTP_CS_WILD_ANY_KEY + "," + PE_CL1009_HTTP_CS_WILD_ANY_VALUE_VS/
add audit messageaction LOG_CL1009_HTTP_RSP_NO_SERVICE_WILD_ANY INFORMATIONAL q/"CL1009_RSP,HTTP,WILD,ANY,NOSVC," + PE_CL1009_REQ_TXID + "," + HTTP.REQ.LB_VSERVER.NAME + "," + PE_CL1009_HTTP_CS_WILD_ANY_VALUE_VS/
add audit messageaction LOG_CL1009_HTTP_RSP_REDIR_WILD_ANY INFORMATIONAL q/"CL1009_RSP,HTTP,WILD,ANY,REDIR," + PE_CL1009_REQ_TXID + "," + HTTP.REQ.LB_VSERVER.NAME + "," + PE_CL1009_HTTP_CS_WILD_ANY_VALUE_DST/
add audit messageaction LOG_CL1009_HTTP_RSP_REDIR_KEEPPATH_WILD_ANY INFORMATIONAL q/"CL1009_RSP,HTTP,WILD,ANY,REDIR_KEEPPATH," + PE_CL1009_REQ_TXID + "," + HTTP.REQ.LB_VSERVER.NAME + "," + PE_CL1009_HTTP_CS_WILD_ANY_VALUE_DST/
add audit messageaction LOG_CL1009_HTTP_RSP_NO_SERVICE_SWITCH_WILD_ANY INFORMATIONAL q/"CL1009_RSP,HTTP,WILD,ANY,NOSVCSWITCH," + PE_CL1009_REQ_TXID + "," + HTTP.REQ.LB_VSERVER.NAME + "," + PE_CL1009_HTTP_CS_WILD_ANY_VALUE_VS/

add cs action CSA_CL1009_HTTP_WILD_ANY -targetVserverExpr PE_CL1009_HTTP_CS_WILD_ANY_VALUE_VS
add cs policy CSP_CL1009_HTTP_WILD_ANY -rule PE_CL1009_HTTP_CS_WILD_ANY_KEY_EXISTS -action CSA_CL1009_HTTP_WILD_ANY -logAction LOG_CL1009_HTTP_CSP_WILD_ANY

add responder action RSA_CL1009_HTTP_REDIR_WILD_ANY respondwith q/PE_CL1009_HTTP_REDIR + PE_CL1009_HTTP_CS_WILD_ANY_VALUE_DST + "\r\n\r\n"/
add responder policy RSP_CL1009_HTTP_REDIR_WILD_ANY PE_CL1009_HTTP_CS_WILD_ANY_KEY_EXISTS RSA_CL1009_HTTP_REDIR_WILD_ANY -logAction LOG_CL1009_HTTP_RSP_REDIR_WILD_ANY
add responder action RSA_CL1009_HTTP_REDIR_KEEPPATH_WILD_ANY respondwith q/PE_CL1009_HTTP_REDIR + PE_CL1009_HTTP_CS_WILD_ANY_VALUE_DST + HTTP.REQ.URL.PATH + "\r\n\r\n"/
add responder policy RSP_CL1009_HTTP_REDIR_KEEPPATH_WILD_ANY PE_CL1009_HTTP_CS_WILD_ANY_KEY_EXISTS RSA_CL1009_HTTP_REDIR_KEEPPATH_WILD_ANY -logAction LOG_CL1009_HTTP_RSP_REDIR_KEEPPATH_WILD_ANY
add responder policy RSP_CL1009_HTTP_NO_SERVICE_WILD_ANY PE_CL1009_HTTP_CS_WILD_ANY_KEY_EXISTS RSA_CL1009_NO_SERVICE -logAction LOG_CL1009_HTTP_RSP_NO_SERVICE_WILD_ANY
add responder policy RSP_CL1009_HTTP_NO_SERVICE_SWITCH_WILD_ANY PE_CL1009_HTTP_NO_SERVICE_WILD_ANY_KEY_EXISTS RSA_CL1009_HTTP_REDIR_SWITCH -logAction LOG_CL1009_HTTP_RSP_NO_SERVICE_SWITCH_WILD_ANY




### TCP & UDP ###
add policy expression PE_CL1009_TCP_LAN_KEY_EXISTS  "(CLIENT.TCP.CS_VSERVER.NAME + \";lan;tcp/\" + CLIENT.TCP.DSTPORT).TO_LOWER.IS_STRINGMAP_KEY(\"SM_CL1009_CS_CONTROL\")"
add policy expression PE_CL1009_TCP_LAN_VS  "(CLIENT.TCP.CS_VSERVER.NAME + \";lan;tcp/\" + CLIENT.TCP.DSTPORT).TO_LOWER.MAP_STRING(\"SM_CL1009_CS_CONTROL\").AFTER_STR(\"vs=\").BEFORE_STR(\";\")"
add policy expression PE_CL1009_TCP_ANY_KEY_EXISTS  "(CLIENT.TCP.CS_VSERVER.NAME + \";any;tcp/\" + CLIENT.TCP.DSTPORT).TO_LOWER.IS_STRINGMAP_KEY(\"SM_CL1009_CS_CONTROL\")"
add policy expression PE_CL1009_TCP_ANY_VS  "(CLIENT.TCP.CS_VSERVER.NAME + \";any;tcp/\" + CLIENT.TCP.DSTPORT).TO_LOWER.MAP_STRING(\"SM_CL1009_CS_CONTROL\").AFTER_STR(\"vs=\").BEFORE_STR(\";\")"

add audit messageaction LOG_CL1009_TCP_LAN INFORMATIONAL "\"CL1009_CSP,TCP,LAN,\" + CLIENT.IP.SRC + \",\" + CLIENT.TCP.CS_VSERVER.NAME + \",\" + CLIENT.TCP.DSTPORT.TYPECAST_TEXT_T + \",\" + PE_CL1009_TCP_LAN_VS"
add audit messageaction LOG_CL1009_TCP_ANY INFORMATIONAL "\"CL1009_CSP,TCP,ANY,\" + CLIENT.IP.SRC + \",\" + CLIENT.TCP.CS_VSERVER.NAME + \",\" + CLIENT.TCP.DSTPORT.TYPECAST_TEXT_T + \",\" + PE_CL1009_TCP_ANY_VS"

add cs action CSA_CL1009_TCP_LAN -targetVserverExpr PE_CL1009_TCP_LAN_VS
add cs action CSA_CL1009_TCP_ANY -targetVserverExpr PE_CL1009_TCP_ANY_VS

add cs policy CSP_CL1009_TCP_LAN -rule "(PE_CL1009_TCP_LAN_KEY_EXISTS && (PE_CL1009_TCP_CS_IP_ISLAN_3X || PE_CL1009_TCP_CS_IP_ISLAN_2X_B || PE_CL1009_TCP_CS_IP_ISLAN_2X_A || PE_CL1009_TCP_CS_IP_ISLAN_1X_B || PE_CL1009_TCP_CS_IP_ISLAN_1X_A || PE_CL1009_TCP_CS_IP_ISLAN_0X_B || PE_CL1009_TCP_CS_IP_ISLAN_0X_A))" -action CSA_CL1009_TCP_LAN -logAction LOG_CL1009_TCP_LAN
add cs policy CSP_CL1009_TCP_ANY -rule PE_CL1009_TCP_ANY_KEY_EXISTS -action CSA_CL1009_TCP_ANY -logAction LOG_CL1009_TCP_ANY


add policy expression PE_CL1009_UDP_LAN_KEY_EXISTS  "(CLIENT.UDP.CS_VSERVER.NAME + \";lan;UDP/\" + CLIENT.UDP.DSTPORT).TO_LOWER.IS_STRINGMAP_KEY(\"SM_CL1009_CS_CONTROL\")"
add policy expression PE_CL1009_UDP_LAN_VS  "(CLIENT.UDP.CS_VSERVER.NAME + \";lan;UDP/\" + CLIENT.UDP.DSTPORT).TO_LOWER.MAP_STRING(\"SM_CL1009_CS_CONTROL\").AFTER_STR(\"vs=\").BEFORE_STR(\";\")"
add policy expression PE_CL1009_UDP_ANY_KEY_EXISTS  "(CLIENT.UDP.CS_VSERVER.NAME + \";any;UDP/\" + CLIENT.UDP.DSTPORT).TO_LOWER.IS_STRINGMAP_KEY(\"SM_CL1009_CS_CONTROL\")"
add policy expression PE_CL1009_UDP_ANY_VS  "(CLIENT.UDP.CS_VSERVER.NAME + \";any;UDP/\" + CLIENT.UDP.DSTPORT).TO_LOWER.MAP_STRING(\"SM_CL1009_CS_CONTROL\").AFTER_STR(\"vs=\").BEFORE_STR(\";\")"

add audit messageaction LOG_CL1009_UDP_LAN INFORMATIONAL "\"CL1009_CSP,UDP,LAN,\" + CLIENT.IP.SRC + \",\" + CLIENT.UDP.CS_VSERVER.NAME + \",\" + CLIENT.UDP.DSTPORT.TYPECAST_TEXT_T + \",\" + PE_CL1009_UDP_LAN_VS"
add audit messageaction LOG_CL1009_UDP_ANY INFORMATIONAL "\"CL1009_CSP,UDP,ANY,\" + CLIENT.IP.SRC + \",\" + CLIENT.UDP.CS_VSERVER.NAME + \",\" + CLIENT.UDP.DSTPORT.TYPECAST_TEXT_T + \",\" + PE_CL1009_UDP_ANY_VS"

add cs action CSA_CL1009_UDP_LAN -targetVserverExpr PE_CL1009_UDP_LAN_VS
add cs action CSA_CL1009_UDP_ANY -targetVserverExpr PE_CL1009_UDP_ANY_VS

add cs policy CSP_CL1009_UDP_LAN -rule "(PE_CL1009_UDP_LAN_KEY_EXISTS && (PE_CL1009_UDP_CS_IP_ISLAN_3X || PE_CL1009_UDP_CS_IP_ISLAN_2X_B || PE_CL1009_UDP_CS_IP_ISLAN_2X_A || PE_CL1009_UDP_CS_IP_ISLAN_1X_B || PE_CL1009_UDP_CS_IP_ISLAN_1X_A || PE_CL1009_UDP_CS_IP_ISLAN_0X_B || PE_CL1009_UDP_CS_IP_ISLAN_0X_A))" -action CSA_CL1009_UDP_LAN -logAction LOG_CL1009_UDP_LAN
add cs policy CSP_CL1009_UDP_ANY -rule PE_CL1009_UDP_ANY_KEY_EXISTS -action CSA_CL1009_UDP_ANY -logAction LOG_CL1009_UDP_ANY



### IP ALLOWLISTING/BLOCKLISTING ###
### CONTENT SWITCHING VIRTUAL SERVERS ###
add policy expression PE_CL1009_IP_CSTCP_IS_LISTED "(CLIENT.TCP.CS_VSERVER.NAME.TO_LOWER).IS_STRINGMAP_KEY(\"SM_CL1009_IP_CONTROL\")"
add policy expression PE_CL1009_IP_CSTCP_IS_ALLOWLISTED "(CLIENT.TCP.CS_VSERVER.NAME.TO_LOWER).MAP_STRING(\"SM_CL1009_IP_CONTROL\").AFTER_STR(\"list=\").BEFORE_STR(\";\").EQ(\"allowlist\")"
add policy expression PE_CL1009_IP_CSTCP_IS_BLOCKLISTED "(CLIENT.TCP.CS_VSERVER.NAME.TO_LOWER).MAP_STRING(\"SM_CL1009_IP_CONTROL\").AFTER_STR(\"list=\").BEFORE_STR(\";\").EQ(\"blocklist\")"
add policy expression PE_CL1009_IP_CSTCP_3X "(CLIENT.TCP.CS_VSERVER.NAME.TO_LOWER + \";any;\" + CLIENT.IP.SRC.TYPECAST_TEXT_T + \"/32\").IS_STRINGMAP_KEY(\"SM_CL1009_IP_CONTROL\") || (CLIENT.TCP.CS_VSERVER.NAME.TO_LOWER + \";any;\" + CLIENT.IP.SRC.SUBNET(31).TYPECAST_TEXT_T + \"/31\").IS_STRINGMAP_KEY(\"SM_CL1009_IP_CONTROL\") || (CLIENT.TCP.CS_VSERVER.NAME.TO_LOWER + \";any;\" + CLIENT.IP.SRC.SUBNET(30).TYPECAST_TEXT_T + \"/30\").IS_STRINGMAP_KEY(\"SM_CL1009_IP_CONTROL\")"
add policy expression PE_CL1009_IP_CSTCP_2X_B "(CLIENT.TCP.CS_VSERVER.NAME.TO_LOWER + \";any;\" + CLIENT.IP.SRC.SUBNET(29).TYPECAST_TEXT_T + \"/29\").IS_STRINGMAP_KEY(\"SM_CL1009_IP_CONTROL\") || (CLIENT.TCP.CS_VSERVER.NAME.TO_LOWER + \";any;\" + CLIENT.IP.SRC.SUBNET(28).TYPECAST_TEXT_T + \"/28\").IS_STRINGMAP_KEY(\"SM_CL1009_IP_CONTROL\") || (CLIENT.TCP.CS_VSERVER.NAME.TO_LOWER + \";any;\" + CLIENT.IP.SRC.SUBNET(27).TYPECAST_TEXT_T + \"/27\").IS_STRINGMAP_KEY(\"SM_CL1009_IP_CONTROL\") || (CLIENT.TCP.CS_VSERVER.NAME.TO_LOWER + \";any;\" + CLIENT.IP.SRC.SUBNET(26).TYPECAST_TEXT_T + \"/26\").IS_STRINGMAP_KEY(\"SM_CL1009_IP_CONTROL\") || (CLIENT.TCP.CS_VSERVER.NAME.TO_LOWER + \";any;\" + CLIENT.IP.SRC.SUBNET(25).TYPECAST_TEXT_T + \"/25\").IS_STRINGMAP_KEY(\"SM_CL1009_IP_CONTROL\")"
add policy expression PE_CL1009_IP_CSTCP_2X_A "(CLIENT.TCP.CS_VSERVER.NAME.TO_LOWER + \";any;\" + CLIENT.IP.SRC.SUBNET(24).TYPECAST_TEXT_T + \"/24\").IS_STRINGMAP_KEY(\"SM_CL1009_IP_CONTROL\") || (CLIENT.TCP.CS_VSERVER.NAME.TO_LOWER + \";any;\" + CLIENT.IP.SRC.SUBNET(23).TYPECAST_TEXT_T + \"/23\").IS_STRINGMAP_KEY(\"SM_CL1009_IP_CONTROL\") || (CLIENT.TCP.CS_VSERVER.NAME.TO_LOWER + \";any;\" + CLIENT.IP.SRC.SUBNET(22).TYPECAST_TEXT_T + \"/22\").IS_STRINGMAP_KEY(\"SM_CL1009_IP_CONTROL\") || (CLIENT.TCP.CS_VSERVER.NAME.TO_LOWER + \";any;\" + CLIENT.IP.SRC.SUBNET(21).TYPECAST_TEXT_T + \"/21\").IS_STRINGMAP_KEY(\"SM_CL1009_IP_CONTROL\") || (CLIENT.TCP.CS_VSERVER.NAME.TO_LOWER + \";any;\" + CLIENT.IP.SRC.SUBNET(20).TYPECAST_TEXT_T + \"/20\").IS_STRINGMAP_KEY(\"SM_CL1009_IP_CONTROL\")"
add policy expression PE_CL1009_IP_CSTCP_1X_B "(CLIENT.TCP.CS_VSERVER.NAME.TO_LOWER + \";any;\" + CLIENT.IP.SRC.SUBNET(19).TYPECAST_TEXT_T + \"/19\").IS_STRINGMAP_KEY(\"SM_CL1009_IP_CONTROL\") || (CLIENT.TCP.CS_VSERVER.NAME.TO_LOWER + \";any;\" + CLIENT.IP.SRC.SUBNET(18).TYPECAST_TEXT_T + \"/18\").IS_STRINGMAP_KEY(\"SM_CL1009_IP_CONTROL\") || (CLIENT.TCP.CS_VSERVER.NAME.TO_LOWER + \";any;\" + CLIENT.IP.SRC.SUBNET(17).TYPECAST_TEXT_T + \"/17\").IS_STRINGMAP_KEY(\"SM_CL1009_IP_CONTROL\") || (CLIENT.TCP.CS_VSERVER.NAME.TO_LOWER + \";any;\" + CLIENT.IP.SRC.SUBNET(16).TYPECAST_TEXT_T + \"/16\").IS_STRINGMAP_KEY(\"SM_CL1009_IP_CONTROL\") || (CLIENT.TCP.CS_VSERVER.NAME.TO_LOWER + \";any;\" + CLIENT.IP.SRC.SUBNET(15).TYPECAST_TEXT_T + \"/15\").IS_STRINGMAP_KEY(\"SM_CL1009_IP_CONTROL\")"
add policy expression PE_CL1009_IP_CSTCP_1X_A "(CLIENT.TCP.CS_VSERVER.NAME.TO_LOWER + \";any;\" + CLIENT.IP.SRC.SUBNET(14).TYPECAST_TEXT_T + \"/14\").IS_STRINGMAP_KEY(\"SM_CL1009_IP_CONTROL\") || (CLIENT.TCP.CS_VSERVER.NAME.TO_LOWER + \";any;\" + CLIENT.IP.SRC.SUBNET(13).TYPECAST_TEXT_T + \"/13\").IS_STRINGMAP_KEY(\"SM_CL1009_IP_CONTROL\") || (CLIENT.TCP.CS_VSERVER.NAME.TO_LOWER + \";any;\" + CLIENT.IP.SRC.SUBNET(12).TYPECAST_TEXT_T + \"/12\").IS_STRINGMAP_KEY(\"SM_CL1009_IP_CONTROL\") || (CLIENT.TCP.CS_VSERVER.NAME.TO_LOWER + \";any;\" + CLIENT.IP.SRC.SUBNET(11).TYPECAST_TEXT_T + \"/11\").IS_STRINGMAP_KEY(\"SM_CL1009_IP_CONTROL\") || (CLIENT.TCP.CS_VSERVER.NAME.TO_LOWER + \";any;\" + CLIENT.IP.SRC.SUBNET(10).TYPECAST_TEXT_T + \"/10\").IS_STRINGMAP_KEY(\"SM_CL1009_IP_CONTROL\")"
add policy expression PE_CL1009_IP_CSTCP_0X_B "(CLIENT.TCP.CS_VSERVER.NAME.TO_LOWER + \";any;\" + CLIENT.IP.SRC.SUBNET(9).TYPECAST_TEXT_T + \"/9\").IS_STRINGMAP_KEY(\"SM_CL1009_IP_CONTROL\") || (CLIENT.TCP.CS_VSERVER.NAME.TO_LOWER + \";any;\" + CLIENT.IP.SRC.SUBNET(8).TYPECAST_TEXT_T + \"/8\").IS_STRINGMAP_KEY(\"SM_CL1009_IP_CONTROL\") || (CLIENT.TCP.CS_VSERVER.NAME.TO_LOWER + \";any;\" + CLIENT.IP.SRC.SUBNET(7).TYPECAST_TEXT_T + \"/7\").IS_STRINGMAP_KEY(\"SM_CL1009_IP_CONTROL\") || (CLIENT.TCP.CS_VSERVER.NAME.TO_LOWER + \";any;\" + CLIENT.IP.SRC.SUBNET(6).TYPECAST_TEXT_T + \"/6\").IS_STRINGMAP_KEY(\"SM_CL1009_IP_CONTROL\") || (CLIENT.TCP.CS_VSERVER.NAME.TO_LOWER + \";any;\" + CLIENT.IP.SRC.SUBNET(5).TYPECAST_TEXT_T + \"/5\").IS_STRINGMAP_KEY(\"SM_CL1009_IP_CONTROL\")"
add policy expression PE_CL1009_IP_CSTCP_0X_A "(CLIENT.TCP.CS_VSERVER.NAME.TO_LOWER + \";any;\" + CLIENT.IP.SRC.SUBNET(4).TYPECAST_TEXT_T + \"/4\").IS_STRINGMAP_KEY(\"SM_CL1009_IP_CONTROL\") || (CLIENT.TCP.CS_VSERVER.NAME.TO_LOWER + \";any;\" + CLIENT.IP.SRC.SUBNET(3).TYPECAST_TEXT_T + \"/3\").IS_STRINGMAP_KEY(\"SM_CL1009_IP_CONTROL\") || (CLIENT.TCP.CS_VSERVER.NAME.TO_LOWER + \";any;\" + CLIENT.IP.SRC.SUBNET(2).TYPECAST_TEXT_T + \"/2\").IS_STRINGMAP_KEY(\"SM_CL1009_IP_CONTROL\") || (CLIENT.TCP.CS_VSERVER.NAME.TO_LOWER + \";any;\" + CLIENT.IP.SRC.SUBNET(1).TYPECAST_TEXT_T + \"/1\").IS_STRINGMAP_KEY(\"SM_CL1009_IP_CONTROL\")"


add audit messageaction LOG_CL1009_RSP_CL1009_BLOCKED_CS_NOTLISTED INFORMATIONAL "\"RSP_CL1009_IP_CSTCP_NOTLISTED - BLOCKED CS NOTLISTED - \" + CLIENT.TCP.CS_VSERVER.NAME + \" - \" + CLIENT.IP.SRC"
add audit messageaction LOG_CL1009_RSP_CL1009_BLOCKED_CS_ALLOWLIST INFORMATIONAL "\"RSP_CL1009_IP_CSTCP_ALLOWLIST - BLOCKED CS ALLOWLIST - \" + CLIENT.TCP.CS_VSERVER.NAME + \" - \" + CLIENT.IP.SRC"
add audit messageaction LOG_CL1009_RSP_CL1009_BLOCKED_CS_BLOCKLIST INFORMATIONAL "\"RSP_CL1009_IP_CSTCP_BLOCKLIST - BLOCKED CS BLOCKLIST - \" + CLIENT.TCP.CS_VSERVER.NAME + \" - \" + CLIENT.IP.SRC"

add responder policy RSP_CL1009_IP_CSTCP_NOTLISTED "!PE_CL1009_IP_CSTCP_IS_LISTED" RESET -comment "SM_CL1009_IP_CONTROL Blocked" -logAction LOG_CL1009_RSP_CL1009_BLOCKED_CS_NOTLISTED
add responder policy RSP_CL1009_IP_CSTCP_ALLOWLIST "PE_CL1009_IP_CSTCP_IS_LISTED && PE_CL1009_IP_CSTCP_IS_ALLOWLISTED && !(PE_CL1009_IP_CSTCP_3X || PE_CL1009_IP_CSTCP_2X_B || PE_CL1009_IP_CSTCP_2X_A || PE_CL1009_IP_CSTCP_1X_B || PE_CL1009_IP_CSTCP_1X_A || PE_CL1009_IP_CSTCP_0X_B || PE_CL1009_IP_CSTCP_0X_A)" RESET -comment "SM_CL1009_IP_CONTROL Blocked" -logAction LOG_CL1009_RSP_CL1009_BLOCKED_CS_ALLOWLIST
add responder policy RSP_CL1009_IP_CSTCP_BLOCKLIST "PE_CL1009_IP_CSTCP_IS_LISTED && PE_CL1009_IP_CSTCP_IS_BLOCKLISTED && (PE_CL1009_IP_CSTCP_3X || PE_CL1009_IP_CSTCP_2X_B || PE_CL1009_IP_CSTCP_2X_A || PE_CL1009_IP_CSTCP_1X_B || PE_CL1009_IP_CSTCP_1X_A || PE_CL1009_IP_CSTCP_0X_B || PE_CL1009_IP_CSTCP_0X_A)" RESET -comment "SM_CL1009_IP_CONTROL Blocked" -logAction LOG_CL1009_RSP_CL1009_BLOCKED_CS_BLOCKLIST

### LOAD BALANCING VIRTUAL SERVERS ###
add policy expression PE_CL1009_IP_VSTCP_IS_LISTED "(CLIENT.TCP.LB_VSERVER.NAME.TO_LOWER).IS_STRINGMAP_KEY(\"SM_CL1009_IP_CONTROL\")"
add policy expression PE_CL1009_IP_VSTCP_IS_ALLOWLISTED "(CLIENT.TCP.LB_VSERVER.NAME.TO_LOWER).MAP_STRING(\"SM_CL1009_IP_CONTROL\").AFTER_STR(\"list=\").BEFORE_STR(\";\").EQ(\"allowlist\")"
add policy expression PE_CL1009_IP_VSTCP_IS_BLOCKLISTED "(CLIENT.TCP.LB_VSERVER.NAME.TO_LOWER).MAP_STRING(\"SM_CL1009_IP_CONTROL\").AFTER_STR(\"list=\").BEFORE_STR(\";\").EQ(\"blocklist\")"
add policy expression PE_CL1009_IP_VSTCP_3X "(CLIENT.TCP.LB_VSERVER.NAME.TO_LOWER + \";any;\" + CLIENT.IP.SRC.TYPECAST_TEXT_T + \"/32\").IS_STRINGMAP_KEY(\"SM_CL1009_IP_CONTROL\") || (CLIENT.TCP.LB_VSERVER.NAME.TO_LOWER + \";any;\" + CLIENT.IP.SRC.SUBNET(31).TYPECAST_TEXT_T + \"/31\").IS_STRINGMAP_KEY(\"SM_CL1009_IP_CONTROL\") || (CLIENT.TCP.LB_VSERVER.NAME.TO_LOWER + \";any;\" + CLIENT.IP.SRC.SUBNET(30).TYPECAST_TEXT_T + \"/30\").IS_STRINGMAP_KEY(\"SM_CL1009_IP_CONTROL\")"
add policy expression PE_CL1009_IP_VSTCP_2X_B "(CLIENT.TCP.LB_VSERVER.NAME.TO_LOWER + \";any;\" + CLIENT.IP.SRC.SUBNET(29).TYPECAST_TEXT_T + \"/29\").IS_STRINGMAP_KEY(\"SM_CL1009_IP_CONTROL\") || (CLIENT.TCP.LB_VSERVER.NAME.TO_LOWER + \";any;\" + CLIENT.IP.SRC.SUBNET(28).TYPECAST_TEXT_T + \"/28\").IS_STRINGMAP_KEY(\"SM_CL1009_IP_CONTROL\") || (CLIENT.TCP.LB_VSERVER.NAME.TO_LOWER + \";any;\" + CLIENT.IP.SRC.SUBNET(27).TYPECAST_TEXT_T + \"/27\").IS_STRINGMAP_KEY(\"SM_CL1009_IP_CONTROL\") || (CLIENT.TCP.LB_VSERVER.NAME.TO_LOWER + \";any;\" + CLIENT.IP.SRC.SUBNET(26).TYPECAST_TEXT_T + \"/26\").IS_STRINGMAP_KEY(\"SM_CL1009_IP_CONTROL\") || (CLIENT.TCP.LB_VSERVER.NAME.TO_LOWER + \";any;\" + CLIENT.IP.SRC.SUBNET(25).TYPECAST_TEXT_T + \"/25\").IS_STRINGMAP_KEY(\"SM_CL1009_IP_CONTROL\")"
add policy expression PE_CL1009_IP_VSTCP_2X_A "(CLIENT.TCP.LB_VSERVER.NAME.TO_LOWER + \";any;\" + CLIENT.IP.SRC.SUBNET(24).TYPECAST_TEXT_T + \"/24\").IS_STRINGMAP_KEY(\"SM_CL1009_IP_CONTROL\") || (CLIENT.TCP.LB_VSERVER.NAME.TO_LOWER + \";any;\" + CLIENT.IP.SRC.SUBNET(23).TYPECAST_TEXT_T + \"/23\").IS_STRINGMAP_KEY(\"SM_CL1009_IP_CONTROL\") || (CLIENT.TCP.LB_VSERVER.NAME.TO_LOWER + \";any;\" + CLIENT.IP.SRC.SUBNET(22).TYPECAST_TEXT_T + \"/22\").IS_STRINGMAP_KEY(\"SM_CL1009_IP_CONTROL\") || (CLIENT.TCP.LB_VSERVER.NAME.TO_LOWER + \";any;\" + CLIENT.IP.SRC.SUBNET(21).TYPECAST_TEXT_T + \"/21\").IS_STRINGMAP_KEY(\"SM_CL1009_IP_CONTROL\") || (CLIENT.TCP.LB_VSERVER.NAME.TO_LOWER + \";any;\" + CLIENT.IP.SRC.SUBNET(20).TYPECAST_TEXT_T + \"/20\").IS_STRINGMAP_KEY(\"SM_CL1009_IP_CONTROL\")"
add policy expression PE_CL1009_IP_VSTCP_1X_B "(CLIENT.TCP.LB_VSERVER.NAME.TO_LOWER + \";any;\" + CLIENT.IP.SRC.SUBNET(19).TYPECAST_TEXT_T + \"/19\").IS_STRINGMAP_KEY(\"SM_CL1009_IP_CONTROL\") || (CLIENT.TCP.LB_VSERVER.NAME.TO_LOWER + \";any;\" + CLIENT.IP.SRC.SUBNET(18).TYPECAST_TEXT_T + \"/18\").IS_STRINGMAP_KEY(\"SM_CL1009_IP_CONTROL\") || (CLIENT.TCP.LB_VSERVER.NAME.TO_LOWER + \";any;\" + CLIENT.IP.SRC.SUBNET(17).TYPECAST_TEXT_T + \"/17\").IS_STRINGMAP_KEY(\"SM_CL1009_IP_CONTROL\") || (CLIENT.TCP.LB_VSERVER.NAME.TO_LOWER + \";any;\" + CLIENT.IP.SRC.SUBNET(16).TYPECAST_TEXT_T + \"/16\").IS_STRINGMAP_KEY(\"SM_CL1009_IP_CONTROL\") || (CLIENT.TCP.LB_VSERVER.NAME.TO_LOWER + \";any;\" + CLIENT.IP.SRC.SUBNET(15).TYPECAST_TEXT_T + \"/15\").IS_STRINGMAP_KEY(\"SM_CL1009_IP_CONTROL\")"
add policy expression PE_CL1009_IP_VSTCP_1X_A "(CLIENT.TCP.LB_VSERVER.NAME.TO_LOWER + \";any;\" + CLIENT.IP.SRC.SUBNET(14).TYPECAST_TEXT_T + \"/14\").IS_STRINGMAP_KEY(\"SM_CL1009_IP_CONTROL\") || (CLIENT.TCP.LB_VSERVER.NAME.TO_LOWER + \";any;\" + CLIENT.IP.SRC.SUBNET(13).TYPECAST_TEXT_T + \"/13\").IS_STRINGMAP_KEY(\"SM_CL1009_IP_CONTROL\") || (CLIENT.TCP.LB_VSERVER.NAME.TO_LOWER + \";any;\" + CLIENT.IP.SRC.SUBNET(12).TYPECAST_TEXT_T + \"/12\").IS_STRINGMAP_KEY(\"SM_CL1009_IP_CONTROL\") || (CLIENT.TCP.LB_VSERVER.NAME.TO_LOWER + \";any;\" + CLIENT.IP.SRC.SUBNET(11).TYPECAST_TEXT_T + \"/11\").IS_STRINGMAP_KEY(\"SM_CL1009_IP_CONTROL\") || (CLIENT.TCP.LB_VSERVER.NAME.TO_LOWER + \";any;\" + CLIENT.IP.SRC.SUBNET(10).TYPECAST_TEXT_T + \"/10\").IS_STRINGMAP_KEY(\"SM_CL1009_IP_CONTROL\")"
add policy expression PE_CL1009_IP_VSTCP_0X_B "(CLIENT.TCP.LB_VSERVER.NAME.TO_LOWER + \";any;\" + CLIENT.IP.SRC.SUBNET(9).TYPECAST_TEXT_T + \"/9\").IS_STRINGMAP_KEY(\"SM_CL1009_IP_CONTROL\") || (CLIENT.TCP.LB_VSERVER.NAME.TO_LOWER + \";any;\" + CLIENT.IP.SRC.SUBNET(8).TYPECAST_TEXT_T + \"/8\").IS_STRINGMAP_KEY(\"SM_CL1009_IP_CONTROL\") || (CLIENT.TCP.LB_VSERVER.NAME.TO_LOWER + \";any;\" + CLIENT.IP.SRC.SUBNET(7).TYPECAST_TEXT_T + \"/7\").IS_STRINGMAP_KEY(\"SM_CL1009_IP_CONTROL\") || (CLIENT.TCP.LB_VSERVER.NAME.TO_LOWER + \";any;\" + CLIENT.IP.SRC.SUBNET(6).TYPECAST_TEXT_T + \"/6\").IS_STRINGMAP_KEY(\"SM_CL1009_IP_CONTROL\") || (CLIENT.TCP.LB_VSERVER.NAME.TO_LOWER + \";any;\" + CLIENT.IP.SRC.SUBNET(5).TYPECAST_TEXT_T + \"/5\").IS_STRINGMAP_KEY(\"SM_CL1009_IP_CONTROL\")"
add policy expression PE_CL1009_IP_VSTCP_0X_A "(CLIENT.TCP.LB_VSERVER.NAME.TO_LOWER + \";any;\" + CLIENT.IP.SRC.SUBNET(4).TYPECAST_TEXT_T + \"/4\").IS_STRINGMAP_KEY(\"SM_CL1009_IP_CONTROL\") || (CLIENT.TCP.LB_VSERVER.NAME.TO_LOWER + \";any;\" + CLIENT.IP.SRC.SUBNET(3).TYPECAST_TEXT_T + \"/3\").IS_STRINGMAP_KEY(\"SM_CL1009_IP_CONTROL\") || (CLIENT.TCP.LB_VSERVER.NAME.TO_LOWER + \";any;\" + CLIENT.IP.SRC.SUBNET(2).TYPECAST_TEXT_T + \"/2\").IS_STRINGMAP_KEY(\"SM_CL1009_IP_CONTROL\") || (CLIENT.TCP.LB_VSERVER.NAME.TO_LOWER + \";any;\" + CLIENT.IP.SRC.SUBNET(1).TYPECAST_TEXT_T + \"/1\").IS_STRINGMAP_KEY(\"SM_CL1009_IP_CONTROL\")"

add audit messageaction LOG_CL1009_RSP_CL1009_BLOCKED_VS_NOTLISTED INFORMATIONAL "\"RSP_CL1009_IP_VSTCP_NOTLISTED - BLOCKED VS NOTLISTED - \" + CLIENT.TCP.LB_VSERVER.NAME + \" - \" + CLIENT.IP.SRC"
add audit messageaction LOG_CL1009_RSP_CL1009_BLOCKED_VS_ALLOWLIST INFORMATIONAL "\"RSP_CL1009_IP_VSTCP_ALLOWLIST - BLOCKED VS ALLOWLIST - \" + CLIENT.TCP.LB_VSERVER.NAME + \" - \" + CLIENT.IP.SRC"
add audit messageaction LOG_CL1009_RSP_CL1009_BLOCKED_VS_BLOCKLIST INFORMATIONAL "\"RSP_CL1009_IP_VSTCP_BLOCKLIST - BLOCKED VS BLOCKLIST - \" + CLIENT.TCP.LB_VSERVER.NAME + \" - \" + CLIENT.IP.SRC"

add responder policy RSP_CL1009_IP_VSTCP_NOTLISTED "!PE_CL1009_IP_VSTCP_IS_LISTED" RESET -comment "SM_CL1009_IP_CONTROL Blocked" -logAction LOG_CL1009_RSP_CL1009_BLOCKED_VS_NOTLISTED
add responder policy RSP_CL1009_IP_VSTCP_ALLOWLIST "PE_CL1009_IP_VSTCP_IS_LISTED && PE_CL1009_IP_VSTCP_IS_ALLOWLISTED && !(PE_CL1009_IP_VSTCP_3X || PE_CL1009_IP_VSTCP_2X_B || PE_CL1009_IP_VSTCP_2X_A || PE_CL1009_IP_VSTCP_1X_B || PE_CL1009_IP_VSTCP_1X_A || PE_CL1009_IP_VSTCP_0X_B || PE_CL1009_IP_VSTCP_0X_A) " RESET -comment "SM_CL1009_IP_CONTROL Blocked" -logAction LOG_CL1009_RSP_CL1009_BLOCKED_VS_ALLOWLIST
add responder policy RSP_CL1009_IP_VSTCP_BLOCKLIST "PE_CL1009_IP_VSTCP_IS_LISTED && PE_CL1009_IP_VSTCP_IS_BLOCKLISTED &&(PE_CL1009_IP_VSTCP_3X || PE_CL1009_IP_VSTCP_2X_B || PE_CL1009_IP_VSTCP_2X_A || PE_CL1009_IP_VSTCP_1X_B || PE_CL1009_IP_VSTCP_1X_A || PE_CL1009_IP_VSTCP_0X_B || PE_CL1009_IP_VSTCP_0X_A) " RESET -comment "SM_CL1009_IP_CONTROL Blocked" -logAction LOG_CL1009_RSP_CL1009_BLOCKED_VS_BLOCKLIST
add responder policy RSP_CL1009_VSHTTP_BLOCKED_NOT_LISTED PE_CL1009_IP_VSTCP_IS_LISTED RESET -comment "SM_CL1009_IP_CONTROL Blocked"


add audit messageaction LOG_CL1009_CORE_TX_COMPLETE INFORMATIONAL q/"CL1009_RWP,HTTP,OK," + PE_CL1009_RES_TXID + "," + CLIENT.IP.SRC + "," + HTTP.REQ.LB_VSERVER.NAME + "," + SERVER.IP.SRC/
add rewrite policy RWP_CL1009_CORE_TX_COMPLETE true NOREWRITE -logAction LOG_CL1009_CORE_TX_COMPLETE

### REQUEST REWRITE ###
add rewrite action RWA_CL1009_CORE_INS_X_FORWARDED_BY insert_http_header X-Forwarded-By HTTP.REQ.CS_VSERVER.NAME -comment "Inserts X-Forwarded-by; the name of the contentswitch that received the request"
add rewrite action RWA_CL1009_CORE_INS_X_FORWARDED_FOR insert_http_header X-Forwarded-For CLIENT.IP.SRC -comment "Inserts X-Forwarded-For; the original client source ip"
add rewrite action RWA_CL1009_CORE_INS_X_FORWARDED_PROTO_HTTP insert_http_header X-Forwarded-Proto "\"HTTP\"" -comment "Inserts X-Forwarded-Proto; HTTP = the original request was NOT offloaded"
add rewrite action RWA_CL1009_CORE_INS_X_FORWARDED_PROTO_HTTPS insert_http_header X-Forwarded-Proto "\"HTTPS\"" -comment "Inserts X-Forwarded-Proto; HTTPS = the original request was offloaded"
add rewrite action RWA_CL1009_CORE_DEL_ACCEPT_ENCODING delete_http_header Accept-Encoding -comment "Deletes Accept-Encoding; disables compression in the backend response"

add rewrite policy RWP_CL1009_CORE_INS_X_FORWARDED_BY true RWA_CL1009_CORE_INS_X_FORWARDED_BY
add rewrite policy RWP_CL1009_CORE_INS_X_FORWARDED_FOR true RWA_CL1009_CORE_INS_X_FORWARDED_FOR
add rewrite policy RWP_CL1009_CORE_INS_X_FORWARDED_PROTO_HTTP "!PE_CL1009_IS_SSL" RWA_CL1009_CORE_INS_X_FORWARDED_PROTO_HTTP
add rewrite policy RWP_CL1009_CORE_INS_X_FORWARDED_PROTO_HTTPS PE_CL1009_IS_SSL RWA_CL1009_CORE_INS_X_FORWARDED_PROTO_HTTPS
add rewrite policy RWP_CL1009_CORE_DEL_ACCEPT_ENCODING true RWA_CL1009_CORE_DEL_ACCEPT_ENCODING

 add rewrite policylabel RWPL_CL1009_CS_REQ_CORE http_req
bind rewrite policylabel RWPL_CL1009_CS_REQ_CORE RWP_CL1009_CORE_DEL_ACCEPT_ENCODING 1009001 NEXT
bind rewrite policylabel RWPL_CL1009_CS_REQ_CORE RWP_CL1009_CORE_INS_X_FORWARDED_FOR 1009002 NEXT
bind rewrite policylabel RWPL_CL1009_CS_REQ_CORE RWP_CL1009_CORE_INS_X_FORWARDED_BY 1009003 NEXT
bind rewrite policylabel RWPL_CL1009_CS_REQ_CORE RWP_CL1009_CORE_INS_X_FORWARDED_PROTO_HTTPS 1009004 NEXT
bind rewrite policylabel RWPL_CL1009_CS_REQ_CORE RWP_CL1009_CORE_INS_X_FORWARDED_PROTO_HTTP 1009005 NEXT

### RESPONSE REWRITE
add rewrite action RWA_CL1009_CORE_DEL_X_ASPNET_VERSION delete_http_header X-AspNet-Version
add rewrite action RWA_CL1009_CORE_DEL_SERVER delete_http_header Server
add rewrite action RWA_CL1009_CORE_DEL_X_POWERED_BY delete_http_header X-Powered-By
add rewrite action RWA_CL1009_CORE_INS_TXID insert_http_header TXID "HTTP.RES.TXID.BEFORE_STR(\"-\")"

add rewrite policy RWP_CL1009_CORE_DEL_X_ASPNET_VERSION true RWA_CL1009_CORE_DEL_X_ASPNET_VERSION
add rewrite policy RWP_CL1009_CORE_DEL_SERVER true RWA_CL1009_CORE_DEL_SERVER
add rewrite policy RWP_CL1009_CORE_DEL_X_POWERED_BY true RWA_CL1009_CORE_DEL_X_POWERED_BY
add rewrite policy RWP_CL1009_CORE_INS_TXID PE_CL1009_INSERT_TXID RWA_CL1009_CORE_INS_TXID

 add rewrite policylabel RWPL_CL1009_CS_RES_CORE http_res
bind rewrite policylabel RWPL_CL1009_CS_RES_CORE RWP_CL1009_CORE_DEL_X_ASPNET_VERSION 1009020 NEXT
bind rewrite policylabel RWPL_CL1009_CS_RES_CORE RWP_CL1009_CORE_DEL_SERVER 1009021 NEXT
bind rewrite policylabel RWPL_CL1009_CS_RES_CORE RWP_CL1009_CORE_DEL_X_POWERED_BY 1009022 NEXT
bind rewrite policylabel RWPL_CL1009_CS_RES_CORE RWP_CL1009_CORE_TX_COMPLETE 1009023 NEXT
bind rewrite policylabel RWPL_CL1009_CS_RES_CORE RWP_CL1009_CORE_INS_TXID 1009024 NEXT

### GENERAL PURPOSE SERVERS ### 
### DEFAULT SERVERS ###
add server CL1009_DUMMY 169.254.254.254

### SERVICE GROUPS ###
 add serviceGroup SG_CL1009_DUMMY_HTTP HTTP -healthMonitor NO
bind serviceGroup SG_CL1009_DUMMY_HTTP CL1009_DUMMY 80

 add serviceGroup SG_CL1009_DUMMY_TCP TCP -healthMonitor NO
bind serviceGroup SG_CL1009_DUMMY_TCP CL1009_DUMMY 80


### LOAD BALANCING VIRTUAL SERVERS ###
### VS_CL1009_REDIR_301 - 301 Redirects ###
 add lb vserver VS_CL1009_REDIR_301 HTTP 0.0.0.0 0 -persistenceType NONE -cltTimeout 180
bind lb vserver VS_CL1009_REDIR_301 SG_CL1009_DUMMY_HTTP
bind lb vserver VS_CL1009_REDIR_301 -policyName RSP_CL1009_HTTP_REDIR_FULL_LAN -priority 1009100 -gotoPriorityExpression END -type REQUEST
bind lb vserver VS_CL1009_REDIR_301 -policyName RSP_CL1009_HTTP_REDIR_SCND_LAN -priority 1009101 -gotoPriorityExpression END -type REQUEST
bind lb vserver VS_CL1009_REDIR_301 -policyName RSP_CL1009_HTTP_REDIR_FRST_LAN -priority 1009102 -gotoPriorityExpression END -type REQUEST
bind lb vserver VS_CL1009_REDIR_301 -policyName RSP_CL1009_HTTP_REDIR_FQDN_LAN -priority 1009103 -gotoPriorityExpression END -type REQUEST
bind lb vserver VS_CL1009_REDIR_301 -policyName RSP_CL1009_HTTP_REDIR_WILD_LAN -priority 1009104 -gotoPriorityExpression END -type REQUEST
bind lb vserver VS_CL1009_REDIR_301 -policyName RSP_CL1009_HTTP_REDIR_FULL_ANY -priority 1009110 -gotoPriorityExpression END -type REQUEST
bind lb vserver VS_CL1009_REDIR_301 -policyName RSP_CL1009_HTTP_REDIR_SCND_ANY -priority 1009111 -gotoPriorityExpression END -type REQUEST
bind lb vserver VS_CL1009_REDIR_301 -policyName RSP_CL1009_HTTP_REDIR_FRST_ANY -priority 1009112 -gotoPriorityExpression END -type REQUEST
bind lb vserver VS_CL1009_REDIR_301 -policyName RSP_CL1009_HTTP_REDIR_FQDN_ANY -priority 1009113 -gotoPriorityExpression END -type REQUEST
bind lb vserver VS_CL1009_REDIR_301 -policyName RSP_CL1009_HTTP_REDIR_WILD_ANY -priority 1009114 -gotoPriorityExpression END -type REQUEST

bind policy stringmap SM_CL1009_IP_CONTROL vs_cl1009_redir_301 "list=blocklist;"

### VS_CL1009_REDIR_301_KEEPPATH - 301 Redirects ###
 add lb vserver VS_CL1009_REDIR_301_KEEPPATH HTTP 0.0.0.0 0 -persistenceType NONE -cltTimeout 180
bind lb vserver VS_CL1009_REDIR_301_KEEPPATH SG_CL1009_DUMMY_HTTP
bind lb vserver VS_CL1009_REDIR_301_KEEPPATH -policyName RSP_CL1009_HTTP_REDIR_KEEPPATH_FULL_LAN -priority 1009100 -gotoPriorityExpression END -type REQUEST
bind lb vserver VS_CL1009_REDIR_301_KEEPPATH -policyName RSP_CL1009_HTTP_REDIR_KEEPPATH_SCND_LAN -priority 1009101 -gotoPriorityExpression END -type REQUEST
bind lb vserver VS_CL1009_REDIR_301_KEEPPATH -policyName RSP_CL1009_HTTP_REDIR_KEEPPATH_FRST_LAN -priority 1009102 -gotoPriorityExpression END -type REQUEST
bind lb vserver VS_CL1009_REDIR_301_KEEPPATH -policyName RSP_CL1009_HTTP_REDIR_KEEPPATH_FQDN_LAN -priority 1009103 -gotoPriorityExpression END -type REQUEST
bind lb vserver VS_CL1009_REDIR_301_KEEPPATH -policyName RSP_CL1009_HTTP_REDIR_KEEPPATH_WILD_LAN -priority 1009104 -gotoPriorityExpression END -type REQUEST
bind lb vserver VS_CL1009_REDIR_301_KEEPPATH -policyName RSP_CL1009_HTTP_REDIR_KEEPPATH_FULL_ANY -priority 1009110 -gotoPriorityExpression END -type REQUEST
bind lb vserver VS_CL1009_REDIR_301_KEEPPATH -policyName RSP_CL1009_HTTP_REDIR_KEEPPATH_SCND_ANY -priority 1009111 -gotoPriorityExpression END -type REQUEST
bind lb vserver VS_CL1009_REDIR_301_KEEPPATH -policyName RSP_CL1009_HTTP_REDIR_KEEPPATH_FRST_ANY -priority 1009112 -gotoPriorityExpression END -type REQUEST
bind lb vserver VS_CL1009_REDIR_301_KEEPPATH -policyName RSP_CL1009_HTTP_REDIR_KEEPPATH_FQDN_ANY -priority 1009113 -gotoPriorityExpression END -type REQUEST
bind lb vserver VS_CL1009_REDIR_301_KEEPPATH -policyName RSP_CL1009_HTTP_REDIR_KEEPPATH_WILD_ANY -priority 1009114 -gotoPriorityExpression END -type REQUEST

bind policy stringmap SM_CL1009_IP_CONTROL vs_cl1009_redir_301_keeppath "list=blocklist;"

### VS_CL1009_REDIR_301_SWITCH - 301 Redirects to switch protocol between HTTP/HTTPS ###
 add lb vserver VS_CL1009_REDIR_301_SWITCH HTTP 0.0.0.0 0 -persistenceType NONE -cltTimeout 180
bind lb vserver VS_CL1009_REDIR_301_SWITCH SG_CL1009_DUMMY_HTTP
bind lb vserver VS_CL1009_REDIR_301_SWITCH -policyName RSP_CL1009_HTTP_REDIR_SWITCH -priority 1009101 -gotoPriorityExpression END -type REQUEST

bind policy stringmap SM_CL1009_IP_CONTROL vs_cl1009_redir_301_switch "list=blocklist;"


### VS_CL1009_REDIR_302 - 302 Redirects ###
 add lb vserver VS_CL1009_REDIR_302 HTTP 0.0.0.0 0 -persistenceType NONE -cltTimeout 180
bind lb vserver VS_CL1009_REDIR_302 SG_CL1009_DUMMY_HTTP
bind lb vserver VS_CL1009_REDIR_302 -policyName RSP_CL1009_HTTP_REDIR_FULL_LAN -priority 1009100 -gotoPriorityExpression END -type REQUEST
bind lb vserver VS_CL1009_REDIR_302 -policyName RSP_CL1009_HTTP_REDIR_SCND_LAN -priority 1009101 -gotoPriorityExpression END -type REQUEST
bind lb vserver VS_CL1009_REDIR_302 -policyName RSP_CL1009_HTTP_REDIR_FRST_LAN -priority 1009102 -gotoPriorityExpression END -type REQUEST
bind lb vserver VS_CL1009_REDIR_302 -policyName RSP_CL1009_HTTP_REDIR_FQDN_LAN -priority 1009103 -gotoPriorityExpression END -type REQUEST
bind lb vserver VS_CL1009_REDIR_302 -policyName RSP_CL1009_HTTP_REDIR_WILD_LAN -priority 1009104 -gotoPriorityExpression END -type REQUEST
bind lb vserver VS_CL1009_REDIR_302 -policyName RSP_CL1009_HTTP_REDIR_FULL_ANY -priority 1009110 -gotoPriorityExpression END -type REQUEST
bind lb vserver VS_CL1009_REDIR_302 -policyName RSP_CL1009_HTTP_REDIR_SCND_ANY -priority 1009111 -gotoPriorityExpression END -type REQUEST
bind lb vserver VS_CL1009_REDIR_302 -policyName RSP_CL1009_HTTP_REDIR_FRST_ANY -priority 1009112 -gotoPriorityExpression END -type REQUEST
bind lb vserver VS_CL1009_REDIR_302 -policyName RSP_CL1009_HTTP_REDIR_FQDN_ANY -priority 1009113 -gotoPriorityExpression END -type REQUEST
bind lb vserver VS_CL1009_REDIR_302 -policyName RSP_CL1009_HTTP_REDIR_WILD_ANY -priority 1009114 -gotoPriorityExpression END -type REQUEST

bind policy stringmap SM_CL1009_IP_CONTROL vs_cl1009_redir_302 "list=blocklist;"

### VS_CL1009_REDIR_302_KEEPPATH - 302 Redirects ###
 add lb vserver VS_CL1009_REDIR_302_KEEPPATH HTTP 0.0.0.0 0 -persistenceType NONE -cltTimeout 180
bind lb vserver VS_CL1009_REDIR_302_KEEPPATH SG_CL1009_DUMMY_HTTP
bind lb vserver VS_CL1009_REDIR_302_KEEPPATH -policyName RSP_CL1009_HTTP_REDIR_KEEPPATH_FULL_LAN -priority 1009100 -gotoPriorityExpression END -type REQUEST
bind lb vserver VS_CL1009_REDIR_302_KEEPPATH -policyName RSP_CL1009_HTTP_REDIR_KEEPPATH_SCND_LAN -priority 1009101 -gotoPriorityExpression END -type REQUEST
bind lb vserver VS_CL1009_REDIR_302_KEEPPATH -policyName RSP_CL1009_HTTP_REDIR_KEEPPATH_FRST_LAN -priority 1009102 -gotoPriorityExpression END -type REQUEST
bind lb vserver VS_CL1009_REDIR_302_KEEPPATH -policyName RSP_CL1009_HTTP_REDIR_KEEPPATH_FQDN_LAN -priority 1009103 -gotoPriorityExpression END -type REQUEST
bind lb vserver VS_CL1009_REDIR_302_KEEPPATH -policyName RSP_CL1009_HTTP_REDIR_KEEPPATH_WILD_LAN -priority 1009104 -gotoPriorityExpression END -type REQUEST
bind lb vserver VS_CL1009_REDIR_302_KEEPPATH -policyName RSP_CL1009_HTTP_REDIR_KEEPPATH_FULL_ANY -priority 1009110 -gotoPriorityExpression END -type REQUEST
bind lb vserver VS_CL1009_REDIR_302_KEEPPATH -policyName RSP_CL1009_HTTP_REDIR_KEEPPATH_SCND_ANY -priority 1009111 -gotoPriorityExpression END -type REQUEST
bind lb vserver VS_CL1009_REDIR_302_KEEPPATH -policyName RSP_CL1009_HTTP_REDIR_KEEPPATH_FRST_ANY -priority 1009112 -gotoPriorityExpression END -type REQUEST
bind lb vserver VS_CL1009_REDIR_302_KEEPPATH -policyName RSP_CL1009_HTTP_REDIR_KEEPPATH_FQDN_ANY -priority 1009113 -gotoPriorityExpression END -type REQUEST
bind lb vserver VS_CL1009_REDIR_302_KEEPPATH -policyName RSP_CL1009_HTTP_REDIR_KEEPPATH_WILD_ANY -priority 1009114 -gotoPriorityExpression END -type REQUEST

bind policy stringmap SM_CL1009_IP_CONTROL vs_cl1009_redir_302_keeppath "list=blocklist;"

### VS_CL1009_REDIR_302_SWITCH - 302 Redirects to switch protocol between HTTP/HTTPS ###
 add lb vserver VS_CL1009_REDIR_302_SWITCH HTTP 0.0.0.0 0 -persistenceType NONE -cltTimeout 180
bind lb vserver VS_CL1009_REDIR_302_SWITCH SG_CL1009_DUMMY_HTTP
bind lb vserver VS_CL1009_REDIR_302_SWITCH -policyName RSP_CL1009_HTTP_REDIR_SWITCH -priority 1009101 -gotoPriorityExpression END -type REQUEST

bind policy stringmap SM_CL1009_IP_CONTROL vs_cl1009_redir_302_switch "list=blocklist;"

### VS_CL1009_REDIR_307 - 307 Redirects ###
 add lb vserver VS_CL1009_REDIR_307 HTTP 0.0.0.0 0 -persistenceType NONE -cltTimeout 180
bind lb vserver VS_CL1009_REDIR_307 SG_CL1009_DUMMY_HTTP
bind lb vserver VS_CL1009_REDIR_307 -policyName RSP_CL1009_HTTP_REDIR_FULL_LAN -priority 1009100 -gotoPriorityExpression END -type REQUEST
bind lb vserver VS_CL1009_REDIR_307 -policyName RSP_CL1009_HTTP_REDIR_SCND_LAN -priority 1009101 -gotoPriorityExpression END -type REQUEST
bind lb vserver VS_CL1009_REDIR_307 -policyName RSP_CL1009_HTTP_REDIR_FRST_LAN -priority 1009102 -gotoPriorityExpression END -type REQUEST
bind lb vserver VS_CL1009_REDIR_307 -policyName RSP_CL1009_HTTP_REDIR_FQDN_LAN -priority 1009103 -gotoPriorityExpression END -type REQUEST
bind lb vserver VS_CL1009_REDIR_307 -policyName RSP_CL1009_HTTP_REDIR_WILD_LAN -priority 1009104 -gotoPriorityExpression END -type REQUEST
bind lb vserver VS_CL1009_REDIR_307 -policyName RSP_CL1009_HTTP_REDIR_FULL_ANY -priority 1009110 -gotoPriorityExpression END -type REQUEST
bind lb vserver VS_CL1009_REDIR_307 -policyName RSP_CL1009_HTTP_REDIR_SCND_ANY -priority 1009111 -gotoPriorityExpression END -type REQUEST
bind lb vserver VS_CL1009_REDIR_307 -policyName RSP_CL1009_HTTP_REDIR_FRST_ANY -priority 1009112 -gotoPriorityExpression END -type REQUEST
bind lb vserver VS_CL1009_REDIR_307 -policyName RSP_CL1009_HTTP_REDIR_FQDN_ANY -priority 1009113 -gotoPriorityExpression END -type REQUEST
bind lb vserver VS_CL1009_REDIR_307 -policyName RSP_CL1009_HTTP_REDIR_WILD_ANY -priority 1009114 -gotoPriorityExpression END -type REQUEST

bind policy stringmap SM_CL1009_IP_CONTROL vs_cl1009_redir_307 "list=blocklist;"

### VS_CL1009_REDIR_307_KEEPPATH - 307 Redirects ###
 add lb vserver VS_CL1009_REDIR_307_KEEPPATH HTTP 0.0.0.0 0 -persistenceType NONE -cltTimeout 180
bind lb vserver VS_CL1009_REDIR_307_KEEPPATH SG_CL1009_DUMMY_HTTP
bind lb vserver VS_CL1009_REDIR_307_KEEPPATH -policyName RSP_CL1009_HTTP_REDIR_KEEPPATH_FULL_LAN -priority 1009100 -gotoPriorityExpression END -type REQUEST
bind lb vserver VS_CL1009_REDIR_307_KEEPPATH -policyName RSP_CL1009_HTTP_REDIR_KEEPPATH_SCND_LAN -priority 1009101 -gotoPriorityExpression END -type REQUEST
bind lb vserver VS_CL1009_REDIR_307_KEEPPATH -policyName RSP_CL1009_HTTP_REDIR_KEEPPATH_FRST_LAN -priority 1009102 -gotoPriorityExpression END -type REQUEST
bind lb vserver VS_CL1009_REDIR_307_KEEPPATH -policyName RSP_CL1009_HTTP_REDIR_KEEPPATH_FQDN_LAN -priority 1009103 -gotoPriorityExpression END -type REQUEST
bind lb vserver VS_CL1009_REDIR_307_KEEPPATH -policyName RSP_CL1009_HTTP_REDIR_KEEPPATH_WILD_LAN -priority 1009104 -gotoPriorityExpression END -type REQUEST
bind lb vserver VS_CL1009_REDIR_307_KEEPPATH -policyName RSP_CL1009_HTTP_REDIR_KEEPPATH_FULL_ANY -priority 1009110 -gotoPriorityExpression END -type REQUEST
bind lb vserver VS_CL1009_REDIR_307_KEEPPATH -policyName RSP_CL1009_HTTP_REDIR_KEEPPATH_SCND_ANY -priority 1009111 -gotoPriorityExpression END -type REQUEST
bind lb vserver VS_CL1009_REDIR_307_KEEPPATH -policyName RSP_CL1009_HTTP_REDIR_KEEPPATH_FRST_ANY -priority 1009112 -gotoPriorityExpression END -type REQUEST
bind lb vserver VS_CL1009_REDIR_307_KEEPPATH -policyName RSP_CL1009_HTTP_REDIR_KEEPPATH_FQDN_ANY -priority 1009113 -gotoPriorityExpression END -type REQUEST
bind lb vserver VS_CL1009_REDIR_307_KEEPPATH -policyName RSP_CL1009_HTTP_REDIR_KEEPPATH_WILD_ANY -priority 1009114 -gotoPriorityExpression END -type REQUEST

bind policy stringmap SM_CL1009_IP_CONTROL vs_cl1009_redir_307_keeppath "list=blocklist;"

### VS_CL1009_REDIR_307_SWITCH - 307 Redirects to switch protocol between HTTP/HTTPS ###
 add lb vserver VS_CL1009_REDIR_307_SWITCH HTTP 0.0.0.0 0 -persistenceType NONE -cltTimeout 180
bind lb vserver VS_CL1009_REDIR_307_SWITCH SG_CL1009_DUMMY_HTTP
bind lb vserver VS_CL1009_REDIR_307_SWITCH -policyName RSP_CL1009_HTTP_REDIR_SWITCH -priority 1009101 -gotoPriorityExpression END -type REQUEST

bind policy stringmap SM_CL1009_IP_CONTROL vs_cl1009_redir_307_switch "list=blocklist;"

### VS_CL1009_REDIR_308 - 308 Redirects ###
 add lb vserver VS_CL1009_REDIR_308 HTTP 0.0.0.0 0 -persistenceType NONE -cltTimeout 180
bind lb vserver VS_CL1009_REDIR_308 SG_CL1009_DUMMY_HTTP
bind lb vserver VS_CL1009_REDIR_308 -policyName RSP_CL1009_HTTP_REDIR_FULL_LAN -priority 1009100 -gotoPriorityExpression END -type REQUEST
bind lb vserver VS_CL1009_REDIR_308 -policyName RSP_CL1009_HTTP_REDIR_SCND_LAN -priority 1009101 -gotoPriorityExpression END -type REQUEST
bind lb vserver VS_CL1009_REDIR_308 -policyName RSP_CL1009_HTTP_REDIR_FRST_LAN -priority 1009102 -gotoPriorityExpression END -type REQUEST
bind lb vserver VS_CL1009_REDIR_308 -policyName RSP_CL1009_HTTP_REDIR_FQDN_LAN -priority 1009103 -gotoPriorityExpression END -type REQUEST
bind lb vserver VS_CL1009_REDIR_308 -policyName RSP_CL1009_HTTP_REDIR_WILD_LAN -priority 1009104 -gotoPriorityExpression END -type REQUEST
bind lb vserver VS_CL1009_REDIR_308 -policyName RSP_CL1009_HTTP_REDIR_FULL_ANY -priority 1009110 -gotoPriorityExpression END -type REQUEST
bind lb vserver VS_CL1009_REDIR_308 -policyName RSP_CL1009_HTTP_REDIR_SCND_ANY -priority 1009111 -gotoPriorityExpression END -type REQUEST
bind lb vserver VS_CL1009_REDIR_308 -policyName RSP_CL1009_HTTP_REDIR_FRST_ANY -priority 1009112 -gotoPriorityExpression END -type REQUEST
bind lb vserver VS_CL1009_REDIR_308 -policyName RSP_CL1009_HTTP_REDIR_FQDN_ANY -priority 1009113 -gotoPriorityExpression END -type REQUEST
bind lb vserver VS_CL1009_REDIR_308 -policyName RSP_CL1009_HTTP_REDIR_WILD_ANY -priority 1009114 -gotoPriorityExpression END -type REQUEST

bind policy stringmap SM_CL1009_IP_CONTROL vs_cl1009_redir_308 "list=blocklist;"

### VS_CL1009_REDIR_308_KEEPPATH - 308 Redirects ###
 add lb vserver VS_CL1009_REDIR_308_KEEPPATH HTTP 0.0.0.0 0 -persistenceType NONE -cltTimeout 180
bind lb vserver VS_CL1009_REDIR_308_KEEPPATH SG_CL1009_DUMMY_HTTP
bind lb vserver VS_CL1009_REDIR_308_KEEPPATH -policyName RSP_CL1009_HTTP_REDIR_KEEPPATH_FULL_LAN -priority 1009100 -gotoPriorityExpression END -type REQUEST
bind lb vserver VS_CL1009_REDIR_308_KEEPPATH -policyName RSP_CL1009_HTTP_REDIR_KEEPPATH_SCND_LAN -priority 1009101 -gotoPriorityExpression END -type REQUEST
bind lb vserver VS_CL1009_REDIR_308_KEEPPATH -policyName RSP_CL1009_HTTP_REDIR_KEEPPATH_FRST_LAN -priority 1009102 -gotoPriorityExpression END -type REQUEST
bind lb vserver VS_CL1009_REDIR_308_KEEPPATH -policyName RSP_CL1009_HTTP_REDIR_KEEPPATH_FQDN_LAN -priority 1009103 -gotoPriorityExpression END -type REQUEST
bind lb vserver VS_CL1009_REDIR_308_KEEPPATH -policyName RSP_CL1009_HTTP_REDIR_KEEPPATH_WILD_LAN -priority 1009104 -gotoPriorityExpression END -type REQUEST
bind lb vserver VS_CL1009_REDIR_308_KEEPPATH -policyName RSP_CL1009_HTTP_REDIR_KEEPPATH_FULL_ANY -priority 1009110 -gotoPriorityExpression END -type REQUEST
bind lb vserver VS_CL1009_REDIR_308_KEEPPATH -policyName RSP_CL1009_HTTP_REDIR_KEEPPATH_SCND_ANY -priority 1009111 -gotoPriorityExpression END -type REQUEST
bind lb vserver VS_CL1009_REDIR_308_KEEPPATH -policyName RSP_CL1009_HTTP_REDIR_KEEPPATH_FRST_ANY -priority 1009112 -gotoPriorityExpression END -type REQUEST
bind lb vserver VS_CL1009_REDIR_308_KEEPPATH -policyName RSP_CL1009_HTTP_REDIR_KEEPPATH_FQDN_ANY -priority 1009113 -gotoPriorityExpression END -type REQUEST
bind lb vserver VS_CL1009_REDIR_308_KEEPPATH -policyName RSP_CL1009_HTTP_REDIR_KEEPPATH_WILD_ANY -priority 1009114 -gotoPriorityExpression END -type REQUEST

bind policy stringmap SM_CL1009_IP_CONTROL vs_cl1009_redir_308_keeppath "list=blocklist;"

### VS_CL1009_REDIR_308_SWITCH - 308 Redirects to switch protocol between HTTP/HTTPS ###
 add lb vserver VS_CL1009_REDIR_308_SWITCH HTTP 0.0.0.0 0 -persistenceType NONE -cltTimeout 180
bind lb vserver VS_CL1009_REDIR_308_SWITCH SG_CL1009_DUMMY_HTTP
bind lb vserver VS_CL1009_REDIR_308_SWITCH -policyName RSP_CL1009_HTTP_REDIR_SWITCH -priority 1009101 -gotoPriorityExpression END -type REQUEST

bind policy stringmap SM_CL1009_IP_CONTROL vs_cl1009_redir_308_switch "list=blocklist;"




### VS_CL1009_NO_SERVICE_HTTP - Default load balancer for HTTP ###
 add lb vserver VS_CL1009_NO_SERVICE_HTTP HTTP 0.0.0.0 0 -persistenceType NONE -cltTimeout 180
bind lb vserver VS_CL1009_NO_SERVICE_HTTP SG_CL1009_DUMMY_HTTP
bind lb vserver VS_CL1009_NO_SERVICE_HTTP -policyName RSP_CL1009_HTTP_NO_SERVICE_FULL_LAN -priority 1009100 -gotoPriorityExpression END -type REQUEST
bind lb vserver VS_CL1009_NO_SERVICE_HTTP -policyName RSP_CL1009_HTTP_NO_SERVICE_SCND_LAN -priority 1009101 -gotoPriorityExpression END -type REQUEST
bind lb vserver VS_CL1009_NO_SERVICE_HTTP -policyName RSP_CL1009_HTTP_NO_SERVICE_FRST_LAN -priority 1009102 -gotoPriorityExpression END -type REQUEST
bind lb vserver VS_CL1009_NO_SERVICE_HTTP -policyName RSP_CL1009_HTTP_NO_SERVICE_FQDN_LAN -priority 1009103 -gotoPriorityExpression END -type REQUEST
bind lb vserver VS_CL1009_NO_SERVICE_HTTP -policyName RSP_CL1009_HTTP_NO_SERVICE_WILD_LAN -priority 1009104 -gotoPriorityExpression END -type REQUEST
bind lb vserver VS_CL1009_NO_SERVICE_HTTP -policyName RSP_CL1009_HTTP_NO_SERVICE_FULL_ANY -priority 1009110 -gotoPriorityExpression END -type REQUEST
bind lb vserver VS_CL1009_NO_SERVICE_HTTP -policyName RSP_CL1009_HTTP_NO_SERVICE_FRST_ANY -priority 1009111 -gotoPriorityExpression END -type REQUEST
bind lb vserver VS_CL1009_NO_SERVICE_HTTP -policyName RSP_CL1009_HTTP_NO_SERVICE_SCND_ANY -priority 1009112 -gotoPriorityExpression END -type REQUEST
bind lb vserver VS_CL1009_NO_SERVICE_HTTP -policyName RSP_CL1009_HTTP_NO_SERVICE_FQDN_ANY -priority 1009113 -gotoPriorityExpression END -type REQUEST
bind lb vserver VS_CL1009_NO_SERVICE_HTTP -policyName RSP_CL1009_HTTP_NO_SERVICE_WILD_ANY -priority 1009114 -gotoPriorityExpression END -type REQUEST

bind lb vserver VS_CL1009_NO_SERVICE_HTTP -policyName RSP_CL1009_HTTP_NO_SERVICE_SWITCH_FULL_LAN -priority 1009200 -gotoPriorityExpression END -type REQUEST
bind lb vserver VS_CL1009_NO_SERVICE_HTTP -policyName RSP_CL1009_HTTP_NO_SERVICE_SWITCH_SCND_LAN -priority 1009201 -gotoPriorityExpression END -type REQUEST
bind lb vserver VS_CL1009_NO_SERVICE_HTTP -policyName RSP_CL1009_HTTP_NO_SERVICE_SWITCH_FRST_LAN -priority 1009202 -gotoPriorityExpression END -type REQUEST
bind lb vserver VS_CL1009_NO_SERVICE_HTTP -policyName RSP_CL1009_HTTP_NO_SERVICE_SWITCH_FQDN_LAN -priority 1009203 -gotoPriorityExpression END -type REQUEST
bind lb vserver VS_CL1009_NO_SERVICE_HTTP -policyName RSP_CL1009_HTTP_NO_SERVICE_SWITCH_WILD_LAN -priority 1009204 -gotoPriorityExpression END -type REQUEST
bind lb vserver VS_CL1009_NO_SERVICE_HTTP -policyName RSP_CL1009_HTTP_NO_SERVICE_SWITCH_FULL_ANY -priority 1009210 -gotoPriorityExpression END -type REQUEST
bind lb vserver VS_CL1009_NO_SERVICE_HTTP -policyName RSP_CL1009_HTTP_NO_SERVICE_SWITCH_FRST_ANY -priority 1009211 -gotoPriorityExpression END -type REQUEST
bind lb vserver VS_CL1009_NO_SERVICE_HTTP -policyName RSP_CL1009_HTTP_NO_SERVICE_SWITCH_SCND_ANY -priority 1009212 -gotoPriorityExpression END -type REQUEST
bind lb vserver VS_CL1009_NO_SERVICE_HTTP -policyName RSP_CL1009_HTTP_NO_SERVICE_SWITCH_FQDN_ANY -priority 1009213 -gotoPriorityExpression END -type REQUEST
bind lb vserver VS_CL1009_NO_SERVICE_HTTP -policyName RSP_CL1009_HTTP_NO_SERVICE_SWITCH_WILD_ANY -priority 1009214 -gotoPriorityExpression END -type REQUEST

bind lb vserver VS_CL1009_NO_SERVICE_HTTP -policyName RSP_CL1009_NOTFOUND_HTTP -priority -priority 1009250 -gotoPriorityExpression END -type REQUEST

bind policy stringmap SM_CL1009_IP_CONTROL vs_cl1009_no_service_http "list=blocklist;"


### VS_CL1009_NO_SERVICE_SSL - Default load balancer for SSL ###
 add lb vserver VS_CL1009_NO_SERVICE_SSL HTTP 0.0.0.0 0 -persistenceType NONE -cltTimeout 180
bind lb vserver VS_CL1009_NO_SERVICE_SSL SG_CL1009_DUMMY_HTTP
bind lb vserver VS_CL1009_NO_SERVICE_SSL -policyName RSP_CL1009_HTTP_NO_SERVICE_FULL_LAN -priority 1009100 -gotoPriorityExpression END -type REQUEST
bind lb vserver VS_CL1009_NO_SERVICE_SSL -policyName RSP_CL1009_HTTP_NO_SERVICE_SCND_LAN -priority 1009101 -gotoPriorityExpression END -type REQUEST
bind lb vserver VS_CL1009_NO_SERVICE_SSL -policyName RSP_CL1009_HTTP_NO_SERVICE_FRST_LAN -priority 1009102 -gotoPriorityExpression END -type REQUEST
bind lb vserver VS_CL1009_NO_SERVICE_SSL -policyName RSP_CL1009_HTTP_NO_SERVICE_FQDN_LAN -priority 1009103 -gotoPriorityExpression END -type REQUEST
bind lb vserver VS_CL1009_NO_SERVICE_SSL -policyName RSP_CL1009_HTTP_NO_SERVICE_WILD_LAN -priority 1009104 -gotoPriorityExpression END -type REQUEST
bind lb vserver VS_CL1009_NO_SERVICE_SSL -policyName RSP_CL1009_HTTP_NO_SERVICE_FULL_ANY -priority 1009110 -gotoPriorityExpression END -type REQUEST
bind lb vserver VS_CL1009_NO_SERVICE_SSL -policyName RSP_CL1009_HTTP_NO_SERVICE_FRST_ANY -priority 1009111 -gotoPriorityExpression END -type REQUEST
bind lb vserver VS_CL1009_NO_SERVICE_SSL -policyName RSP_CL1009_HTTP_NO_SERVICE_FRST_ANY -priority 1009112 -gotoPriorityExpression END -type REQUEST
bind lb vserver VS_CL1009_NO_SERVICE_SSL -policyName RSP_CL1009_HTTP_NO_SERVICE_FQDN_ANY -priority 1009113 -gotoPriorityExpression END -type REQUEST
bind lb vserver VS_CL1009_NO_SERVICE_SSL -policyName RSP_CL1009_HTTP_NO_SERVICE_WILD_ANY -priority 1009114 -gotoPriorityExpression END -type REQUEST
bind lb vserver VS_CL1009_NO_SERVICE_SSL -policyName RSP_CL1009_NOTFOUND_HTTP -priority -priority 1009250 -gotoPriorityExpression END -type REQUEST

bind policy stringmap SM_CL1009_IP_CONTROL vs_cl1009_no_service_ssl "list=blocklist;"


### VS_CL1009_NO_SERVICE_TCP - Default load balancer for SSL ###
 add lb vserver VS_CL1009_NO_SERVICE_TCP TCP 0.0.0.0 0 -persistenceType NONE -cltTimeout 180
bind lb vserver VS_CL1009_NO_SERVICE_TCP SG_CL1009_DUMMY_TCP
bind lb vserver VS_CL1009_NO_SERVICE_TCP -policyName RSP_CL1009_RESET_TCP -priority -priority 1009250 -gotoPriorityExpression END -type REQUEST

bind policy stringmap SM_CL1009_IP_CONTROL vs_cl1009_no_service_tcp "list=blocklist;"


### VS_CL1009_NOTFOUND_HTTP - Default response for blocked traffic ###
 add lb vserver VS_CL1009_NOTFOUND_HTTP HTTP 0.0.0.0 0 -persistenceType NONE -cltTimeout 180
bind lb vserver VS_CL1009_NOTFOUND_HTTP SG_CL1009_DUMMY_HTTP
bind lb vserver VS_CL1009_NOTFOUND_HTTP -policyName RSP_CL1009_NOTFOUND_HTTP -priority 1009100 -gotoPriorityExpression END -type REQUEST

bind policy stringmap SM_CL1009_IP_CONTROL vs_cl1009_notfound_http "list=blocklist;"


### VS_CL1009_BLOCKED_HTTP - Default response for blocked traffic ###
 add lb vserver VS_CL1009_BLOCKED_HTTP HTTP 0.0.0.0 0 -persistenceType NONE -cltTimeout 180
bind lb vserver VS_CL1009_BLOCKED_HTTP SG_CL1009_DUMMY_HTTP
bind lb vserver VS_CL1009_BLOCKED_HTTP -policyName RSP_CL1009_BLOCKED -priority 1009100 -gotoPriorityExpression END -type REQUEST

bind policy stringmap SM_CL1009_IP_CONTROL vs_cl1009_blocked_http "list=blocklist;"

### VS_CL1009_DROP_HTTP - Default drop for unwanted traffic ###
 add lb vserver VS_CL1009_DROP_HTTP HTTP 0.0.0.0 0 -persistenceType NONE -cltTimeout 180
bind lb vserver VS_CL1009_DROP_HTTP SG_CL1009_DUMMY_HTTP
bind lb vserver VS_CL1009_DROP_HTTP -policyName RSP_CL1009_DROP_HTTP -priority 1009100 -gotoPriorityExpression END -type REQUEST

bind policy stringmap SM_CL1009_IP_CONTROL vs_cl1009_drop_http "list=blocklist;"


### VS_CL1009_DROP_TCP - Default drop for unwanted traffic ###
 add lb vserver VS_CL1009_DROP_TCP TCP 0.0.0.0 0 -persistenceType NONE -cltTimeout 180
bind lb vserver VS_CL1009_DROP_TCP SG_CL1009_DUMMY_TCP
bind lb vserver VS_CL1009_DROP_TCP -policyName RSP_CL1009_DROP_TCP -priority 1009100 -gotoPriorityExpression END -type REQUEST

bind policy stringmap SM_CL1009_IP_CONTROL vs_cl1009_drop_tcp "list=blocklist;"


### VS_CL1009_RESET_HTTP - Default reset for unwanted traffic ###
 add lb vserver VS_CL1009_RESET_HTTP HTTP 0.0.0.0 0 -persistenceType NONE -cltTimeout 180
bind lb vserver VS_CL1009_RESET_HTTP SG_CL1009_DUMMY_HTTP
bind lb vserver VS_CL1009_RESET_HTTP -policyName RSP_CL1009_RESET_HTTP -priority 1009100 -gotoPriorityExpression END -type REQUEST

bind policy stringmap SM_CL1009_IP_CONTROL vs_cl1009_reset_http "list=blocklist;"


### VS_CL1009_RESET_TCP - Default reset for unwanted traffic ###
 add lb vserver VS_CL1009_RESET_TCP TCP 0.0.0.0 0 -persistenceType NONE -cltTimeout 180
bind lb vserver VS_CL1009_RESET_TCP SG_CL1009_DUMMY_TCP
bind lb vserver VS_CL1009_RESET_TCP -policyName RSP_CL1009_RESET_TCP -priority 1009100 -gotoPriorityExpression END -type REQUEST

bind policy stringmap SM_CL1009_IP_CONTROL vs_cl1009_reset_tcp "list=blocklist;"


### VS_CL1009_ACME_HTTP - ACME handler ###
 add lb vserver VS_CL1009_ACME_HTTP HTTP 0.0.0.0 0 -persistenceType NONE -cltTimeout 180
bind lb vserver VS_CL1009_ACME_HTTP SG_CL1009_DUMMY_HTTP
bind lb vserver VS_CL1009_ACME_HTTP -policyName RSP_CL1009_ACME_HTTP -priority 1009100 -gotoPriorityExpression END -type REQUEST
bind lb vserver VS_CL1009_ACME_HTTP -policyName RSP_CL1009_NOTFOUND_HTTP -priority 1009101 -gotoPriorityExpression END -type REQUEST

bind policy stringmap SM_CL1009_IP_CONTROL vs_cl1009_acme_http "list=blocklist;"

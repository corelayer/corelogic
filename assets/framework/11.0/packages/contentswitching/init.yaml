name: init
tags:
  - core
sections:
  - name: appexpert.expressions.advanced
    elements:
      - name: INIT_CS
        fields:
          - id: name
            data: <<prefix>>_INIT
          - id: expression
            data: true
        expressions:
          install: add policy expression <<name>> q{<<expression>>}

  - name: trafficmanagement.contentswitching.policies
    elements:
      - name: INIT_IPV4_HTTP
        fields:
          - id: name
            data: <<prefix>>_INIT_IPV4_HTTP
          - id: expression
            data: <<core.placeholders.appexpert.expressions.advanced.CLIENT_IS_IPV4/name>>
        expressions:
          install: add cs policy <<name>> -rule q{<<expression>>}
          uninstall: rm cs policy <<name>>
      - name: INIT_IPV6_HTTP
        fields:
          - id: name
            data: <<prefix>>_INIT_IPV6_HTTP
          - id: expression
            data: <<core.placeholders.appexpert.expressions.advanced.CLIENT_IS_IPV6/name>>
        expressions:
          install: add cs policy <<name>> -rule q{<<expression>>}
          uninstall: rm cs policy <<name>>

      - name: INIT_IPV4_SSL
        fields:
          - id: name
            data: <<prefix>>_INIT_IPV4_SSL
          - id: expression
            data: <<core.placeholders.appexpert.expressions.advanced.CLIENT_IS_IPV4/name>>
        expressions:
          install: add cs policy <<name>> -rule q{<<expression>>}
          uninstall: rm cs policy <<name>>
      - name: INIT_IPV6_SSL
        fields:
          - id: name
            data: <<prefix>>_INIT_IPV6_SSL
          - id: expression
            data: <<core.placeholders.appexpert.expressions.advanced.CLIENT_IS_IPV6/name>>
        expressions:
          install: add cs policy <<name>> -rule q{<<expression>>}
          uninstall: rm cs policy <<name>>

      - name: INIT_IPV4_TCP
        fields:
          - id: name
            data: <<prefix>>_INIT_IPV4_TCP
          - id: expression
            data: <<core.placeholders.appexpert.expressions.advanced.CLIENT_IS_IPV4/name>>
        expressions:
          install: add cs policy <<name>> -rule q{<<expression>>}
          uninstall: rm cs policy <<name>>
      - name: INIT_IPV6_TCP
        fields:
          - id: name
            data: <<prefix>>_INIT_IPV6_TCP
          - id: expression
            data: <<core.placeholders.appexpert.expressions.advanced.CLIENT_IS_IPV6/name>>
        expressions:
          install: add cs policy <<name>> -rule q{<<expression>>}
          uninstall: rm cs policy <<name>>

      - name: INIT_IPV4_SSLTCP
        fields:
          - id: name
            data: <<prefix>>_INIT_IPV4_SSLTCP
          - id: expression
            data: <<core.placeholders.appexpert.expressions.advanced.CLIENT_IS_IPV4/name>>
        expressions:
          install: add cs policy <<name>> -rule q{<<expression>>}
          uninstall: rm cs policy <<name>>
      - name: INIT_IPV6_SSLTCP
        fields:
          - id: name
            data: <<prefix>>_INIT_IPV6_SSLTCP
          - id: expression
            data: <<core.placeholders.appexpert.expressions.advanced.CLIENT_IS_IPV6/name>>
        expressions:
          install: add cs policy <<name>> -rule q{<<expression>>}
          uninstall: rm cs policy <<name>>

      - name: INIT_IPV4_UDP
        fields:
          - id: name
            data: <<prefix>>_INIT_IPV4_UDP
          - id: expression
            data: <<core.placeholders.appexpert.expressions.advanced.CLIENT_IS_IPV4/name>>
        expressions:
          install: add cs policy <<name>> -rule q{<<expression>>}
          uninstall: rm cs policy <<name>>
      - name: INIT_IPV6_UDP
        fields:
          - id: name
            data: <<prefix>>_INIT_IPV6_UDP
          - id: expression
            data: <<core.placeholders.appexpert.expressions.advanced.CLIENT_IS_IPV6/name>>
        expressions:
          install: add cs policy <<name>> -rule q{<<expression>>}
          uninstall: rm cs policy <<name>>
  
  - name: trafficmanagement.contentswitching.policylabels
    elements:
      - name: INIT_HTTP
        fields:
          - id: name
            data: <<prefix>>_INIT_HTTP
          
        expressions:
          install: add cs policylabel <<name>> HTTP
          uninstall: rm cs policylabel <<name>>

      - name: INIT_SSL
        fields:
          - id: name
            data: <<prefix>>_INIT_SSL
          
        expressions:
          install: add cs policylabel <<name>> HTTP
          uninstall: rm cs policylabel <<name>>

      - name: INIT_TCP
        fields:
          - id: name
            data: <<prefix>>_INIT_TCP
          
        expressions:
          install: add cs policylabel <<name>> TCP
          uninstall: rm cs policylabel <<name>>

      - name: INIT_SSLTCP
        fields:
          - id: name
            data: <<prefix>>_INIT_SSLTCP
          
        expressions:
          install: add cs policylabel <<name>> SSLTCP
          uninstall: rm cs policylabel <<name>>

      - name: INIT_UDP
        fields:
          - id: name
            data: <<prefix>>_INIT_UDP
          
        expressions:
          install: add cs policylabel <<name>> UDP
          uninstall: rm cs policylabel <<name>>

  - name: trafficmanagement.contentswitching.policylabels.bindings
    elements:
      - name: INIT_IPV4_HTTP
        tags:
          - ipv4
        fields:
          - id: name
            data: <<prefix>>_INIT_IPV4_HTTP
          - id: label
            data: <<contentswitching.init.trafficmanagement.contentswitching.policylabels.INIT_HTTP/name>>
          
          - id: 10041001_policy
            data: <<contentswitching.init.trafficmanagement.contentswitching.policies.INIT_IPV4_HTTP/name>>
          - id: 10041001_policylabel
            data: <<contentswitching.init_ipv4.trafficmanagement.contentswitching.policylabels.INIT_IPV4_HTTP/name>>

        expressions:
          install: bind cs policylabel <<label>> <<10041001_policy>> -priority 10041001 -gotoPriorityExpression NEXT -invoke policylabel <<10041001_policylabel>>
          uninstall: unbind cs policylabel <<label>> <<10041001_policy>>

      - name: INIT_IPV4_SSL
        tags:
          - ipv4
        fields:
          - id: name
            data: <<prefix>>_INIT_IPV4_SSL
          - id: label
            data: <<contentswitching.init.trafficmanagement.contentswitching.policylabels.INIT_SSL/name>>
          
          - id: 10041001_policy
            data: <<contentswitching.init.trafficmanagement.contentswitching.policies.INIT_IPV4_SSL/name>>
          - id: 10041001_policylabel
            data: <<contentswitching.init_ipv4.trafficmanagement.contentswitching.policylabels.INIT_IPV4_SSL/name>>

        expressions:
          install: bind cs policylabel <<label>> <<10041001_policy>> -priority 10041001 -gotoPriorityExpression NEXT -invoke policylabel <<10041001_policylabel>>
          uninstall: unbind cs policylabel <<label>> <<10041001_policy>>

      - name: INIT_IPV4_TCP
        tags:
          - ipv4
        fields:
          - id: name
            data: <<prefix>>_INIT_IPV4_TCP
          - id: label
            data: <<contentswitching.init.trafficmanagement.contentswitching.policylabels.INIT_TCP/name>>
          
          - id: 10041001_policy
            data: <<contentswitching.init.trafficmanagement.contentswitching.policies.INIT_IPV4_TCP/name>>
          - id: 10041001_policylabel
            data: <<contentswitching.init_ipv4.trafficmanagement.contentswitching.policylabels.INIT_IPV4_TCP/name>>

        expressions:
          install: bind cs policylabel <<label>> <<10041001_policy>> -priority 10041001 -gotoPriorityExpression NEXT -invoke policylabel <<10041001_policylabel>>
          uninstall: unbind cs policylabel <<label>> <<10041001_policy>>

      - name: INIT_IPV4_SSLTCP
        tags:
          - ipv4
        fields:
          - id: name
            data: <<prefix>>_INIT_IPV4_SSLTCP
          - id: label
            data: <<contentswitching.init.trafficmanagement.contentswitching.policylabels.INIT_SSLTCP/name>>
          
          - id: 10041001_policy
            data: <<contentswitching.init.trafficmanagement.contentswitching.policies.INIT_IPV4_SSLTCP/name>>
          - id: 10041001_policylabel
            data: <<contentswitching.init_ipv4.trafficmanagement.contentswitching.policylabels.INIT_IPV4_SSLTCP/name>>

        expressions:
          install: bind cs policylabel <<label>> <<10041001_policy>> -priority 10041001 -gotoPriorityExpression NEXT -invoke policylabel <<10041001_policylabel>>
          uninstall: unbind cs policylabel <<label>> <<10041001_policy>>

      - name: INIT_IPV4_UDP
        tags:
          - ipv4
        fields:
          - id: name
            data: <<prefix>>_INIT_IPV4_UDP
          - id: label
            data: <<contentswitching.init.trafficmanagement.contentswitching.policylabels.INIT_UDP/name>>
          
          - id: 10041001_policy
            data: <<contentswitching.init.trafficmanagement.contentswitching.policies.INIT_IPV4_UDP/name>>
          - id: 10041001_policylabel
            data: <<contentswitching.init_ipv4.trafficmanagement.contentswitching.policylabels.INIT_IPV4_UDP/name>>

        expressions:
          install: bind cs policylabel <<label>> <<10041001_policy>> -priority 10041001 -gotoPriorityExpression NEXT -invoke policylabel <<10041001_policylabel>>
          uninstall: unbind cs policylabel <<label>> <<10041001_policy>>


      - name: INIT_IPV6_HTTP
        tags:
          - ipv6
        fields:
          - id: name
            data: <<prefix>>_INIT_IPV6_HTTP
          - id: label
            data: <<contentswitching.init.trafficmanagement.contentswitching.policylabels.INIT_HTTP/name>>
          
          - id: 10061001_policy
            data: <<contentswitching.init.trafficmanagement.contentswitching.policies.INIT_IPV6_HTTP/name>>
          - id: 10061001_policylabel
            data: <<contentswitching.init_ipv6.trafficmanagement.contentswitching.policylabels.INIT_IPV6_HTTP/name>>

        expressions:
          install: bind cs policylabel <<label>> <<10061001_policy>> -priority 10061001 -gotoPriorityExpression NEXT -invoke policylabel <<10061001_policylabel>>
          uninstall: unbind cs policylabel <<label>> <<10061001_policy>>

      - name: INIT_IPV6_SSL
        tags:
          - ipv6
        fields:
          - id: name
            data: <<prefix>>_INIT_IPV6_SSL
          - id: label
            data: <<contentswitching.init.trafficmanagement.contentswitching.policylabels.INIT_SSL/name>>
          
          - id: 10061001_policy
            data: <<contentswitching.init.trafficmanagement.contentswitching.policies.INIT_IPV6_SSL/name>>
          - id: 10061001_policylabel
            data: <<contentswitching.init_ipv6.trafficmanagement.contentswitching.policylabels.INIT_IPV6_SSL/name>>

        expressions:
          install: bind cs policylabel <<label>> <<10061001_policy>> -priority 10061001 -gotoPriorityExpression NEXT -invoke policylabel <<10061001_policylabel>>
          uninstall: unbind cs policylabel <<label>> <<10061001_policy>>

      - name: INIT_IPV6_TCP
        tags:
          - ipv6
        fields:
          - id: name
            data: <<prefix>>_INIT_IPV6_TCP
          - id: label
            data: <<contentswitching.init.trafficmanagement.contentswitching.policylabels.INIT_TCP/name>>
          
          - id: 10061001_policy
            data: <<contentswitching.init.trafficmanagement.contentswitching.policies.INIT_IPV6_TCP/name>>
          - id: 10061001_policylabel
            data: <<contentswitching.init_ipv6.trafficmanagement.contentswitching.policylabels.INIT_IPV6_TCP/name>>

        expressions:
          install: bind cs policylabel <<label>> <<10061001_policy>> -priority 10061001 -gotoPriorityExpression NEXT -invoke policylabel <<10061001_policylabel>>
          uninstall: unbind cs policylabel <<label>> <<10061001_policy>>

      - name: INIT_IPV6_SSLTCP
        tags:
          - ipv6
        fields:
          - id: name
            data: <<prefix>>_INIT_IPV6_SSLTCP
          - id: label
            data: <<contentswitching.init.trafficmanagement.contentswitching.policylabels.INIT_SSLTCP/name>>
          
          - id: 10061001_policy
            data: <<contentswitching.init.trafficmanagement.contentswitching.policies.INIT_IPV6_SSLTCP/name>>
          - id: 10061001_policylabel
            data: <<contentswitching.init_ipv6.trafficmanagement.contentswitching.policylabels.INIT_IPV6_SSLTCP/name>>

        expressions:
          install: bind cs policylabel <<label>> <<10061001_policy>> -priority 10061001 -gotoPriorityExpression NEXT -invoke policylabel <<10061001_policylabel>>
          uninstall: unbind cs policylabel <<label>> <<10061001_policy>>

      - name: INIT_IPV6_UDP
        tags:
          - ipv6
        fields:
          - id: name
            data: <<prefix>>_INIT_IPV6_UDP
          - id: label
            data: <<contentswitching.init.trafficmanagement.contentswitching.policylabels.INIT_UDP/name>>
          
          - id: 10061001_policy
            data: <<contentswitching.init.trafficmanagement.contentswitching.policies.INIT_IPV6_UDP/name>>
          - id: 10061001_policylabel
            data: <<contentswitching.init_ipv6.trafficmanagement.contentswitching.policylabels.INIT_IPV6_UDP/name>>

        expressions:
          install: bind cs policylabel <<label>> <<10061001_policy>> -priority 10061001 -gotoPriorityExpression NEXT -invoke policylabel <<10061001_policylabel>>
          uninstall: unbind cs policylabel <<label>> <<10061001_policy>>
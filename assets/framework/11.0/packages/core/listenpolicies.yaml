name: listenpolicies
sections:
  - name: appexpert.expressions.advanced
    elements:
      - name: LISTEN_CS_IPV4_HTTP
        fields:
          - id: name
            data: <<prefix>>_LISTEN_CS_IPV4_HTTP
          - id: expression
            data: q{(<<core.stringmaps.appexpert.stringmaps.data.ENDPOINT_IPV4_HTTP/key_exists>> && <<core.stringmaps.appexpert.stringmaps.data.ENDPOINT_IPV4_HTTP/value_state_isdisabled>>.NOT) && (<<core.stringmaps.appexpert.stringmaps.data.TENANT_IPV4_HTTP/key_exists>> && <<core.stringmaps.appexpert.stringmaps.data.TENANT_IPV4_HTTP/value_state_isdisabled>>.NOT)}
        expressions:
          install: add policy expression <<name>> <<expression>>
          uninstall: rm policy expression <<name>>
      - name: LISTEN_CS_IPV4_SSL
        fields:
          - id: name
            data: <<prefix>>_LISTEN_CS_IPV4_SSL
          - id: expression
            data: q{(<<core.stringmaps.appexpert.stringmaps.data.ENDPOINT_IPV4_SSL/key_exists>> && <<core.stringmaps.appexpert.stringmaps.data.ENDPOINT_IPV4_SSL/value_state_isdisabled>>.NOT) && (<<core.stringmaps.appexpert.stringmaps.data.TENANT_IPV4_SSL/key_exists>> && <<core.stringmaps.appexpert.stringmaps.data.TENANT_IPV4_SSL/value_state_isdisabled>>.NOT)}
        expressions:
          install: add policy expression <<name>> <<expression>>
          uninstall: rm policy expression <<name>>
      - name: LISTEN_CS_IPV4_TCP
        fields:
          - id: name
            data: <<prefix>>_LISTEN_CS_IPV4_TCP
          - id: expression
            data: q{(<<core.stringmaps.appexpert.stringmaps.data.ENDPOINT_IPV4_TCP/key_exists>> && <<core.stringmaps.appexpert.stringmaps.data.ENDPOINT_IPV4_TCP/value_state_isdisabled>>.NOT) && (<<core.stringmaps.appexpert.stringmaps.data.TENANT_IPV4_TCP/key_exists>> && <<core.stringmaps.appexpert.stringmaps.data.TENANT_IPV4_TCP/value_state_isdisabled>>.NOT)}
        expressions:
          install: add policy expression <<name>> <<expression>>
          uninstall: rm policy expression <<name>>
      - name: LISTEN_CS_IPV4_SSLTCP
        fields:
          - id: name
            data: <<prefix>>_LISTEN_CS_IPV4_SSLTCP
          - id: expression
            data: q{(<<core.stringmaps.appexpert.stringmaps.data.ENDPOINT_IPV4_SSLTCP/key_exists>> && <<core.stringmaps.appexpert.stringmaps.data.ENDPOINT_IPV4_SSLTCP/value_state_isdisabled>>.NOT) && (<<core.stringmaps.appexpert.stringmaps.data.TENANT_IPV4_SSLTCP/key_exists>> && <<core.stringmaps.appexpert.stringmaps.data.TENANT_IPV4_SSLTCP/value_state_isdisabled>>.NOT)}
        expressions:
          install: add policy expression <<name>> <<expression>>
          uninstall: rm policy expression <<name>>
      - name: LISTEN_CS_IPV4_UDP
        fields:
          - id: name
            data: <<prefix>>_LISTEN_CS_IPV4_UDP
          - id: expression
            data: q{(<<core.stringmaps.appexpert.stringmaps.data.ENDPOINT_IPV4_UDP/key_exists>> && <<core.stringmaps.appexpert.stringmaps.data.ENDPOINT_IPV4_UDP/value_state_isdisabled>>.NOT) && (<<core.stringmaps.appexpert.stringmaps.data.TENANT_IPV4_UDP/key_exists>> && <<core.stringmaps.appexpert.stringmaps.data.TENANT_IPV4_UDP/value_state_isdisabled>>.NOT)}
        expressions:
          install: add policy expression <<name>> <<expression>>
          uninstall: rm policy expression <<name>>
      - name: LISTEN_VS_SSLBRIDGE
        fields:
          - id: name
            data: <<prefix>>_LISTEN_VS_IPV4_SSLBRIDGE
          - id: expression
            data: q{(<<core.stringmaps.appexpert.stringmaps.data.ENDPOINT_IPV4_SSLBRIDGE/key_exists>> && <<core.stringmaps.appexpert.stringmaps.data.ENDPOINT_IPV4_SSLBRIDGE/value_state_isdisabled>>.NOT) && (<<core.stringmaps.appexpert.stringmaps.data.TENANT_IPV4_SSLBRIDGE/key_exists>> && <<core.stringmaps.appexpert.stringmaps.data.TENANT_IPV4_SSLBRIDGE/value_state_isdisabled>>.NOT)}
        expressions:
          install: add policy expression <<name>> <<expression>>
          uninstall: rm policy expression <<name>>
      
      - name: LISTEN_CS_IPV6_HTTP
        fields:
          - id: name
            data: <<prefix>>_LISTEN_CS_IPV6_HTTP
          - id: expression
            data: q{(<<core.stringmaps.appexpert.stringmaps.data.ENDPOINT_IPV6_HTTP/key_exists>> && <<core.stringmaps.appexpert.stringmaps.data.ENDPOINT_IPV6_HTTP/value_state_isdisabled>>.NOT) && (<<core.stringmaps.appexpert.stringmaps.data.TENANT_IPV6_HTTP/key_exists>> && <<core.stringmaps.appexpert.stringmaps.data.TENANT_IPV6_HTTP/value_state_isdisabled>>.NOT)}
        expressions:
          install: add policy expression <<name>> <<expression>>
          uninstall: rm policy expression <<name>>
      - name: LISTEN_CS_IPV6_SSL
        fields:
          - id: name
            data: <<prefix>>_LISTEN_CS_IPV6_SSL
          - id: expression
            data: q{(<<core.stringmaps.appexpert.stringmaps.data.ENDPOINT_IPV6_SSL/key_exists>> && <<core.stringmaps.appexpert.stringmaps.data.ENDPOINT_IPV6_SSL/value_state_isdisabled>>.NOT) && (<<core.stringmaps.appexpert.stringmaps.data.TENANT_IPV6_SSL/key_exists>> && <<core.stringmaps.appexpert.stringmaps.data.TENANT_IPV6_SSL/value_state_isdisabled>>.NOT)}
        expressions:
          install: add policy expression <<name>> <<expression>>
          uninstall: rm policy expression <<name>>
      - name: LISTEN_CS_IPV6_TCP
        fields:
          - id: name
            data: <<prefix>>_LISTEN_CS_IPV6_TCP
          - id: expression
            data: q{(<<core.stringmaps.appexpert.stringmaps.data.ENDPOINT_IPV6_TCP/key_exists>> && <<core.stringmaps.appexpert.stringmaps.data.ENDPOINT_IPV6_TCP/value_state_isdisabled>>.NOT) && (<<core.stringmaps.appexpert.stringmaps.data.TENANT_IPV6_TCP/key_exists>> && <<core.stringmaps.appexpert.stringmaps.data.TENANT_IPV6_TCP/value_state_isdisabled>>.NOT)}
        expressions:
          install: add policy expression <<name>> <<expression>>
          uninstall: rm policy expression <<name>>
      - name: LISTEN_CS_IPV6_SSLTCP
        fields:
          - id: name
            data: <<prefix>>_LISTEN_CS_IPV6_SSLTCP
          - id: expression
            data: q{(<<core.stringmaps.appexpert.stringmaps.data.ENDPOINT_IPV6_SSLTCP/key_exists>> && <<core.stringmaps.appexpert.stringmaps.data.ENDPOINT_IPV6_SSLTCP/value_state_isdisabled>>.NOT) && (<<core.stringmaps.appexpert.stringmaps.data.TENANT_IPV6_SSLTCP/key_exists>> && <<core.stringmaps.appexpert.stringmaps.data.TENANT_IPV6_SSLTCP/value_state_isdisabled>>.NOT)}
        expressions:
          install: add policy expression <<name>> <<expression>>
          uninstall: rm policy expression <<name>>
      - name: LISTEN_CS_IPV6_UDP
        fields:
          - id: name
            data: <<prefix>>_LISTEN_CS_IPV6_UDP
          - id: expression
            data: q{(<<core.stringmaps.appexpert.stringmaps.data.ENDPOINT_IPV6_UDP/key_exists>> && <<core.stringmaps.appexpert.stringmaps.data.ENDPOINT_IPV6_UDP/value_state_isdisabled>>.NOT) && (<<core.stringmaps.appexpert.stringmaps.data.TENANT_IPV6_UDP/key_exists>> && <<core.stringmaps.appexpert.stringmaps.data.TENANT_IPV6_UDP/value_state_isdisabled>>.NOT)}
        expressions:
          install: add policy expression <<name>> <<expression>>
          uninstall: rm policy expression <<name>>
      - name: LISTEN_VS_IPV6_SSLBRIDGE
        fields:
          - id: name
            data: <<prefix>>_LISTEN_VS_IPV6_SSLBRIDGE
          - id: expression
            data: q{(<<core.stringmaps.appexpert.stringmaps.data.ENDPOINT_IPV6_SSLBRIDGE/key_exists>> && <<core.stringmaps.appexpert.stringmaps.data.ENDPOINT_IPV6_SSLBRIDGE/value_state_isdisabled>>.NOT) & (<<core.stringmaps.appexpert.stringmaps.data.TENANT_IPV6_SSLBRIDGE/key_exists>> && <<core.stringmaps.appexpert.stringmaps.data.TENANT_IPV6_SSLBRIDGE/value_state_isdisabled>>.NOT)}
        expressions:
          install: add policy expression <<name>> <<expression>>
          uninstall: rm policy expression <<name>>

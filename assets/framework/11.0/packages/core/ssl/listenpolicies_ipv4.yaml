name: listenpolicies
tags:
  - ssl
  - core
sections:
  - name: appexpert.expressions.advanced
    elements:
      - name: LISTEN_CSV_IPV4_SSL
        fields:
          - id: name
            data: <<prefix>>_LISTEN_CSV_IPV4_SSL
          - id: expression
            data: q{(<<core.stringmaps.appexpert.stringmaps.CONFIG_ENDPOINT/ipv4_ssl_key_exists>> && <<core.stringmaps.appexpert.stringmaps.CONFIG_ENDPOINT/ipv4_ssl_value_state_isdisabled>>.NOT) && (<<core.stringmaps.appexpert.stringmaps.CONFIG_TENANT/ipv4_ssl_key_exists>> && <<core.stringmaps.appexpert.stringmaps.CONFIG_TENANT/ipv4_ssl_value_state_isdisabled>>.NOT)}
        expressions:
          install: add policy expression <<name>> <<expression>>
          uninstall: rm policy expression <<name>>